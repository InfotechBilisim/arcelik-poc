var ouilib;(function(){function a(b,d){if(!b){b={}}var b=b||{};b.config=b.config||{defaultViewportWidth:undefined,defaultViewportHeight:undefined,defaultLayoutDir:undefined,defaultLogLevel:"FINEST",defaultLogHandler:undefined,embeddedResourcesMap:undefined,preventTimerStart:false,frameRate:undefined,environment:undefined,base:".",catchAllEventListener:undefined,altText:"",hiDPI:true,silverlight:undefined};b.setUp=function(e){var f=b.config;if(b.equalIgnoreCase(b.RTL,f.defaultLayoutDir)){b.layoutDir=b.RTL;b.filters._onLayoutDir(b.layoutDir)}else{b.layoutDir=b.LTR}if(b.equalIgnoreCase(b.EnvironmentEnum.MOBILE,f.environment)){b.environment=b.EnvironmentEnum.MOBILE}else{b.environment=b.EnvironmentEnum.DESKTOP}b.deviceOrientation=b.DeviceOrientationEnum.LANDSCAPE;b.viewportWidth=0;if(b.isPositiveNumber(f.defaultViewportWidth)){b.viewportWidth=f.defaultViewportWidth}b.viewportHeight=0;if(b.isPositiveNumber(f.defaultViewportHeight)){b.viewportHeight=f.defaultViewportHeight}b.viewportBounds={x:0,y:0,width:b.viewportWidth,height:b.viewportHeight};b.tree=new b.scene.Tree();b.timer=new b.timing.Timer(f.frameRate);b.tree._setContainerImpl(e);b.rootNode=b.tree.userLayer;b.focusManager=new b.focus.FocusManager(b.rootNode);b.tooltipManager=new b.tooltip.TooltipManager();b.resourcesManager=new b.utils.ResourcesManager();b.rootNode.addEventListener(b.ViewEvents.USER_EVENTS_SUPPORTED,b.events.setUserEventsSupported);b.rootNode.addEventListener(b.ViewEvents.ABOUT_INFO_REQUEST,function(g){g.returnValue=b.aboutInfo});if(f.preventTimerStart!==true){b.timer.start()}};(function(){b.NO_OP=function(){};b.BASE_VALUE="base";b.FillEnum={REMOVE:"REMOVE",FREEZE:"FREEZE",_LEGACY:"_LEGACY"};b.DEFAULT_TAG="defaultTag";b.TAGS={LAYOUT_DIR:"layoutDir",PAINT:"paint",GEOM:"geom",TRANSFO_SET:"transfoSet",TRANSFO:"transfo",SENSITIVITY:"sensitivity",VISIBILITY:"visibility",DISPLAY:"display",OPACITY:"opacity",NAME:"name",CLIP:"clip",CURSOR:"cursor",FOCUSABLE:"focusable",DESC:"desc",FILTER:"filter",LAYOUT:"layout",PREF_SIZE:"prefSize",SRC:"src",MARKER_START:"markerStart",MARKER_START_DATA:"markerStartData",MARKER_START_PAINT:"markerStartPaint",MARKER_END:"markerEnd",MARKER_END_DATA:"markerEndData",MARKER_END_PAINT:"markerEndPaint"};b.EnvironmentEnum={DESKTOP:"DESKTOP",MOBILE:"MOBILE"};b.DeviceOrientationEnum={LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"};b.CursorType={AUTO:"auto",DEFAULT:"default",MOVE:"move",POINTER:"pointer",TEXT:"text",WAIT:"wait",NONE:"none",HELP:"help",CROSSHAIR:"crosshair"};b.TextAlignEnum={LINE_BEGIN:"LINE_BEGIN",CENTER:"CENTER",LINE_END:"LINE_END",JUSTIFY:"JUSTIFY"};b.LineCap={BUTT:"butt",ROUND:"round",SQUARE:"square"};b.DirectionEnum={UP:"UP",DOWN:"DOWN",LEFT:"LEFT",RIGHT:"RIGHT",TO_LINE_BEGIN:"TO_LINE_BEGIN",TO_LINE_END:"TO_LINE_END"};b.OrientationEnum={VERTICAL:"VERTICAL",HORIZONTAL:"HORIZONTAL"};b.LineJoin={MITER:"miter",ROUND:"round",BEVEL:"bevel"};b.FontWeightEnum={NORMAL:"NORMAL",BOLD:"BOLD"};b.FontStyleEnum={NORMAL:"NORMAL",ITALIC:"ITALIC"};b.LayoutDirEnum={LTR:"LTR",RTL:"RTL"};b.LTR="LTR";b.RTL="RTL";b.NodeAlign={TOP:0,CENTER:0.5,BOTTOM:1,LINE_BEGIN:0,LINE_END:1};b._BoundsType={DEFAULT:0,LAYOUT:1,RENDER:2};b.KeyCode={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,MULTIPLY:106,PLUS:107,MINUS:109,DIVIDE:111,DASH:189,FORWARD_SLASH:191,BACK_SLASH:220};b.PreserveAspectRatioEnum={NONE:"NONE",MIN:"MIN",MAX:"MAX"};b.WindingRuleEnum={EVEN_ODD:"EVEN_ODD",NON_ZERO:"NON_ZERO"};b.AUTO="AUTO";b.QuoteStyleEnum={ENT_COMPAT:"ENT_COMPAT",ENT_QUOTES:"ENT_QUOTES",ENT_NOQUOTES:"ENT_NOQUOTES"};b.GENERIC_FONTS={SERIF:"serif",SANS_SERIF:"sans-serif",CURSIVE:"cursive",MONOSPACE:"monospace"}}());b.LogLevel={OFF:"OFF",ERROR:"ERROR",SEVERE:"SEVERE",WARNING:"WARNING",INFO:"INFO",FINEST:"FINEST",ALL:"ALL",LOG:"LOG"};var c;b.log=c=(function(){var o=b.LogLevel,f={OFF:0,SEVERE:1,WARNING:2,INFO:3,FINEST:4,ALL:5},n=[],j=0,i=[],p,l,h,e,k;p=function(){k.release()};function m(w,u){var r=n,t,s,v=r.length;for(s=0;s<v;s++){t=r[s];if(typeof t==="function"){t.call(null,w,u)}else{t.log(w,u)}}}function q(s,r){if(i.length===j){i.shift()}i.push({level:s,message:r})}function g(s){var r=o.INFO;if(typeof s==="string"){s=s.toUpperCase()}if(o.hasOwnProperty(s)){r=o[s]}return r}k=function(r,u,s){var t,v;if(u){r=g(r);if(u instanceof Error){u=u.toString()}if(e){u=e(u,s)}if(r===o.ERROR){throw new Error(u)}else{t=f[h];v=f[r];if(v<=t){if(j>0){q(r,u)}else{m(r,u)}}}}};k.setLevel=function(r){h=g(r)};k.setFormatter=function(r){if(typeof r==="function"){e=r}};k.error=function(s,r){k(o.ERROR,s,r)};k.severe=function(s,r){k(o.SEVERE,s,r)};k.warn=k.warning=function(s,r){k(o.WARNING,s,r)};k.info=function(s,r){k(o.INFO,s,r)};k.finest=function(s,r){k(o.FINEST,s,r)};k.addLogHandler=function(r){if(typeof r==="function"||(r&&typeof r.log==="function")){n.push(r)}};k.delay=function(r,s){if(l){clearTimeout(l)}k.hold(s);l=setTimeout(p,r)};k.hold=function(r){j=r>0?r:500};k.release=function(){var r,s=i.length;if(s>0){m(o.LOG,">>>> releasing "+s+" logs.");while(s--){r=i.shift();m(r.level,r.message)}m(o.LOG,">>>> end logs release")}j=0};k.setLevel(b.config.defaultLogLevel||b.LogLevel.FINEST);k.addLogHandler(b.config.defaultLogHandler);k.setFormatter(function(s,r){if(r!==undefined){if(r.constructor===Array){s+="::"+r.join(",")}else{s+="::"+r}}return s});return k}());b.ns=function(j){var g,f,k,e,h,m,l;if(typeof j==="string"){for(h=0,m=j.length;h<m;h++){l=j.charAt(h);if((l===".")||((l>="a")&&(l<="z"))||((l>="A")&&(l<="Z"))||((l>="0")&&(l<="9"))){continue}else{c.error("ERR__NAMESPACE__ILLEGAL_CHAR",j)}}k=j.split(".");f=undefined;if(k[0]==="oui"){f=b}if(f===undefined||f.length===0){c.error("ERR__NS__ROOT_FAIL",k[0])}for(h=1,m=k.length;h<m;h++){e=k[h];f[e]=f[e]||{};f=f[e]}g=f}else{c.error("ERR__NS__INV_STR",[j,typeof j])}return g};(function(){b.ns("oui.lang");b.lang.AspectSupport={addAspect:function(g,f,j,i){var h=this[g],e;if(b.isA(h,Function)&&b.isA(f,Function)){if(j===true){e=function(){e.aspect.apply(this,arguments);return e.nextMethod.apply(this,arguments)}}else{e=function(){var k=h.apply(this,arguments);e.aspect.apply(this,arguments);return k}}e.nextMethod=h;e.aspect=f;e.aspectName=i;this[g]=e}},removeAspect:function(f,e){var h=this[f],g;while(h){if(h.aspect===e){if(g){g.nextMethod=h.nextMethod}else{this[f]=h.nextMethod}break}else{g=h;h=h.nextMethod}}}}}());(function(){b.ns("oui.lang");var f,e={superClass:false,__configs:false,events:true};b.lang.Class=f={mixin:function(i,h,g){if(!i){c.error("ERR__MIX__INV_TARGET")}else{if(!h||!f._isStrictObject(h)){c.error("ERR__MIX__INV_SRC")}else{if(g===undefined){g=true}if(f._isClass(i)){f.merge(i.prototype,h,g,e)}else{if(f._isStrictObject(i)){f.merge(i,h,g,e)}else{c.error("ERR__MIX__INV_TARGET")}}f._copyConfigs(i,h)}}},_copyConfigs:function(l,j){var n,m,i,g,h,k;if(j.__configs){if(!l.__configs){l.__configs={}}for(n in j.__configs){if(!l.__configs[n]){b.lang.PropertiesUtil.addConfig(l,{},n)}m=j.__configs[n].definitionClass.prototype;i=j.__configs[n].configClass.prototype;g=l.__configs[n].definitionClass.prototype;h=l.__configs[n].configClass.prototype;for(k in m){if(!i[k]){c.error("ERR__CONFIG__NO_DEFAULT",k)}if(!g[k]&&!h[k]){g[k]=m[k];h[k]=i[k]}else{c.error("ERR__CONFIG__DUP_PROP",k)}}}}},merge:function(k,h,g,j){var i;j=j||{};for(i in h){if(!j.hasOwnProperty(i)&&(g||!k.hasOwnProperty(i))){k[i]=h[i]}else{if(j[i]===true){if(!k[i]){k[i]={}}this.merge(k[i],h[i],g,j)}}}if(h.hasOwnProperty("toString")&&g){k.toString=h.toString}},extend:function(i,g){var h;if(!i||!f._isClass(i)){c.error("ERR__EXT__INV_CHILD")}else{if(!g||!f._isClass(g)){c.error("ERR__EXT__INV_PARENT")}else{if(i.superClass!==undefined){c.error("ERR__EXT__MULT_INHERIT")}h=function(){};h.prototype=g.prototype;i.prototype=new h();i.prototype.constructor=i;i.superClass=g}}},isA:function(i,h){var g=false;if(typeof i==="boolean"){g=(h===Boolean)}else{if(typeof i==="number"){g=(h===Number)}else{if(typeof i==="string"){g=(h===String)}else{if(h===Function){g=(typeof i==="function"||i===Date)}else{if(h&&i){if(i.constructor===h){g=true}else{if(f._isClass(h)&&i instanceof h){g=true}else{if(i.constructor!==undefined){g=f._inheritsFrom(i.constructor,h)}}}}}}}}return g},isAny:function(h){var k=arguments.length,g=false,j;for(j=1;j<k;j++){if(b.isA(h,arguments[j])){g=true;break}}return g},_isStrictObject:function(g){return g.constructor===Object},_isClass:function(g){return(g.constructor===Function||(b.as3Class!==undefined&&g.constructor===b.as3Class))},_inheritsFrom:function(j,i){var g=false,h=j.superClass;if(j===i){g=true}else{if(h!==undefined){g=f._inheritsFrom(h,i)}}return g},declare:function(l){var m,h,o,j,k,p,g;if(!b.isA(l,Object)){c.error("ERR__DECL__INV_CLASS_DEF")}m=l.name;if(!b.isA(m,String)||m.indexOf(".")<0){c.error("ERR__DECL__INV_CLASS_NAME")}j=m.lastIndexOf(".");h=b.ns(m.substr(0,j));m=m.substr(j+1);if(l.isAbstract===true){o=function(){c.error("ERR__ABSTR_CLASS",l.name)}}else{o=function(){this.init.apply(this,arguments)}}if(h[m]!==undefined){c.error("ERR__DECL__DUP_CLASS",l.name)}h[m]=o;if(b.isA(l.extend,Function)){b.extend(o,l.extend)}if(b.isA(l.mixins,Array)){for(k=0,p=l.mixins.length;k<p;k++){b.mixin(o,l.mixins[k])}}g=[{name:"styleDef",call:b.addStyleSupport},{name:"modelDef",call:b.addModelSupport},{name:"propertiesDef",call:b.addPropertiesSupport},{name:"resourcesDef",call:b.addI18nSupport},{name:"jsonDef",call:b.addJSONLoaderSupport},{name:"eventsDef",call:b.addEventsSupport}];for(k=0,p=g.length;k<p;k++){if(b.isA(l[g[k].name],Object)){g[k].call(o,l[g[k].name])}}if(b.isA(l.membersDef,Object)){b.mixin(o,l.membersDef)}return o}};b.merge=f.merge;b.extend=f.extend;b.mixin=f.mixin;b.isA=f.isA;b.isAny=f.isAny;b.declare=f.declare}());(function(){b.ns("oui.lang");b.mixin(b,{isChar:function(e){return typeof e==="string"&&e.length===1},isStringNotEmpty:function(e){return typeof e==="string"&&e.length>0},isValueInEnum:function(f,e){return typeof f==="string"&&e!==undefined&&e.hasOwnProperty(f)},isPositiveNumber:function(f,e){return typeof f==="number"&&(e===true?f>0:f>=0)},isFiniteNumber:function(e){return typeof e==="number"&&isFinite(e)},isFinitePositiveNumber:function(f,e){return typeof f==="number"&&isFinite(f)&&(e===true?f>0:f>=0)},isNumberInRange:function(g,e,h){var f;if(h===true){f=b.isArrayOfType(e,{type:Number})&&e.length===2&&!isNaN(e[0])&&!isNaN(e[1])}else{f=true}return f&&typeof g==="number"&&!isNaN(g)&&g>=e[0]&&g<=e[1]},isFunctionWithArgCount:function(e,f){return typeof e==="function"&&e.length===f},isArrayOfType:function(f,g,l,m,k){var e=true,j,h;if(g===undefined||g===null||g.type===undefined){e=false}else{if(f&&f.constructor===Array){j=f.length;if(l!==undefined){if(k===true&&typeof l!=="number"){e=false}if(j<l){e=false}}if(m!==undefined){if(k===true&&typeof m!=="number"){e=false}if(j>m){e=false}}for(h=0;h<j&&e===true;h++){e=b.isValueValid(f[h],g)}}else{e=false}}return e},isArrayOfProperties:function(l,e,f,m,k){var n=true,h=null,j,g;if(e===undefined||e===null){n=false}else{if(l&&l.constructor===Array){j=l.length;if(f!==undefined){if(k===true&&typeof f!=="number"){n=false}if(j<f){n=false}}if(m!==undefined){if(k===true&&typeof m!=="number"){n=false}if(j>m){n=false}}for(g=0;g<j&&n===true;g++){h=l[g];n=h!==undefined&&h!==null&&h.constructor===Object&&b.isObjectValid(h,e,true)}}else{n=false}}return n},isMapOfType:function(h,f){var e=true,g;if(f===undefined||f===null||f.type===undefined){e=false}else{if(typeof h==="object"){for(g in h){if(h.hasOwnProperty(g)){e=b.isValueValid(h[g],f)}}}else{e=false}}return e},isMapOfProperties:function(k,g,h,f,i){var e=false,j;if(g&&k&&k.constructor===Object){if(typeof h!=="boolean"){h=true}e=true;for(j in k){if(k.hasOwnProperty(j)){e=b.isObjectValid(k[j],g,h,f);if(e===false&&i===true){e=b.isMapOfProperties(k[j],g,h,f,i)}if(e===false){break}}}}return e},isObjectValid:function(l,k,h,i){var n=false,f=false,m=false,e,j,g;if(k!==undefined&&l!==undefined&&k!==null&&l!==null){for(e in k){if(k[e]!==undefined){j=l[e];g=k[e];if(j!==undefined){f=b.isValueValid(j,g,h);n=f}else{m=m||!l.hasOwnProperty(e);n=!h}if(n!==true){break}}}if(n===true&&h===false&&i===true&&m){if(f===true){for(e in k){if(l.hasOwnProperty(e)===false){g=k[e];l[e]=g.defaultValue}}}else{n=false}}}return n},inheritsFrom:function(h,i,f){var e=false,g=true;if(f!==false){g=b.isA(i,Function)}if(g&&b.isA(h,Function)){e=b.lang.Class._inheritsFrom(h,i)}return e}})}());(function(){b.ns("oui.lang");var e=b.QuoteStyleEnum,f="(&amp;|&lt;|&gt;|&quot;|&#039;|&#8230;)",g=new RegExp(f,"gi"),h=new RegExp("^"+f+"$","i");b.mixin(b,{currentTimeMillis:function(){return new Date().getTime()},equalIgnoreCase:function(k,j){var i=false;if(typeof k==="string"&&typeof j==="string"){i=(k.toLowerCase()===j.toLowerCase())}return i},trim:function(i){return i.replace(/^\s+|\s+$/g,"")},arrayRemove:function(o,l,k){var j,m=o.length;for(j=m-1;j>=0;j--){if(o[j]===l){o.splice(j,1);if(k===false){break}}}return o},hasOwnValue:function(l,n,k){var m,j=false,i;if(l!==undefined){if(typeof n==="string"&&k===true){i=n.toLowerCase();for(m in l){if(l.hasOwnProperty(m)&&l[m].toLowerCase()===i){j=true;break}}}else{for(m in l){if(l.hasOwnProperty(m)&&l[m]===n){j=true;break}}}}return j},supportsEvents:function(i){return i!==null&&i!==undefined&&b.isA(i.addEventListener,Function)},getValidIndex:function(j,l){var m,k;if(j<0){k=j%l;m=(k===0)?0:l+(j%l)}else{if(j>0){m=(j<l)?j:j%l}else{m=0}}return m},isValueOfType:function(n,m,o){var i=false,l,k;if(m===Object){i=true}else{if(n!==undefined&&n!==null&&m!==undefined&&m!==null){if(m===String||m===Number||m===Boolean||m===Array||m===Date||m===Function){i=(n.constructor===m)}else{if(m.constructor===Object&&n.constructor===Object){i=(b.isObjectValid(n,m,o)===true)}else{if(m.constructor===Function){i=b.isA(n,m)}else{if(m.constructor===Array){k=m.length;for(l=0;l<k;l++){if(n===m[l]){i=true;break}}}}}}}}return i},isValueInConstraint:function(m,o,k){var l=null,j=null,i=true;if(o){i=false;if(o.constructor===Function){l=o;j=[m]}else{if(o.constructor===Array&&o.length>0&&o[0]!==undefined&&o[0]!==null&&o[0].constructor===Function){l=o[0];j=o.concat();j[0]=m}}}if(k===undefined){k=null}if(l!==null){try{i=l.apply(k,j)}catch(n){c.info("INFO__CONSTRAINT_FAIL",[n.message,m,o,k])}}return i},isValueValid:function(k,j,l){var i=false;if(j.type!==undefined){i=b.isValueOfType(k,j.type,l)}else{i=b.isValueOfType(k,j,l)}if(i===true&&j.constraint!==undefined){i=b.isValueInConstraint(k,j.constraint)}return i},buildDefaults:function(j,m){var i=m,k,l;if(typeof i!=="object"||i===null){i={}}for(l in j){k=j[l];if(k!==null&&k!==undefined&&k.constructor===Object){if(k.defaultValue!==undefined){i[l]=k.defaultValue}else{if(k.type!==undefined&&k.type.constructor===Object){k=k.type}i[l]=b.buildDefaults(k)}}}return i},applyProperties:function(l,m,k,i){var j={};if(l&&k){b._applyPropertiesImpl(l,m,k,i,j)}return j},_applyPropertiesImpl:function(i,q,l,t,v){var j,s,m,n,k,r,u,o=b._applyPropertiesImpl;for(j in i){m=l[j];s=i[j];n=q[j];if(m!==undefined&&s!==n){if(m.type===undefined){if(m.constructor===Object){o(s,n,m,t,v)}}else{if(m.type.constructor===Object){o(s,n,m.type,t,v)}else{k=false;r=undefined;k=(s===null&&m.allowsNull)||(s===undefined&&m.allowsUndef)||b.isValueOfType(s,m.type,false);if(k===true){r=s}else{if(m.convertor){u={value:undefined,validValue:false};m.convertor(s,u);k=(u.validValue===true);r=u.value}}if(k===true&&m.comparator){k=!m.comparator(n,s)}if(k===true&&m.constraint){k=b.isValueInConstraint(r,m.constraint,t);if(!k&&m.itemsConvertor){u={value:undefined,validValue:false};m.itemsConvertor(r,u);k=(u.validValue===true);r=u.value}}if(k===true){q[j]=r;if(m.tag){v[m.tag]=true}else{v[b.DEFAULT_TAG]=true}}}}}}},xmlSpecialChars:function(p,j,k){var o,m,l,q;if(!b.hasOwnValue(e,j)){j=e.ENT_COMPAT}if(k===false){o=p.split(g);for(l=0,q=o.length;l<q;l++){m=o[l];if(m.match(h)===null){o[l]=m.replace(/&/g,"&amp;")}}p=o.join("")}else{p=p.replace(/&/g,"&amp;")}p=p.replace(/</g,"&lt;");p=p.replace(/>/g,"&gt;");if(j===e.ENT_COMPAT){p=p.replace(/"/g,"&quot;")}else{if(j===e.ENT_QUOTES){p=p.replace(/"/g,"&quot;");p=p.replace(/'/g,"&#039;")}}p=p.replace(/\u2026/g,"&#8230;");return p}})}());(function(){b.ns("oui.defs");function l(w,u,v,A,y,o,t,x,s){var q,p,z,r=(v===null&&x)||(v===undefined&&s)||b.isValueOfType(v,u,false);if(!r||!b.isValueInConstraint(v,o)){if(t===undefined){t=["def=",v];if(b.isA(o,Array)){t.push(" with constraints: ");for(q=1,p=o.length;q<p;q++){t.push(o[q],", ")}}}c.error("ERR__DEFS__INV",[t,"oui.defs."+w])}else{if(A!==undefined&&!b.isA(A,String)){c.error("ERR__DEFS__INV",["tag","oui.defs."+w])}else{z={type:u,constraint:o,defaultValue:v,convertor:y,tag:A}}}return z}function f(q,p,o,r){var n=false;if(q===null){n=o}else{if(q===undefined){n=r}else{n=b.isValueOfType(q,p,true)}}return n}function i(p,r,o,q){var n=false;if(p===null){n=o}else{if(p===undefined){n=q}else{n=b.isValueInConstraint(p,r)}}return n}function k(o,n){if(o===1||o==="1"||o==="true"||o==="TRUE"){n.validValue=true;n.value=true}else{if(o===0||o==="0"||o==="false"||o==="FALSE"){n.validValue=true;n.value=false}}}function m(o,n){if(o!==undefined&&o!==null){n.validValue=true;n.value=o.toString()}}function e(o,n){if(b.isA(o,String)){var p=parseFloat(o);if(!isNaN(p)){n.valueValid=true;n.value=p}}}function g(p,o){if(b.isA(p,String)){var n=Date.parse(p);if(!isNaN(n)){o.validValue=true;o.value=new Date(n)}}}function j(p){var s,r=p.convertor,q,u,t,o;if(r!==undefined){s=function(v,n){u=[].concat(v);t=u.length;for(q=0;q<t;q++){o=b.isValueOfType(u[q],p.type,false);if(o===false){n.validValue=false;r(u[q],n,q,t);if(n.validValue===true){o=n.validValue;u[q]=n.value}}if(o===false){break}}if(q===t){n.validValue=true;n.value=u}else{n.validValue=false}}}return s}function h(o,r,q){var p,n=false;if(o!==null&&o!==undefined&&r!==null&&r!==undefined&&o.constructor===Array&&r.constructor===Array&&o.length===r.length){n=true;p=o.length;if(q===true){while(n&&p--){if(o[p].constructor===Array){n=h(o[p],r[p],q)}}}else{while(n&&p--){n=(o[p]===r[p])}}}return n}b.mixin(b.defs,{_createDef:l,Boolean:function(o,n){return l("Boolean",Boolean,o,n,k)},String:function(o,n){return l("String",String,o,n,m)},Char:function(o,n){return l("Char",String,o,n,m,b.isChar)},Number:function(o,n){return l("Number",Number,o,n,e)},FiniteNumber:function(o,n){return l("FiniteNumber",Number,o,n,e,b.isFiniteNumber)},FinitePositiveNumber:function(o,n){return l("FinitePositiveNumber",Number,o,n,e,b.isFinitePositiveNumber)},PositiveNumber:function(o,n){return l("PositiveNumber",Number,o,n,e,b.isPositiveNumber)},StrictlyPositiveNumber:function(o,n){return l("StrictlyPositiveNumber",Number,o,n,e,[b.isPositiveNumber,true])},NumberInRange:function(o,q,n){var r=[b.isNumberInRange,o,true],p=l("NumberInRange",Number,q,n,e,r);r[2]=false;return p},Enum:function(q,o,n){var s=[],r;for(r in q){if(q.hasOwnProperty(r)){s.push(q[r])}}return l("Enum",s,o,n)},Date:function(o,n){return l("Date",Date,o,n,g)},MapOfProperties:function(r,s,p,o,q,n){return l("MapOfProperties",Object,s,n,undefined,[b.isMapOfProperties,r,p,o,q])},MapOfType:function(o,p,n){return l("MapOfType",Object,p,n,undefined,[b.isMapOfType,o])},ArrayOfProperties:function(o,s,t,q,n){var r=[b.isArrayOfProperties,o,s,t,true],p=l("ArrayOfProperties",Array,q,n,undefined,r);r[4]=false;return p},ArrayOfType:function(u,n,t,p,x,v,s){var o=[b.isArrayOfType,u,n,t,true],q,w={},r;if(s){r=j(u);r(p,w);if(w.validValue){p=w.value}}q=l("ArrayOfType",Array,p,x,null,o);if(s){q.itemsConvertor=r}if(v){q.comparator=h}o[4]=false;return q},ObjectOfType:function(p,r,o,q,n){return l("ObjectOfType",Object,r,n,undefined,[f,p,o,q])},ObjectOfConstraint:function(p,r,o,q,n){return l("ObjectOfConstraint",Object,r,n,undefined,[i,p,o,q])},Function:function(p,o,n){return l("Function",Function,o,n,undefined,[b.isFunctionWithArgCount,p])},Class:function(r,p,n){var q=[b.inheritsFrom,r],o=l("Class",Function,p,n,undefined,q);q[2]=false;return o}})}());(function(){b.ns("oui.lang");b.lang.PropertiesSupport={_initProperties:function(e){this._properties=new this.Properties();this.setProperties(e)},setProperties:function(f){var e=this._properties.updateObject(f),g;for(g in e){if(e[g]===true){this.onPropChanged(g)}}},applyProperties:function(e){this.setProperties(e)},onPropChanged:function(){}}}());(function(){b.ns("oui.lang");var e=/\^\.([a-zA-Z0-9\-_]*)\[([a-zA-Z0-9\-]*)\]/;b.lang.BindingSupport={applyBinding:function(i,g,h,k,j,f){var l=this[j];if(b.isA(l,Function)){this._applyBinding(i,g,h,k,l,f)}},_applyBinding:function(o,g,k,f,p,t){var r=this[k],l,s,h,q,m,j;if(t===true&&r!==undefined){l=this._computeBinding(o,r,g,this);p.call(this,l)}s=this[f];if(s===undefined||g===s){q=this.firstChild;while(q){q._applyBinding(o,g,k,f,p,true);q=q.nextSibling}}else{h=this.getOutOfBindingScopeChildren(k);for(m=0,j=h.length;m<j;m++){h[m]._applyBinding(o,g,k,f,p,true)}}},getOutOfBindingScopeChildren:function(f){return[]},_computeBinding:function(i,j,g,h){var f;if(j.constructor===String){f=this._computeStringBinding(i,j,g,h)}else{if(j.constructor===Object){f=this._computeObjectBinding(i,j,g,h)}else{if(j.constructor===Function){f=j.call(g,i,h)}}}return f},_computeStringBinding:function(k,n,f,g){var q,p,o=0,m=n.charAt(0),j,h,l;if(m==="@"){p=n.slice(1).split(".");o=p.length;if(o>0){q=k;for(j=0;j<o;j++){q=q[p[j]]}}}else{if(m==="$"){h=f[n.slice(1)];if(h!==undefined&&h.constructor===Function){q=h.call(f,k,g)}}else{if(m==="^"){l=e.exec(n);if(l[1]&&l[2]){q=b.tree.getCSSValue(l[1],l[2])}}}}return q},_computeObjectBinding:function(j,g,h,i){var f={},k;for(k in g){if(g.hasOwnProperty(k)){f[k]=this._computeBinding(j,g[k],h,i)}}return f}}}());(function(){b.ns("oui.lang");b.lang.LinkedListSupport={addLinkedList:function(C,u,n,B,g,h,A,l,x,y,s,r,v,m,w,o,i,z,k,q){var t=C.prototype,j,p,e,f;if(!b.isA(i,String)){i="_numChildren"}t[n]=null;t[B]=null;t[g]=null;t[h]=null;t[A]=null;t[i]=0;if(b.isA(m,String)&&b.isA(t[m],Function)){j=function(D){return this[m](D)}}if(!j){j=function(D){return b.isA(D,u)}}if(b.isA(w,String)){p=t[w]}if(!p){p=function(D){}}if(b.isA(o,String)){e=t[o]}if(!e){e=function(D){}}f="_safe"+x.charAt(0).toUpperCase()+x.slice(1);t[l]=function(D){return this[s](D)};t[s]=function(F,I){var D,E,G,H;if(j.call(this,F)===true){E=true;G=this;while(G&&G!==F){G=G[g]}if(G!==null){E=false;c.warn("WARN__HRCHY_REQ__INSERT_ANCEST")}}else{E=false;c.warn("WARN__HRCHY_REQ__INV_TYPE")}if(E){H=F[g];if(H!==null){H[f](F,(H===this))}if(!I){if(this[A]!==null){F[B]=this[A];this[A][n]=F}else{F[B]=null;this[h]=F}F[n]=null;this[A]=F;D=F}else{if(I===this[h]){this[h]=F;F[n]=I;F[B]=null;I[B]=F;D=F}else{if(I[g]===this){I[B][n]=F;F[B]=I[B];I[B]=F;F[n]=I;D=F}else{c.warn("WARN__NOTFOUND__INSERT")}}}if(D){F[g]=this;p.call(this,F,I,(H===this));this[i]++}}return D};t[f]=function(E,D){if(this[h]===E){this[h]=E[n];if(this[A]===E){this[A]=null}}else{if(this[A]===E){this[A]=E[B]}}if(E[B]!==null){E[B][n]=E[n]}if(E[n]!==null){E[n][B]=E[B]}E[B]=null;E[n]=null;E[g]=null;if(D!==true){e.call(this,E,false,true)}this[i]--};t[x]=function(E){var D;if(E&&E[g]===this){this[f](E,false);D=E}else{c.warn("WARN__NOTFOUND__REMOVE")}return D};t[y]=function(){var D=this[h],E;if(D!==null){while(D){E=D[n];D[g]=null;D[B]=null;D[n]=null;e.call(this,D,true,(E===null));D=E}this[h]=null;this[A]=null;this[i]=0}};t[r]=function(G,E){var D,F;if(b.isA(E,u)&&E[g]===this){F=E.nextSibling;this[x](E);this[s](G,F);D=E}return D};t[v]=function(){return(this[h]!==null)};if(b.isA(z,String)){t[z]=function(D){var F=null,E=this[i];if(D>=0&&D<E){F=this[h];E=0;while(E<D){F=F[n];E++}}return F}}if(b.isA(k,String)){t[k]=function(E){var D=0,F=this[h];while(F&&F!==E){F=F[n];D++}return(F===E)?D:-1}}if(b.isA(q,String)){t[q]=function(E,D){var F=this[z](D);this[s](E,F)}}}}}());(function(){b.ns("oui.lang");function f(m,l){return function(){return this[m][l]}}function k(n,m){var l=m.concat();return function(){var p=this[n],o,q=l.length;for(o=0;o<q;o++){p=p[l[o]]}return p}}function i(l){return function(n){var m;if(n.length===1){m=f(l,n[0])}else{m=k(l,n)}return m}}function h(l,m){return function(n){var o={};o[m]=n;this[l](o)}}function e(l,n){var m=n.concat();return function(r){var s={},p=s,o,q=m.length;for(o=0;o<q-1;o++){p[m[o]]={};p=p[m[o]]}p[m[q-1]]=r;this[l](s)}}function j(l){return function(n){var m;if(n.length===1){m=h(l,n[0])}else{m=e(l,n)}return m}}b.lang.PropertiesUtil={addConfig:function(w,l,t,u,o){var n=t+"Definition",p=function(){},r=this._getSuperConfig(w,t),v,m,q,s,x;if(r!==undefined){v=r.__configs[t].definitionClass;m=r.__configs[t].configClass;b.extend(p,v)}b.mixin(p,l);s=(function(y){return function(A){var C,B,z;if(A!==undefined){C=function(){};if(y!==undefined){b.extend(C,y)}for(B in A){C.prototype[B]=A[B]}this.definition=new C();b.buildDefaults(this.definition,this)}else{z=this.compounds;for(B in z){if(z.hasOwnProperty(B)){this[B]=new z[B]()}}}}}(v));q={updateObject:function(z,y){return b.applyProperties(z,this,this.definition,y)},definition:new p(),compounds:{}};this._getDefaultsAndCompounds(q.definition,q,q.compounds);if(m!==undefined){b.extend(s,m)}b.mixin(s,q);x=w;if(b.isA(w,Function)){x=w.prototype}if(u){this._addAccessors(l,"get",[],i("_"+t.toLowerCase()),x,true)}if(o){this._addAccessors(l,"set",[],j("apply"+t),x,false)}if(w.constructor===Function){w.prototype[n]=p;w.prototype[t]=s;w[n]=l}if(!w.__configs){w.__configs={}}w.__configs[t]={definitionClass:p,configClass:s}},_addAccessors:function(q,v,y,u,t,x){var l,m,s,r,o,w;if(q!==undefined){if(!this._isCompound(q)){m="";r=y.length;for(s=0;s<r;s++){o=y[s];if(o.length>0){m+=o.charAt(0).toUpperCase()+o.slice(1)}}l=u(y);if(x){t[m.charAt(0).toLowerCase()+m.slice(1)]=l}t[v+m]=l}else{w=q;if(q.type!==undefined){w=q.type}for(o in w){if(w.hasOwnProperty(o)===true){y.push(o);this._addAccessors(w[o],v,y,u,t,x);y.pop()}}}}},_getSuperConfig:function(l,n){var m=l.superClass;if(m){if(!m.__configs||!m.__configs[n]){m=this._getSuperConfig(m,n)}}return m},_isCompound:function(l){return(l.type===undefined&&l.constructor===Object)||(l.type!==undefined&&l.type.constructor===Object)},_compoundedDefaultsFactory:function(m){var l={},n={},o;this._getDefaultsAndCompounds(m,n,l);o=function(){var q;for(q in l){if(l.hasOwnProperty(q)===true){this[q]=new l[q]()}}};o.prototype=n;return o},_getDefaultsAndCompounds:function(m,o,l){var q,n;for(n in m){if((q=m[n])!==null&&q!==undefined&&q.constructor===Object){if(this._isCompound(q)){l[n]=this._compoundedDefaultsFactory(q)}else{o[n]=q.defaultValue}}}}};var g=b.lang.PropertiesUtil;b.addStyleSupport=function(l,m){g.addConfig(l,m,"Style",true,true)};b.addModelSupport=function(l,m){g.addConfig(l,m,"Model",false,false)};b.addPropertiesSupport=function(l,m){g.addConfig(l,m,"Properties",true,true)}}());(function(){b.declare({name:"oui.geom.Matrix",membersDef:{init:function(l,j,n,m,k,i){if(arguments.length>=1&&b.isA(l,Number)&&b.isA(j,Number)&&b.isA(n,Number)&&b.isA(m,Number)&&b.isA(k,Number)&&b.isA(i,Number)){this.a=l;this.b=j;this.c=n;this.d=m;this.tx=k;this.ty=i}else{this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0}},_safeTranslate:function(i,j){this.tx+=this.a*i+this.c*j;this.ty+=this.b*i+this.d*j;return this},_safeRotate:function(p,j,r){var l=(j!==0||r!==0),i,q,k=Math.cos(p),o=Math.sin(p);if(l){this._safeTranslate(j,r)}i=this.a;q=this.c;this.a=i*k+q*o;this.c=i*-o+q*k;i=this.b;q=this.d;this.b=i*k+q*o;this.d=i*-o+q*k;if(l){this._safeTranslate(-j,-r)}return this},_safeScale:function(i,j){this.a*=i;this.c*=j;this.b*=i;this.d*=j;return this},set:function(i){if(b.isA(i,b.geom.Matrix)){this.a=i.a;this.b=i.b;this.c=i.c;this.d=i.d;this.tx=i.tx;this.ty=i.ty}return this},isIdentity:function(){return this.tx===0&&this.ty===0&&this.a===1&&this.b===0&&this.c===0&&this.d===1},concat:function(i){if(b.isA(i,b.geom.Matrix)){this._concat(i)}return this},_concat:function(o){var n,m,l;n=this.a;m=this.c;l=this.tx;this.a=n*o.a+m*o.b;this.c=n*o.c+m*o.d;this.tx=n*o.tx+m*o.ty+l;n=this.b;m=this.d;l=this.ty;this.b=n*o.a+m*o.b;this.d=n*o.c+m*o.d;this.ty=n*o.tx+m*o.ty+l},transformAll:function(q,t){var l=q.length||0,s,o,r,p,n,m,k,j;t=t||q;l+=l%2;r=this.a;p=this.b;n=this.c;m=this.d;k=this.tx;j=this.ty;while(l--){s=q[--l];o=q[l+1];t[l]=r*s+n*o+k;t[l+1]=p*s+m*o+j}return t},transform:function(i,j){return{x:this.a*i+this.c*j+this.tx,y:this.b*i+this.d*j+this.ty}},det:function(){return(this.a*this.d)-(this.b*this.c)},inv:function(){var i,j=this.det();if(j!==0){i=new b.geom.Matrix();i.a=this.d/j;i.b=-this.b/j;i.c=-this.c/j;i.d=this.a/j;i.tx=(this.c*this.ty-this.tx*this.d)/j;i.ty=(this.tx*this.b-this.a*this.ty)/j}else{c.error("ERR__MTX__INV")}return i},clone:function(){var i=new b.geom.Matrix();i.a=this.a;i.b=this.b;i.c=this.c;i.d=this.d;i.tx=this.tx;i.ty=this.ty;return i},equals:function(k,i){var j=false;if(b.isA(k,b.geom.Matrix)){if(!i){j=k.a===this.a&&k.c===this.c&&k.tx===this.tx&&k.b===this.b&&k.d===this.d&&k.ty===this.ty}else{j=Math.abs(k.a-this.a)<i&&Math.abs(k.c-this.c)<i&&Math.abs(k.tx-this.tx)<i&&Math.abs(k.b-this.b)<i&&Math.abs(k.d-this.d)<i&&Math.abs(k.ty-this.ty)<i}}return j}}});b.geom.Matrix.IDENTITY=new b.geom.Matrix();function h(j){var i=j.length;return function(){var l=arguments,k=[];k.push.apply(k,l);if(k.length>0&&typeof k[0]==="number"){if(i===3&&l[1]===undefined){k[1]=0;k[2]=0}else{if(l[i-1]===undefined){k[i-1]=k[i-2]}}j.apply(this,k)}return this}}var g=b.geom.Matrix.prototype,e={},f;for(f in g){if(f.indexOf("_safe")===0){e[f.charAt(5).toLowerCase()+f.substr(6)]=h(g[f])}}b.mixin(b.geom.Matrix,e)}());(function(){var j="([+-]?\\d+(\\.\\d+)?)",h="translate\\(\\s*"+j+"\\s*,\\s*"+j+"\\s*\\)",g="matrix\\(\\s*"+j+"\\s*,\\s*"+j+"\\s*,\\s*"+j+"\\s*,\\s*"+j+"\\s*,\\s*"+j+"\\s*,\\s*"+j+"\\s*\\)",e=new RegExp(h,"g"),f=new RegExp(g,"g");function i(m,k){var l,n=null;f.lastIndex=0;e.lastIndex=0;if(b.isA(m,Array)&&m.length===6){n=new b.geom.Matrix(m[0],m[1],m[2],m[3],m[4],m[5])}else{l=f.exec(m);if(l===null){l=e.exec(m);if(l!==null){n=new b.geom.Matrix(1,0,0,1,parseFloat(l[1]),parseFloat(l[3]))}}else{n=new b.geom.Matrix(parseFloat(l[1]),parseFloat(l[3]),parseFloat(l[5]),parseFloat(l[7]),parseFloat(l[9]),parseFloat(l[11]))}}if(n===null){k.validValue=false}else{k.validValue=true;k.value=n}}b.mixin(b.defs,{Matrix:function(l,k){return b.defs._createDef("Matrix",b.geom.Matrix,l,k,i)}})}());(function(){b.ns("oui.geom");function g(i,h,j){return i+(h-i)*j}function f(i,h){return(i+h)/2}var e=5;b.mixin(b.geom,{DEG_TO_RAD:Math.PI/180,computeBounds:function(m){var n=m.length||0,j,l,k,h,p,o;if(n%2===0&&n>1){k=m[0];p=m[0];h=m[1];o=m[1];for(l=2;l<n;l+=2){k=m[l]<k?m[l]:k;p=m[l]>p?m[l]:p;h=m[l+1]<h?m[l+1]:h;o=m[l+1]>o?m[l+1]:o}j={x:k,y:h,width:p-k,height:o-h}}return j},intersectLine:function(s,i,q,h,k,p,j,m){var t=b.geom.slope(s,i,q,h),r=b.geom.slope(k,p,j,m),o=i-(t*s),l=p-(r*k),n,u;if(t===r||Math.abs(t-r)<0.000001){u=[]}else{if(!isFinite(t)){u=[s,r*s+l]}else{if(!isFinite(r)){u=[k,t*k+o]}else{n=(o-l)/(r-t);u=[n,(t*n+o+r*n+l)/2]}}}return u},intersectRect:function(l,k,q){var s,m,j,i,r,h,p,o,n;if(l&&k){if(q!==true){if((m=l.x)<=(p=k.x+k.width)&&(h=k.x)<=(j=l.x+l.width)&&(i=l.y)<=(n=k.y+k.height)&&(o=k.y)<=(r=l.y+l.height)){s={x:m>h?m:h,y:i>o?i:o};s.width=(j>p?p:j)-s.x;s.height=(r>n?n:r)-s.y}}else{if((m=l.x)<(p=k.x+k.width)&&(h=k.x)<(j=l.x+l.width)&&(i=l.y)<(n=k.y+k.height)&&(o=k.y)<(r=l.y+l.height)){s={x:m>h?m:h,y:i>o?i:o};s.width=(j>p?p:j)-s.x;s.height=(r>n?n:r)-s.y}}}return s},unionRect:function(m,k){var i,j,n,o,h;if(m&&k){j=Math.min(m.x,k.x);n=Math.min(m.y,k.y);o=Math.max(m.x+m.width,k.x+k.width);h=Math.max(m.y+m.height,k.y+k.height);i={x:j,y:n,width:o-j,height:h-n}}else{i=m||k}return i},calculateAngle:function(h,l,j,i){var k=Math.atan2(i,j)-Math.atan2(l,h);if(k<0){k+=2*Math.PI}return k},slope:function(i,k,h,j){return(h-i===0)?Number.POSITIVE_INFINITY:((j-k)/(h-i))},distSq:function(i,k,h,j){return(i-h)*(i-h)+(k-j)*(k-j)},dist:function(i,k,h,j){return Math.sqrt(b.geom.distSq(i,k,h,j))},centroid:function(o,k,h){var m=0,l=0,p=o.length,j=p-1;while(j>=0){m+=o[j][k];l+=o[j][h];j--}return{x:(m/p),y:(l/p)}},dotprod:function(h,k,j,i){return(h*j)+(k*i)},ptSegDistSq:function(j,n,i,l,p,o){var m,h,k;i-=j;l-=n;p-=j;o-=n;m=p*i+o*l;if(m<=0){h=0}else{p=i-p;o=l-o;m=p*i+o*l;if(m<=0){h=0}else{h=m*m/(i*i+l*l)}}k=p*p+o*o-h;if(k<0){k=0}return k},isPointInEllipse:function(i,m,h,l,k,j){i=(i-h)/k;m=(m-l)/j;return(i*i+m*m)<=1},isPointInTriangle:function(s,q,t,r,H,G,n,l){var A=b.geom.dotprod,k=n-t,j=l-r,p=H-t,o=G-r,F=s-t,D=q-r,E=A(k,j,k,j),C=A(k,j,p,o),B=A(k,j,F,D),i=A(p,o,p,o),h=A(p,o,F,D),m=1/(E*i-C*C),z=(i*B-C*h)*m,w=(E*h-C*B)*m;return(z>=0)&&(w>=0)&&(z+w<=1)},isValidRect:function(h){return h!==undefined&&h!==null&&!isNaN(h.x)&&!isNaN(h.y)&&h.width>=0&&h.height>=0},getBoundedXY:function(m,A,o,v){var j=b.geom,n=null,l,k,q,p,u,t,i,h,s,r,z,w;if(!b.isFiniteNumber(o)){o=e}if(j.isValidRect(m)&&j.isValidRect(A)){l=m.x;k=m.y;q=m.width;p=m.height;u=A.x+o;t=A.y+o;i=A.width-2*o;h=A.height-2*o;if(v){s=v.x;r=v.y;z=2*s-(l+q);w=2*r-(k+p)}if(i>q){if(l<u){l=u}else{if(l+q>u+i){l=u+i-q;if(v&&s>l&&s<l+q&&r>k&&r<k+p&&z>=u&&z+q<=u+i){l=z}}}}else{if(i===q){l=u}}if(h>p){if(k<t){k=t}else{if(k+p>t+h){k=t+h-p;if(v&&s>l&&s<l+q&&r>k&&r<k+p&&w>=t&&w+p<=t+h){k=w}}}}else{if(h===p){k=t}}n={x:l,y:k}}return n},getBoxCtrlPts:function(i,l,k,h){var j=[];if(k>0&&h>0){j.push(i,l,i+k,l,i+k,l+h,i,l+h)}else{if(k>0){j.push(i,l,i+k,l)}else{if(h>0){j.push(i,l,i,l+h)}else{j.push(i,l)}}}return j},crossLine:function(k,m,j,l,i,n){var h;if((i<k&&i<j)||(i>k&&i>j)||(n>m&&n>l)||(k===j)){h=0}else{if(i===k){h=k<j?0:-1}else{if(i===j){h=k<j?1:0}else{if((n-m)-(l-m)*(i-k)/(j-k)<0){h=(k<j)?1:-1}else{h=0}}}}return h},crossQuad:function(j,n,i,m,h,k,o,l){var p;if((o<j&&o<i&&o<h)||(o>j&&o>i&&o>h)||(l>n&&l>m&&l>k)||(j===i&&i===h)){p=0}else{p=b.geom.crossLine(j,n,i,m,o,l)+b.geom.crossLine(i,m,h,k,o,l)}return p},crossCubic:function(j,p,i,n,h,l,r,k,o,m){var q;if((o<j&&o<i&&o<h&&o<r)||(o>j&&o>i&&o>h&&o>r)||(m>p&&m>n&&m>l&&m>k)||(j===i&&i===h&&h===r)){q=0}else{q=b.geom.crossLine(j,p,i,n,o,m)+b.geom.crossLine(i,n,h,l,o,m)+b.geom.crossLine(h,l,r,k,o,m)}return q},cubic2Quad:function(y,x,I,H,m,k,A,z){var u=f(y,I),t=f(x,H),o=f(I,m),n=f(H,k),l=f(m,A),j=f(k,z),C=f(u,o),B=f(t,n),K=f(o,l),J=f(n,j),r=g(y,u,3/4),p=g(x,t,3/4),E=g(C,K,1/8),D=g(B,J,1/8),M=g(K,C,1/8),L=g(J,B,1/8),s=g(A,l,3/4),q=g(z,j,3/4),w=f(r,E),v=f(p,D),G=f(C,K),F=f(B,J),i=f(M,s),h=f(L,q);return[r,p,w,v,E,D,G,F,M,L,i,h,s,q,A,z]},quad2Cubic:function(q,p,m,l,j,h){var k=q+(2/3)*(m-q),i=p+(2/3)*(l-p),o=k+(1/3)*(j-q),n=i+(1/3)*(h-p);return[k,i,o,n,j,h]},_isFlatQuad:function(j,q,m,k,h,p,l,i){var n,r,o=b.geom.dist;if(i===undefined||i<0){n=2/l;r=o(j,q,m,k)+o(m,k,h,p)-o(j,q,h,p)}else{n=i*i;r=b.geom.ptSegDistSq(j,q,h,p,m,k)}return r<n},_isFlatCubic:function(j,t,q,m,p,l,h,s,n,i){var o,u,r=b.geom.dist,k;if(i===undefined||i<0){o=2/n;u=r(j,t,q,m)+r(q,m,p,l)+r(p,l,h,s)-r(j,t,h,s)}else{k=b.geom.ptSegDistSq;o=i*i;u=Math.max(k(j,t,h,s,q,m),k(j,t,h,s,p,l))}return u<o},flattenQuad:function(k,s,p,n,h,r,q,o,j){var x=b.geom.flattenQuad,i=b.geom._isFlatQuad,w,v,m,l,u,t;if(o<=0||i(k,s,p,n,h,r,o,j)){q.push(h,r)}else{o--;w=(k+p)/2;v=(s+n)/2;m=(p+h)/2;l=(n+r)/2;u=(w+m)/2;t=(v+l)/2;x(k,s,w,v,u,t,q,o,j);x(u,t,m,l,h,r,q,o,j)}},flattenCubic:function(w,i,s,C,q,B,v,h,u,z,A){var t=b.geom.flattenCubic,D=b.geom._isFlatCubic,r,o,F,m,E,l,y,k,x,j,p,n;if(z<=0||D(w,i,s,C,q,B,v,h,z,A)){u.push(v,h)}else{z--;r=(s+q)/2;o=(C+B)/2;F=(w+s)/2;m=(i+C)/2;E=(F+r)/2;l=(m+o)/2;x=(q+v)/2;j=(B+h)/2;y=(r+x)/2;k=(o+j)/2;p=(E+y)/2;n=(l+k)/2;t(w,i,F,m,E,l,p,n,u,z,A);t(p,n,y,k,x,j,v,h,u,z,A)}}})}());(function(){function e(j,l,h,k,g,i){return(h-j)*(i-l)-(k-l)*(g-j)}function f(j,o,h,m,g,l){var p,n,k,q=(h-j),i=(m-o);p=((g-j)*q+(l-o)*i)/(q*q+i*i);n=j+p*q;k=o+p*i;return(n-g)*(n-g)+(k-l)*(k-l)}b.mixin(b.geom,{computeConvexHull:function(h){var g,i=h.length;if(i>2&&(i%2)===0){g=this._quickHull(h)}else{if(i===2){g=[h[0],h[1]]}else{g=[]}}return g},_quickHull:function(y){var t=[],p=y.length,h,q,s,v,u,g,o,m,k,j,w;for(s=h=q=0;s<p;s+=2){v=y[s];if(y[q]<v||(y[q]===v&&y[q+1]<y[s+1])){q=s}if(y[h]>v||(y[h]===v&&y[h+1]>y[s+1])){h=s}}if(q===h){t.push(y[q],y[q+1])}else{u=[];g=[];o=y[q];m=y[q+1];k=y[h];j=y[h+1];for(s=0;s<p;s+=2){if(s===q||s===h){continue}w=e(o,m,k,j,y[s],y[s+1]);if(w>0){u.push(y[s],y[s+1])}else{if(w<0){g.push(y[s],y[s+1])}}}t.push(k,j);b.geom._quickHullRecurse(k,j,o,m,u,t);t.push(o,m);b.geom._quickHullRecurse(o,m,k,j,g,t)}return t},_quickHullRecurse:function(j,s,h,r,v,m){var l,k=v.length,g,p,u,t,q,o;if(k>0){l=b.geom._farthestPointIndex(j,s,h,r,v);g=v[l];p=v[l+1];u=[];t=[];for(l=0;l<k;l+=2){q=v[l];o=v[l+1];if((q===j&&o===s)||(q===h&&o===r)){continue}else{if(e(g,p,j,s,q,o)>0){u.push(q,o)}else{if(e(h,r,g,p,q,o)>0){t.push(q,o)}}}}b.geom._quickHullRecurse(j,s,g,p,u,m);m.push(g,p);b.geom._quickHullRecurse(g,p,h,r,t,m)}},_farthestPointIndex:function(h,q,g,p,s){var k,j=s.length,t=-1,r=-1,o,m,l;for(k=0;k<j;k+=2){o=s[k];m=s[k+1];if((o===h&&m===q)||(o===g&&m===p)){continue}l=f(h,q,g,p,o,m);if(l>r){r=l;t=k}}return t}})}());(function(){b.UIEvents={ACTIVATE:"activate",FOCUS_IN:"focusIn",FOCUS_OUT:"focusOut"};b.MouseEvents={CLICK:"click",DBL_CLICK:"dblClick",MOUSE_DOWN:"mouseDown",MOUSE_UP:"mouseUp",MOUSE_OVER:"mouseOver",MOUSE_OUT:"mouseOut",MOUSE_MOVE:"mouseMove",MOUSE_ENTER:"mouseEnter",MOUSE_LEAVE:"mouseLeave",MOUSE_WHEEL:"mouseWheel"};b.KeyEvents={KEY_DOWN:"keyDown",KEY_UP:"keyUp"};b.SyncEvents={BEGIN:"begin",END:"end",REPEAT:"repeat"};b.DragEvents={DRAG:"drag",DRAG_START:"dragStart",DRAG_END:"dragEnd"};b.TouchEvents={TOUCH_START:"touchStart",TOUCH_END:"touchEnd",TOUCH_MOVE:"touchMove",TOUCH_ENTER:"touchEnter",TOUCH_LEAVE:"touchLeave"};b.GenericGestureEvents={GESTURE_START:"gestureStart",GESTURE_CHANGE:"gestureChange",GESTURE_END:"gestureEnd"};b.GestureEvents={TAP:"tap",DBL_TAP:"dblTap",TOUCH_LONG_PRESS:"touchLongPress",PRESS_AND_TAP:"pressAndTap",SWIPE:"swipe",PINCH:"pinch"};b.GestureEventPhases={BEGIN:"Begin",CHANGE:"Change",CANCEL:"Cancel",END:"End"};b.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};b.ViewEvents={LOAD:"load",VIEWPORT_RESIZE:"viewportResize",RELEASE_FOCUS:"releaseFocus",FOCUS_COMPONENT:"focusComponent",BLUR_COMPONENT:"blurComponent",USER_EVENTS_SUPPORTED:"userEventsSupported",ABOUT_INFO_REQUEST:"aboutInfoRequest",DEVICE_ORIENTATION:"deviceOrientation"}}());(function(){b.ns("oui.events");var i="CAPTURE",j="BUBBLE";function e(m,l){if(m){if(m.handleEvent){m.handleEvent(l)}else{m.call(null,l)}}}function k(l){return(typeof l==="function"||(l!==null&&l!==undefined&&typeof l.handleEvent==="function"))}function f(l){this.defaultPrevented=true;if(l!==true&&this.preventNativeDefault){this.preventNativeDefault()}}function g(l){this.stopped=true;if(l!==true&&this.stopNativePropagation){this.stopNativePropagation()}}function h(l){this.stoppedImmediate=true;this.stopPropagation(l)}b.events.EventSupport={_snapshotListeners:function(p){var o=[],n=[],r=[],m=[],l=[],q=this;p=p.toLowerCase();while(q){o.push(q);q._appendListeners(p,n,r,m,l);q=q.parentNode}return{nodes:o,bubbleListeners:n,captureListeners:r,bubbleIndices:m,captureIndices:l}},_appendListeners:function(o,q,m,l,n){var p=this.listeners;n.push(m.length);if(p&&p[o]){m.push.apply(m,p[o][i]);q.push.apply(q,p[o][j])}l.push(q.length-1)},_checkListeners:function(){if(this.listeners===undefined){this.listeners={}}},addEventListener:function(p,q,m){var r,l,o,n=false;if(typeof p==="string"&&k(q)){p=p.toLowerCase();this._checkListeners();if(this.listeners[p]===undefined){this.listeners[p]={};this.listeners[p][i]=[];this.listeners[p][j]=[]}r=m===true?i:j;l=this.listeners[p][r];o=l.length;while(o--&&!n){n=(q===l[o])}if(!n){l.push(q)}}},removeEventListener:function(n,o,m){var l,p;if(typeof n==="string"&&k(o)&&this.listeners){n=n.toLowerCase();l=this.listeners[n];if(l){p=m===true?i:j;b.arrayRemove(l[p],o,false)}}},dispatchEvent:function(l){var u,p,v,m,n,q,x,z,r,y,o,w,t,s;if(l&&typeof l.type==="string"){l.timeStamp=b.currentTimeMillis();u=(l.bubbles!==false);p=(l.cancelable===true);v=null;if(typeof l.defaultAction==="function"){v=l.defaultAction}l.CAPTURING_PHASE=1;l.AT_TARGET=2;l.BUBBLING_PHASE=3;l.preventDefault=f;l.stopPropagation=g;l.stopImmediatePropagation=h;m=this._snapshotListeners(l.type);n=m.nodes;q=m.captureListeners;x=m.bubbleListeners;z=m.captureIndices;r=m.bubbleIndices;l.eventPhase=l.CAPTURING_PHASE;l.target=this;l.stopped=false;l.stoppedImmediate=false;l.defaultPrevented=false;y=q.length-1;for(t=n.length-1;t>0&&l.stopped===false;t--){l.currentTarget=n[t];for(s=y;s>=z[t]&&l.stoppedImmediate===false;s--){e(q[y],l);y--}}l.eventPhase=l.AT_TARGET;l.currentTarget=this;o=0;if(l.stopped!==true){for(s=y;s>=0&&l.stoppedImmediate===false;s--){e(q[y],l);y--}for(s=0;s<=r[0]&&l.stoppedImmediate===false;s++){e(x[o],l);o++}}if(u){l.eventPhase=l.BUBBLING_PHASE;w=n.length;for(t=1;t<w&&l.stopped===false;t++){l.currentTarget=n[t];for(s=o;s<=r[t]&&l.stoppedImmediate===false;s++){e(x[o],l);o++}}}if(v!==null&&(p===false||l.defaultPrevented!==true)){v.call(null,l)}}},getDefaultActivateAction:function(){var l;if(this.activateAction){l=this.activateAction}else{if(b.isA(this.getActivateAction,Function)){l=this.getActivateAction()}}return l},handler:function(p,n,m,l,q){var o=null,r=null;if(p){if(typeof p==="string"){if(typeof this[p]==="function"){o=this;r=this[p]}}else{if(typeof p==="function"){r=p}else{if(typeof p.handleEvent==="function"){o=p;r=p.handleEvent}}}}if(!r){c.error("ERR__EVT__INV_HANDLER")}return function(s){if(b.isValueInConstraint(s,q)){if(l===true){s.stopPropagation()}if(m===true){s.preventDefault()}r.call(o,s,n)}}}}}());(function(){b.ns("oui.events");var l=b.events,i=b.defs,m={},o,s,n,r,p,f,k;function e(w,v){var t,u=Math.min(w.length,v.length);for(t=0;t<u;t++){if(w[t]!==v[t]){break}}return(t-1)}function g(){l._stopNextNativeMouseEvent(this.type,this.clientX,this.clientY)}r={mousedown:function(t,u){if(!o||u!==o.target||t.clientX!==o.clientX||t.clientY!==o.clientY){n=1}else{n++}if(t.hasOwnProperty("detail")===false){t.detail=n}o=t},mouseup:function(t,u){if(!o||u!==o.target||t.clientX!==o.clientX||t.clientY!==o.clientY){n=1}if(t.hasOwnProperty("detail")===false){t.detail=n}}};p={mouseover:function(t){l.handleEnter(t.target,t.relatedTarget,b.MouseEvents.MOUSE_ENTER,t)},mouseout:function(t){l.handleLeave(t.target,t.relatedTarget,b.MouseEvents.MOUSE_LEAVE,t)},mousedown:function(t){var u=t.target,v=u;if(b.focus.isFocusableTarget(u)!==true){v=b.focus.getFocusableAncestor(u)}if(v!==null){b.focusManager.requestFocus(v,t);v.dispatchEvent({type:b.UIEvents.ACTIVATE,defaultAction:v.getDefaultActivateAction()})}},mouseup:function(w){var v=b.MouseEvents.CLICK,u=b.MouseEvents.DBL_CLICK,t;if(o&&w.target===o.target&&w.clientX===o.clientX&&w.clientY===o.clientY){t={type:v,clientX:w.clientX,clientY:w.clientY,pageX:w.pageX,pageY:w.pageY,userX:w.userX,userY:w.userY,ctrlKey:w.ctrlKey,shiftKey:w.shiftKey,altKey:w.altKey,button:w.button,detail:w.detail,defaultAction:null,stopNativePropagation:g};w.target.dispatchEvent(t);if(s&&t.target===s.target&&t.userX===s.userX&&t.userY===s.userY&&t.button===s.button&&t.detail%2===0&&t.timeStamp-s.timeStamp<500){t.target.dispatchEvent({type:u,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY,userX:t.userX,userY:t.userY,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,button:t.button,detail:t.detail,defaultAction:null,stopNativePropagation:g})}s=t}}};f={KEYS:"KEYS",MOUSE:"MOUSE",WHEEL:"WHEEL",TOUCHES:"TOUCHES",GESTURES:"GESTURES"};k=function(){this._initProperties()};b.mixin(k,b.lang.PropertiesSupport);b.mixin(k,{onPropChanged:function(u){var t=this._properties.fromPlatform;switch(u){case f.KEYS:l.toggleNativeKeys(t.keyEvents);break;case f.MOUSE:l.toggleNativeMouse(t.mouseEvents);break;case f.WHEEL:l.toggleNativeWheel(t.wheelEvents);break;case f.TOUCHES:l.toggleNativeTouches(t.touchEvents);break;case f.GESTURES:l.toggleNativeGestures(t.gestureEvents);break;default:}}});b.addPropertiesSupport(k,{fromPlatform:{keyEvents:i.Boolean(false,f.KEYS),mouseEvents:i.Boolean(false,f.MOUSE),wheelEvents:i.Boolean(false,f.WHEEL),touchEvents:i.Boolean(false,f.TOUCHES),gestureEvents:i.Boolean(false,f.GESTURES)},fromContainer:{keyEvents:i.Boolean(true),mouseEvents:i.Boolean(true),wheelEvents:i.Boolean(true),touchEvents:i.Boolean(true),gestureEvents:i.Boolean(true)}});b.mixin(b.events,{_userEventsSupport:new k(),setUserEventsSupported:function(t){l._userEventsSupport.applyProperties(t)},getUserEventsSupported:function(){var t=l._userEventsSupport;return{fromPlatform:{keyEvents:t.fromPlatformKeyEvents(),mouseEvents:t.fromPlatformMouseEvents(),wheelEvents:t.fromPlatformWheelEvents(),touchEvents:t.fromPlatformTouchEvents(),gestureEvents:t.fromPlatformGestureEvents()},fromContainer:{keyEvents:t.fromContainerKeyEvents(),mouseEvents:t.fromContainerMouseEvents(),wheelEvents:t.fromContainerWheelEvents(),touchEvents:t.fromContainerTouchEvents(),gestureEvents:t.fromContainerGestureEvents()}}},toggleNativeKeys:function(t){},toggleNativeMouse:function(t){},toggleNativeWheel:function(t){},toggleNativeTouches:function(t){},toggleNativeGestures:function(t){},dispatchExternalEvent:function(u){var t=null;if(typeof b.config.catchAllEventListener==="function"&&u){u.domId=b.config.domId;b.config.catchAllEventListener(u,u.domId);t=u.returnValue}return t},handleExternalEvent:function(A){var C=l._userEventsSupport,D,u,y,v,t=C.fromContainerKeyEvents(),x=C.fromContainerMouseEvents(),B=C.fromContainerWheelEvents(),w=C.fromContainerTouchEvents(),z=C.fromContainerGestureEvents();if(A===null){c.warn("WARN__EVT__NPE")}else{if(A){u={type:A.type};y=null;if(b.hasOwnValue(b.KeyEvents,u.type,true)){if(t){u.cancelable=true;y=b.focusManager.getFocusOwner();u.keyCode=A.keyCode;l._getModifiers(u,A)}}else{if(b.equalIgnoreCase(b.MouseEvents.MOUSE_WHEEL,u.type)){if(B){y=l._getNodeFromContainer(A);if(y){l._getCoordsFromContainer(u,A,y);l._getModifiers(u,A);if(typeof A.delta==="number"){u.delta=A.delta}else{u.delta=0}}}}else{if(b.hasOwnValue(b.MouseEvents,u.type,true)){if(x){y=l._getNodeFromContainer(A);if(y){l._getCoordsFromContainer(u,A,y);l._getModifiers(u,A);if(b.equalIgnoreCase(b.MouseEvents.MOUSE_OVER,u.type)||b.equalIgnoreCase(b.MouseEvents.MOUSE_OUT,u.type)){u.relatedTarget=null}if(typeof A.button==="number"){u.button=A.button}else{u.button=0}}}}else{if(b.hasOwnValue(b.TouchEvents,u.type,true)){if(w){y=l._getNodeFromContainer(A);if(y){l._getCoordsFromContainer(u,A,y);l._getModifiers(u,A)}}}else{if(b.hasOwnValue(b.GenericGestureEvents,u.type,true)){if(z){y=b.rootNode;u.rotation=A.rotation;u.scale=A.scale}}else{y=b.rootNode;for(v in A){if(v!=="type"){u[v]=A[v]}}}}}}}if(y!==null){l._dispatchTo(y,u)}D=u.returnValue}}return D},_dispatchKeyEvent:function(v){var t,u=b.focusManager.getFocusOwner();if(u!==null){t=l._createAPIEvent(v,true);l._getKeyArgs(t,v);l._dispatchTo(u,t)}},_dispatchMouseEvent:function(v){var t,u=l._getAPITarget(v);if(u!==null){t=l._createAPIEvent(v);l._getMouseArgs(t,v,u);l._dispatchTo(u,t)}},_dispatchTouchEvent:function(w){var v=l._createAPIEvent(w,true),C=w.changedTouches,E=C.length,F=[],u=w.targetTouches,I=u.length,D=[],G=w.touches,z=G.length,B=[],H,A,y,x;if(v.type===b.TouchEvents.TOUCH_START){for(H=0;H<E;H++){A=C[H];y=l._createAPITouch(A);if(y){x={touchValue:y,relatedTarget:null};m[A.identifier]=x;l._handleTouchEnterLeave(A,x);F.push(y)}}}else{for(H=0;H<E;H++){A=C[H];x=m[A.identifier];if(x){y=x.touchValue;l._updateAPITouch(A,y);l._handleTouchEnterLeave(A,x);F.push(y)}}}for(H=0;H<I;H++){A=u[H];x=m[A.identifier];if(x){D.push(x.touchValue)}}for(H=0;H<z;H++){A=G[H];x=m[A.identifier];if(x){B.push(x.touchValue)}}v.changedTouches=F;v.targetTouches=D;v.touches=B;l._getModifiers(v,w);l._getGestureArgs(v,w);if(F.length>0&&F[0].target){l._dispatchTo(F[0].target,v)}},_handleTouchEnterLeave:function(v,u){var w=l._getAPITarget(v),t;if(w!==null){t=u.relatedTarget;if(w!==t){if(t!==null){l.handleLeave(t,w,b.TouchEvents.TOUCH_LEAVE,u.touchValue)}l.handleEnter(w,t,b.TouchEvents.TOUCH_ENTER,u.touchValue)}u.relatedTarget=w}},handleEnter:function(z,t,w,y){var x=z.getAncestors(),u=-1,v;if(t!==null){u=e(x,t.getAncestors())}for(v=u+1;v<x.length;v++){x[v].dispatchEvent({type:w,clientX:y.clientX,clientY:y.clientY,userX:y.userX,userY:y.userY,ctrlKey:y.ctrlKey,shiftKey:y.shiftKey,altKey:y.altKey,relatedTarget:t,bubbles:false})}},handleLeave:function(z,t,w,y){var x=z.getAncestors(),u=-1,v;if(t!==null){u=e(x,t.getAncestors())}for(v=x.length-1;v>u;v--){x[v].dispatchEvent({type:w,clientX:y.clientX,clientY:y.clientY,userX:y.userX,userY:y.userY,ctrlKey:y.ctrlKey,shiftKey:y.shiftKey,altKey:y.altKey,relatedTarget:t,bubbles:false})}},_createAPITouch:function(){},_updateAPITouch:function(){return null},_dispatchGestureEvent:function(u){var t=l._createAPIEvent(u,true);l._getGestureArgs(t,u);l._dispatchTo(b.rootNode,t)},_createAPIEvent:function(t,u){return{type:l._getAPIType(t),cancelable:u,preventNativeDefault:l._preventNativeDefault(t),stopNativePropagation:l._stopNativePropagation(t)}},_dispatchTo:function(x,w){var t=w.type.toLowerCase(),v=r[t],u=p[t];if(v){v(w,x)}x.dispatchEvent(w);if(u){u(w)}b.tree.layout()},_getModifiers:function(u,t){u.ctrlKey=t.ctrlKey;u.shiftKey=t.shiftKey;u.altKey=t.altKey},_getNodeFromContainer:function(w){var v=null,u=w.clientX,t=w.clientY,x=w.delta;if(isFinite(u)&&isFinite(t)){v=b.tree.getNodeAt(u,t)}else{if(isFinite(x)){v=b.rootNode}}return v},_getCoordsFromContainer:function(t,x,w){var v=x.clientX,u=x.clientY,y=w.globalToLocal(v,u);t.clientX=v;t.clientY=u;t.pageX=x.pageX;t.pageY=x.pageY;t.userX=y.x;t.userY=y.y},_getAPIType:function(){return undefined},_preventNativeDefault:function(t){return function(){t.preventDefault()}},_stopNativePropagation:function(t){return function(){t.stopPropagation()}},_stopNextNativeMouseEvent:function(){},_getAPITarget:function(){return null},_getKeyArgs:function(){},_getMouseArgs:function(){},_getGestureArgs:function(){}});function h(t){return function(v,u){this.addEventListener(t,v,u)}}function j(t){return function(v,u){this.removeEventListener(t,v,u)}}function q(t){return function(w){var u="",v="";if(w===undefined){w=0}u+=t;v+=w;if(!this._eventDescCache){this._eventDescCache={}}if(!this._eventDescCache[u]){this._eventDescCache[u]={}}if(!this._eventDescCache[u][v]){this._eventDescCache[u][v]={source:this,type:t,offset:w}}return this._eventDescCache[u][v]}}b.addEventsSupport=function(B,v){var z=B.superClass,y=B.prototype,C={},A,t,x,w,u;if(b.isA(v,Array)){x={};for(w=0,u=v.length;w<u;w++){b.mixin(x,v[w])}v=x}if(z&&z.prototype.events){C.prototype=z.prototype.events}for(t in v){if(v.hasOwnProperty(t)){A=v[t];C[t]=A;x=A.charAt(0).toUpperCase()+A.substr(1);y["on"+x]=h(A);y["off"+x]=j(A);y["on"+x+"At"]=q(A)}}y.events=C}}());(function(){var n=b.events,r=null,w=b.MouseEvents,x=b.KeyEvents,y=b.TouchEvents,q=b.GenericGestureEvents,t=b.CursorType.AUTO,v={},o="mousedown",g="mouseup",u="mouseover",B="mouseout",s="mousemove",m="keydown",i="keyup",e="touchstart",l="touchmove",f="touchend",p="gesturestart",k="gesturechange",j="gestureend";v[o]=w.MOUSE_DOWN;v[g]=w.MOUSE_UP;v[s]=w.MOUSE_MOVE;v[u]=w.MOUSE_OVER;v[B]=w.MOUSE_OUT;v[m]=x.KEY_DOWN;v[i]=x.KEY_UP;v[e]=y.TOUCH_START;v[l]=y.TOUCH_MOVE;v[f]=y.TOUCH_END;v[p]=q.GESTURE_START;v[k]=q.GESTURE_CHANGE;v[j]=q.GESTURE_END;function h(C){var E=n._getAPITarget(C),D;D={type:C.type,apiTarget:E,clientX:C.clientX,clientY:C.clientY,ctrlKey:C.ctrlKey,shiftKey:C.shiftKey,altKey:C.altKey,detail:C.detail,button:C.button,stopPropagation:function(){C.stopPropagation()},preventDefault:function(){C.preventDefault()}};if(E){n._dispatchMouseEvent(D)}if(E!==r){if(r){D.type=B;D.apiTarget=r;D.apiRelatedTarget=E;D.stopPropagation=b.NO_OP;D.preventDefault=b.NO_OP;n._dispatchMouseEvent(D)}if(E){D.type=u;D.apiTarget=E;D.apiRelatedTarget=r;D.stopPropagation=b.NO_OP;D.preventDefault=b.NO_OP;n._dispatchMouseEvent(D)}}r=E}function A(C){C.apiTarget=r;C.apiRelatedTarget=null;n._dispatchMouseEvent(C);r=null}function z(C){return(C?"add":"remove")+"EventListener"}b.mixin(b.events,{_stopNextNativeMouseEvent:function(F,C,H){var D=b.tree.canvas,E=F.toLowerCase(),G;G=function(I){var J=n.cvClientToRootCoords(I);if(C===J.x&&H===J.y){I.stopPropagation()}D.removeEventListener(E,G,true)};D.addEventListener(E,G,true)},_getAPIType:function(C){return v[C.type]},_getAPITarget:function(C){var D=null,E;if(!C.apiTarget){E=this.cvClientToRootCoords(C);D=b.tree.getNodeAt(E.x,E.y)}else{D=C.apiTarget}return D},_getKeyArgs:function(D,C){D.keyCode=C.keyCode;this._getModifiers(D,C)},_getMouseArgs:function(D,C,F){var E=C.type,G=this.cvClientToRootCoords(C);this.cvSetCoords(D,C,F,G);this._getModifiers(D,C);if(C.button!==undefined){D.button=C.button}if(E===u){D.relatedTarget=C.apiRelatedTarget;this.cvSetCursor(F)}else{if(E===B){D.relatedTarget=C.apiRelatedTarget;this.cvSetCursor(null)}}},_createAPITouch:function(C){var E,D=this.cvClientToRootCoords(C),F=b.tree.getNodeAt(D.x,D.y);if(F){E={identifier:C.identifier,target:F};this.cvSetCoords(E,C,F,D)}return E},_updateAPITouch:function(C,E){var D=this.cvClientToRootCoords(C);this.cvSetCoords(E,C,E.target,D)},_getGestureArgs:function(D,C){D.rotation=C.rotation;D.scale=C.scale},cvClientToRootCoords:function(C){var D=b.tree.cvGetRootClientCoords();return{x:(C.clientX-D.x),y:(C.clientY-D.y)}},cvSetCoords:function(C,E,F,D){var G=F.globalToLocal(D.x,D.y);C.clientX=D.x;C.clientY=D.y;C.userX=G.x;C.userY=G.y;C.screenX=E.screenX;C.screenY=E.screenY},toggleNativeKeys:function(E){var D=b.tree.canvas,C=z(E);D[C](m,this._dispatchKeyEvent,false);D[C](i,this._dispatchKeyEvent,false)},toggleNativeMouse:function(E){var D=b.tree.canvas,C=z(E);D[C](o,this._dispatchMouseEvent,false);D[C](g,this._dispatchMouseEvent,false);D[C](s,h,false);D[C](B,A,false)},toggleNativeTouches:function(E){var D=b.tree.canvas,C=z(E);D[C](e,this._dispatchTouchEvent,false);D[C](l,this._dispatchTouchEvent,false);D[C](f,this._dispatchTouchEvent,false)},toggleNativeGestures:function(E){var D=b.tree.canvas,C=z(E);D[C](p,this._dispatchGestureEvent,false);D[C](k,this._dispatchGestureEvent,false);D[C](j,this._dispatchGestureEvent,false)},cvSetCursor:function(D){var C=b.tree.canvas,E=t;while(D&&E===t){E=D.cursor();D=D.parentNode}C.style.cursor=(typeof E==="object"?"none":E)},cvGetLastTarget:function(){return r}})}());(function(){b.ns("oui.events");b.events.addDragSupport=function(l){var i,j,o,e,n,m,k,f,h,g;j=function(p){var r,q,v,t,u,s,x,w;p.stopPropagation();p.preventDefault();if(p.changedTouches===undefined){r=p.clientX;q=p.clientY}else{w=p.changedTouches[0];r=w.clientX;q=w.clientY}x=n.globalToLocal(r,q);v=x.x;t=x.y;x=n.globalToLocal(h,g);u=x.x;s=x.y;n.dispatchEvent({type:b.DragEvents.DRAG,cancelable:true,dragClientX:(r-h),dragClientY:(q-g),dragUserX:(v-u),dragUserY:(t-s),clientX:r,clientY:q,userX:v,userY:t,shiftKey:p.shiftKey,ctrlKey:p.ctrlKey,defaultAction:n.getDefaultDragAction()});h=r;g=q};o=function(p){var s,q,u,t,x,w,A,y,r,z,v;l.offMouseMove(j);l.offMouseUp(o);l.offTouchMove(j);l.offTouchEnd(o);l.offMouseLeave(o);if(n){A=n.globalToLocal(m,k);x=A.x;w=A.y;s=h;q=g;y=false;r=false;if(p){if(p.changedTouches===undefined){s=p.clientX;q=p.clientY}else{v=p.changedTouches[0];s=v.clientX;q=v.clientY}y=p.shiftKey;r=p.ctrlKey;z=p.timeStamp-f}A=n.globalToLocal(s,q);u=A.x;t=A.y;n.dispatchEvent({type:b.DragEvents.DRAG_END,cancelable:true,shiftKey:y,ctrlKey:r,clientX:s,clientY:q,userX:u,userY:t,totalDragClientX:(s-m),totalDragClientY:(q-k),totalDragUserX:(u-x),totalDragUserY:(t-w),totalDragTime:z});n=undefined}};e=function(){l.onMouseLeave(o)};i=function(t){var v=t.target,s,r,u=t.touches,p,q=false,w;if(u!==undefined){if(u.length===1){p=u[0]}else{q=true}}if(q){o(t)}else{while(v&&!v.draggable()){v=v.parentNode}if(v){n=v;if(p===undefined){s=t.clientX;r=t.clientY}else{s=p.clientX;r=p.clientY}w=n.globalToLocal(s,r);n.dispatchEvent({type:b.DragEvents.DRAG_START,cancelable:true,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,clientX:s,clientY:r,userX:w.x,userY:w.y,defaultAction:e,stopDrag:o});m=h=s;k=g=r;f=t.timeStamp;l.onMouseMove(j);l.onMouseUp(o);l.onTouchMove(j);l.onTouchEnd(o)}}};l.onMouseDown(i);l.onTouchStart(i)}}());var b=b||{};(function(){function e(t,u,n,p,i,m,k,l,s,h,r,o,q){var j=document.createEvent("MouseEvents");j.initMouseEvent(t,u,n,window,p,i.x,i.y,m,k,l,h,s,r,o,q);return j}function g(u,w,n,q,i,m,k,l,t,h,s,p,r,v,o,x){var j=document.createEvent("TouchEvent");j.initTouchEvent(u,w,n,window,q,i.x,i.y,m,k,l,h,t,s,p,r,v,o,x);return j}function f(h){return{x:h.screenX,y:h.screenY}}b.addGestureSupport=function(n,r,m,u,j,l,h){var s,q,i,t,v,p,o={},k;r=r||e;m=m||g;u=u||f;if(typeof j!=="number"){j=500}if(typeof l!=="number"){l=800}if(typeof h!=="number"){h=10}t=function(w){return function(){var z=o[w.identifier],x,y;if(z&&z.longPressTimeoutID){x=z.event;y=r("touchlongpress",true,true,k,u(w),w.clientX,w.clientY,x.ctrlKey,x.shiftKey,x.altKey,x.metaKey,0,w.target);w.target.dispatchEvent(y);z.longPressTimeoutID=undefined}}};q=function(y){var x=y.changedTouches,w,z=x.length,A,B;for(w=0;w<z;w++){B=x[w];A=o[B.identifier];if(A.longPressTimeoutID&&Math.abs(B.clientX-A.clientX)>h&&Math.abs(B.clientY-A.clientY)>h){clearTimeout(A.longPressTimeoutID);A.longPressTimeoutID=undefined}}};v=function(x){var w;if(x.detail>1&&x.timeStamp-p.timeStamp<j){w=r("dbltap",true,true,x.detail,u(x),x.clientX,x.clientY,x.ctrlKey,x.shiftKey,x.altKey,x.metaKey,0,x.target);x.target.dispatchEvent(w)}p=x};i=function(y){var D,B,C,A,w,x,E,z;n.removeEventListener("touchend",i,true);if(y.fake!==true){D=y.changedTouches;C=D.length;for(B=0;B<C;B++){A=D[B];w=o[A.identifier];if(w){if(w.longPressTimeoutID){clearTimeout(w.longPressTimeoutID);w.longPressTimeoutID=undefined}if(Math.abs(A.clientX-w.clientX)<h&&Math.abs(A.clientY-w.clientY)<h&&y.timeStamp-w.timeStamp<j){y.stopPropagation(true);x=m("touchend",true,true,y.detail,u(y),y.clientX,y.clientY,y.ctrlKey,y.shiftKey,y.altKey,y.metaKey,y.touches,y.targetTouches,y.changedTouches,y.scale,y.rotation);x.fake=true;y.target.dispatchEvent(x);if(x.defaultPrevented===true){y.preventDefault()}if(x.stopped===true){y.stopPropagation()}z=1;if(p&&Math.abs(A.clientX-p.clientX)<h&&Math.abs(A.clientY-p.clientY)<h){z=p.detail+1}E=r("tap",true,true,z,u(A),A.clientX,A.clientY,y.ctrlKey,y.shiftKey,y.altKey,y.metaKey,0,y.target);y.target.dispatchEvent(E);v(E)}o[A.identifier]=undefined}}}};s=function(z){var y=z.changedTouches,x,A=y.length,B,w;k=z.touches.length;for(x=0;x<A;x++){B=y[x];w={identifier:B.identifier,screenX:B.screenX,screenY:B.screenY,clientX:B.clientX,clientY:B.clientY,event:z};o[B.identifier]=w;w.timeStamp=z.timeStamp;w.longPressTimeoutID=setTimeout(t(B,o),l)}n.addEventListener("touchmove",q,true);n.addEventListener("touchend",i,true)};n.addEventListener("touchstart",s,true)}}());(function(){b.ns("oui.events");b.events.addPressNTapSupport=function(e){var f;e.onTouchStart(function(g){f=g});e.onTouchMove(function(){f=undefined});e.onTap(function(g){if(f){if(g.identifier!==f.identifier){f.target.dispatchEvent({type:b.GestureEvents.PRESS_AND_TAP,clientX:f.clientX,clientY:f.clientY,userX:f.userX,userY:f.userY,tapClientX:(g.clientX-f.clientX),tapClientY:(g.clientX-f.clientY),tapUserX:(g.userX-f.userX),tapUserY:(g.userY-f.userY),ctrlKey:f.ctrlKey,shiftKey:f.shiftKey})}f=undefined}});e.onTouchEnd(function(g){if(f&&g.identifier===f.identifier){f=undefined}})}}());(function(){var g=20,e=0.2;function f(j,h){var i=b.geom.centroid(j.touches,"clientX","clientY");b.rootNode.dispatchEvent({type:b.GestureEvents.PINCH,clientX:i.x,clientY:i.y,userX:i.x,userY:i.y,phase:b.GestureEventPhases[h],scale:j.scale,rotation:j.rotation,preventNativeDefault:function(){j.preventNativeDefault()}})}b.ns("oui.events");b.events.addPinchSupport=function(i){var j=false,h=false;i.onTouchStart(function(){j=false;h=false});i.onTouchMove(function(k){if(!j){if(Math.abs(k.rotation)>g){if(h){f(k,"CANCEL")}j=true}else{if(h){f(k,"CHANGE")}else{if(Math.abs(k.scale-1)>e){h=true;f(k,"BEGIN")}}}}});i.onTouchEnd(function(k){if(h&&!j){if(Math.abs(k.rotation)>g){f(k,"CANCEL");j=true}else{f(k,"END");j=true}}})}}());(function(){var g=b.DirectionEnum,e=10,k=Math.PI/4;function i(n,p,m,o){var r,q=Math.atan2((o-p),(m-n));if(Math.abs(q)<k){r=g.RIGHT}else{if(Math.abs(q-Math.PI/2)<k){r=g.DOWN}else{if(Math.abs(q+Math.PI/2)<k){r=g.UP}else{r=g.LEFT}}}return r}function l(n,o){var m=n.length;while(m--){if(o===n[m].identifier){break}}return n[m]}function j(t,p,s,n){var o=p.screenX-t.screenX,m=p.screenY-t.screenY,r=n.screenX-s.screenX,q=n.screenY-s.screenY;return b.geom.dotprod(o,m,r,q)>=0}function f(p){var t=[],o=p.length,n,u,r,q,s=Number.MAX_VALUE,m;while(o--){u=p[o].target.getAncestors();if(u.length<s){s=u.length;m=o}t.push(u)}r=t.splice(m,1)[0];for(o=0;o<s;o++){q=r[o];n=t.length;while(n--){if(t[n][o]!==q){break}}if(n>=0){break}}return r[o-1]}function h(m,o){var n=f(m);if(n){n.dispatchEvent({type:b.GestureEvents.SWIPE,phase:b.GestureEventPhases[o.phase],direction:o.direction,translate:o.translate,velocity:o.velocity})}}b.ns("oui.events");b.events.SwipeSupport={_forEachChangedTouch:function(r,q,m){var p=r.changedTouches,s=r.timeStamp,o,t=p.length;for(o=0;o<t&&(m===null||!m());o++){this[q](p[o],s)}},_handleStartedTouch:function(n){var m=this._touchesStarted;if(m){if(l(m,n.identifier)===undefined){this._touchesStarted.push(n)}else{if(this._nTouchesEnded>0){this._touchesStarted=undefined}}}else{this._touchesStarted=[n];this._touchesMoved={};this._nTouchesMoved=0;this._nTouchesEnded=0;this._centroid=undefined;this._gestureInfo=undefined}},_handleMovedTouch:function(w,n){var p=this._gestureInfo,u,D,m,o,C,z,s,x,E,q,t=0,y=0,B=0,A=true,r=w.identifier,v=l(this._touchesStarted,r);if(v===undefined){if(p){p.phase="CANCEL";h(this._touchesStarted,p)}this._touchesStarted=undefined}else{if(this._touchesMoved[r]===undefined){this._nTouchesMoved++}this._touchesMoved[r]=w;o=this._touchesStarted.length;C=this._nTouchesMoved;if(C===o){if(p===undefined){D={};u=this._centroid;if(u===undefined){u=b.geom.centroid(this._touchesStarted,"screenX","screenY");this._centroid=u}z=this._touchesStarted[0];s=this._touchesMoved[z.identifier];for(x=0;x<o;x++){E=this._touchesStarted[x];q=this._touchesMoved[E.identifier];y+=b.geom.dist(E.screenX,E.screenY,u.x,u.y);t=b.geom.dist(q.screenX,q.screenY,u.x,u.y);B+=t;A=A&&j(z,s,E,q);D[E.identifier]={lastMovedTouch:q,distanceToCentroid:t}}y/=o;B/=C;m=Math.abs(y-B);if(m>e){this._startGestureTime=n;p={phase:"BEGIN",centroid:u,meanDistances:y,newMeanDistances:B,touchesInfo:D,duration:1};if(A){p.direction=i(v.screenX,v.screenY,w.screenX,w.screenY);p.translate=m;p.velocity=m/p.duration;h(this._touchesStarted,p)}else{this._touchesStarted=undefined}this._gestureInfo=p}}else{this._updateGestureEvent(w,n,false)}}}},_updateGestureEvent:function(q,p,t){var s=this._gestureInfo,o=s.touchesInfo[q.identifier],n,r,m;if(o){n=b.geom.dist(q.screenX,q.screenY,this._centroid.x,this._centroid.y);r=s.newMeanDistances+(n-o.distanceToCentroid)/this._touchesStarted.length;s.newMeanDistances=r;s.duration=(p-this._startGestureTime);m=Math.abs(s.meanDistances-r);if(t||(s.direction===i(o.lastMovedTouch.screenX,o.lastMovedTouch.screenY,q.screenX,q.screenY))){if(t){s.phase="END"}else{s.phase="CHANGE"}s.translate=m;s.velocity=m/s.duration;h(this._touchesStarted,s)}else{s.phase="CANCEL";h(this._touchesStarted,s);this._touchesStarted=undefined}o.lastMovedTouch=q;o.distanceToCentroid=n}else{s.phase="CANCEL";h(this._touchesStarted,s);this._touchesStarted=undefined}},_handleEndedTouch:function(n,m){this._nTouchesEnded++;if(this._gestureInfo){this._updateGestureEvent(n,m,true);if(this._touchesStarted.length===this._nTouchesEnded){this._touchesStarted=undefined}}else{this._touchesStarted=undefined}}};b.events.addSwipeSupport=function(n){var o=b.events.SwipeSupport,m;m=function(){return(this._touchesStarted===undefined)};n.onTouchStart(function(p){return o._forEachChangedTouch(p,"_handleStartedTouch",null)});n.onTouchMove(function(p){return o._forEachChangedTouch(p,"_handleMovedTouch",m)});n.onTouchEnd(function(p){return o._forEachChangedTouch(p,"_handleEndedTouch",m)})}}());(function(){b.ns("oui.focus");b.mixin(b.focus,{getFocusableAncestor:function(g){var f=null,e=g.parentNode;if(e){if(b.focus.isFocusableTarget(e)){f=e}else{f=b.focus.getFocusableAncestor(e)}}return f},getFocusableDescendant:function(j,i,f){var e=null,g=true,h,k;if(i===false){g=false}h=g?"firstChild":"lastChild";k=g?"nextSibling":"previousSibling";j=f?f[k]:j[h];while(j&&!e){if(j._style.display){if(j._style.focusable){e=j}else{e=b.focus.getFocusableDescendant(j,g)}}j=j[k]}return e},isFocusableTarget:function(e){return e._style.display&&e._style.focusable}})}());(function(){var f=b.UIEvents.FOCUS_IN,e=b.UIEvents.FOCUS_OUT,g={};g[f]=function(m){var n=m.target,l=n.getLayoutBounds(b.tree.focusLayer),h=n.getFocusOutlineOffset(),k=l.width+h*2,i=l.height+h*2,j;if(k>0&&i>0){j=new b.graphics.Rectangle({x:l.x-h,y:l.y-h,width:k,height:i,fill:b.NO_PAINT,stroke:b.focusManager._strokeFocusOutline||b.GRAY});b.tree.focusLayer.appendChild(j)}};g[e]=function(){b.tree.focusLayer.removeChildren()};b.declare({name:"oui.focus.FocusManager",mixins:[b.events.EventSupport],membersDef:{init:function(h){if(!b.isA(h,b.graphics.AbstractGraphicNode)){h=null}this._focusRoot=h;this._focusOwner=h;b.rootNode.addEventListener(b.ViewEvents.FOCUS_COMPONENT,this.handler("_onFocusCmp"));b.rootNode.addEventListener(b.ViewEvents.BLUR_COMPONENT,this.handler("_onBlurCmp"));b.rootNode.onKeyDown(b.focus.DefaultFocus)},getFocusOwner:function(){return this._focusOwner},setFocusOutline:function(h){if(b.isA(h,b.style.Paint)){this._strokeFocusOutline=h}},requestFocus:function(h,i){if(b.isA(h,b.graphics.AbstractGraphicNode)&&h.getFocusable()){this._moveFocus(this._getValidFocusOwner(h),i)}},releaseFocus:function(){b.events.dispatchExternalEvent({type:b.ViewEvents.RELEASE_FOCUS})},_onFocusCmp:function(){if(this._focusOwner!==this._focusRoot){var h=this._focusOwner;this._focusOwner=this._focusRoot;this._moveFocus(h,undefined,true)}},_onBlurCmp:function(){this._fire(e,this._focusOwner,null,null)},moveFocusDirection:function(i){if(!b.isA(i,Boolean)){i=true}var h=this._getValidFocusOwner(this._focusOwner);h=this._moveFocusDirection(h,i);if(h===null){h=b.focus.getFocusableDescendant(this._focusRoot,i)}this._moveFocus(h)},_getValidFocusOwner:function(h){var k=h.getAncestors(),n=k.length,l=null,j,m=false;for(j=0;j<n;j++){l=k[j];if(l===this._focusRoot){m=true}if(!l.getDisplay()){break}}if(!m){l=null}return l},_moveFocus:function(h,i,j){var k=this._focusOwner;if(h!==null&&h!==k){this._fire(e,k,h,i);this._fire(f,h,k,i,j);this._moveFocusImpl(h);this._focusOwner=h}},_moveFocusImpl:function(h){},reFocus:function(){if(this._focusOwner!==null){this._reFocusImpl(this._focusOwner)}},_reFocusImpl:function(h){},_moveFocusDirection:function(k,j){var i=null,h;if(k!==null){h=k.parentNode;i=b.focus.getFocusableDescendant(h,j,k);if(i===null){i=this._moveFocusDirection(h,j)}}return i},_fire:function(l,m,h,i,k){var j=false,n=false;if(i){j=(i.shiftKey===true);n=(i.ctrlKey===true)}m.dispatchEvent({type:l,target:m,relatedTarget:h,cancelable:true,shiftKey:j,ctrlKey:n,defaultAction:g[l],details:k})}}})}());(function(){b.ns("oui.focus");var e=b.KeyCode;b.focus.DefaultFocus={handleEvent:function(g){var f=b.focusManager;if(b.equalIgnoreCase(b.KeyEvents.KEY_DOWN,g.type)){switch(g.keyCode){case e.TAB:f.moveFocusDirection(!g.shiftKey);break;case e.LEFT_ARROW:f.moveFocusDirection(false);break;case e.RIGHT_ARROW:f.moveFocusDirection(true);break;case e.ESC:f.releaseFocus();break;case e.ENTER:case e.SPACEBAR:g.target.dispatchEvent({type:b.UIEvents.ACTIVATE,defaultAction:g.target.getDefaultActivateAction()});break;default:break}}}}}());(function(){var e=b.KeyCode;b.declare({name:"oui.focus.FocusRing",membersDef:{init:function(){},handleEvent:function(g){var f=false;if(b.equalIgnoreCase(b.KeyEvents.KEY_DOWN,g.type)){this._initFocusRoot(g);switch(g.keyCode){case e.TAB:f=this.moveFocus(!g.shiftKey,g);break;case e.LEFT_ARROW:f=this.moveFocus(false,g);break;case e.RIGHT_ARROW:f=this.moveFocus(true,g);break;case e.ESC:f=this.moveFocusLevel(true,g);break;case e.ENTER:if((g.ctrlKey!==true)&&(g.shiftKey!==true)){f=this.moveFocusLevel(false,g)}break}}if(f){g.stopPropagation()}},moveFocusLevel:function(f,h){var j=false,g=b.focusManager.getFocusOwner(),i;if(g!==null){i=f?b.focus.getFocusableAncestor(g.parentNode):b.focus.getFocusableDescendant(g);if(i!==null){j=true;b.focusManager.requestFocus(i,h)}}return j},moveFocus:function(j,i){var m=false,f=b.focusManager,h=f.getFocusOwner(),k=f._moveFocusDirection(h,j),l=this._rootFocusNode,g;if(k===null){k=b.focus.getFocusableDescendant(b.rootNode,j)}if(h!==l){g=b.focus.getFocusableAncestor(h);if(k!==null&&k.isDescendant(g)!==true){k=b.focus.getFocusableDescendant(g,j)}}else{k=null}if(k!==null){m=true;f.requestFocus(k,i)}return m},_initFocusRoot:function(f){var g=f.currentTarget;if(!b.focus.isFocusableTarget(g)){g=b.focus.getFocusableDescendant(g)}this._rootFocusNode=g}}})}());(function(){var j=b.KeyCode,i=b.DirectionEnum,e=i.UP,h=i.DOWN,f=i.LEFT,g=i.RIGHT;function k(m,l){return b.geom.dist(m.x,m.y,l.x,l.y)}b.declare({name:"oui.focus.SpatialFocus",mixins:[b.events.EventSupport],membersDef:{init:function(m,l){this._keyDownFilter=this._defaultKeyDownFilter;this._focusContainer=null;if(b.isA(m,b.graphics.AbstractGraphicNode)){m.onFocusIn(this.handler("_onFocusIn"));this._focusContainer=m}if(b.isA(l,Function)){this._keyDownFilter=l}},_defaultKeyDownFilter:function(l){return((l.ctrlKey!==true)&&(l.shiftKey!==true))},_onFocusIn:function(l){var m=l.relatedTarget;if(m){m._focusPoint=undefined}},handleEvent:function(m){var l=(m.keyCode===j.TAB);if(this._keyDownFilter(m)===true){switch(m.keyCode){case j.LEFT_ARROW:this._moveFocus(m,f);l=true;break;case j.RIGHT_ARROW:this._moveFocus(m,g);l=true;break;case j.UP_ARROW:this._moveFocus(m,e);l=true;break;case j.DOWN_ARROW:this._moveFocus(m,h);l=true;break;default:}}if(l){m.stopPropagation()}},_moveFocus:function(l,n){this._cacheFocusableNodes();var m=this._getFocusableItem(l.target,n);if(m!==null){m._focusPoint=this._newFocusPoint;b.focusManager.requestFocus(m,l)}},_cacheFocusableNodes:function(){var m=b.focus.getFocusableDescendant(this._focusContainer),l;this._focusableNodes=[];if(m!==null){this._focusableNodes.push(m);l=b.focusManager._moveFocusDirection(m,true);while(l){this._focusableNodes.push(l);l=b.focusManager._moveFocusDirection(l,true)}}},_getFocusableItem:function(y,x){var z=null,o=this._getNodeInfos(y,x),p=o.center,u,q,m,l,n,w,s,r,t,v=this._focusableNodes.length;this._updateEntryPoint(o);for(s=0;s<v;s++){r=this._focusableNodes[s];if(r!==y){u=false;switch(x){case e:t=this._getNodeInfos(r,h);if(t.center.y<p.y){u=true}break;case h:t=this._getNodeInfos(r,e);if(t.center.y>p.y){u=true}break;case f:t=this._getNodeInfos(r,g);if(t.center.x<p.x){u=true}break;case g:t=this._getNodeInfos(r,f);if(t.center.x>p.x){u=true}break;default:}if(u){q=this._getNewFocusPoint(this._entryPoint,t.nodeBorder);l=this._computeFocusDistance(o,t,q);if((m===undefined)||(l<m)){m=l;n=b.geom.dist(p.x,p.y,t.center.x,t.center.y);z=r;this._newFocusPoint=q}else{if(m===l){w=b.geom.dist(p.x,p.y,t.center.x,t.center.y);if(w<n){z=r;this._newFocusPoint=q}}}}}}return z},_getNodeInfos:function(p,s){var q=p.getLayoutBounds(this._focusContainer),n=q.x,m=q.y,t=q.width,l=q.height,o={x:n+t/2,y:m+l/2},r;switch(s){case e:r={x1:n,y1:m,x2:n+t,y2:m};break;case h:r={x1:n,y1:m+l,x2:n+t,y2:m+l};break;case f:r={x1:n,y1:m,x2:n,y2:m+l};break;case g:r={x1:n+t,y1:m,x2:n+t,y2:m+l};break;default:}return{center:o,bounds:q,node:p,nodeBorder:r}},_updateEntryPoint:function(p){var l=false,o=p.node,m=p.bounds,n;if(o._focusPoint){n=o._focusPoint;if(n.x>=m.x&&n.x<=m.x+m.width&&n.y>=m.y&&n.y<=m.y+m.height){this._entryPoint=n;l=true}}if(!l){o._focusPoint=p.center;this._entryPoint=o._focusPoint}},_getNewFocusPoint:function(m,n){var l={};if(n.x1!==n.x2){if(m.x<n.x1){l.x=n.x1}else{if(m.x>n.x2){l.x=n.x2}else{l.x=m.x}}}else{l.x=n.x1}if(n.y1!==n.y2){if(m.y<n.y1){l.y=n.y1}else{if(m.y>n.y2){l.y=n.y2}else{l.y=m.y}}}else{l.y=n.y1}return l},_computeFocusDistance:function(l,r,p){var m=this._getEuclideanDistance(p),q=l.nodeBorder,v=0,t=0,u=0,o=0,s,n;if(q.x1!==q.x2){t=Math.abs(p.y-q.y1);u=Math.abs(p.x-this._entryPoint.x)}else{v=Math.abs(p.x-q.x1);o=Math.abs(p.y-this._entryPoint.y)}s=0;n=b.geom.intersectRect(l.bounds,r.bounds);if(n){s=Math.sqrt(n.width*n.height)}return(m+v+t+u+o-s)},_getEuclideanDistance:function(l){var n=this._entryPoint,m;if((n.x===l.x)||(n.y===l.y)){m=0}else{m=b.geom.dist(n.x,n.y,l.x,l.y)}return m}}})}());(function(){b.ns("oui.utils");var e=76,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";b.utils.toBase64=function(l){var p=0,r=l.length,j="",n=0,g=0,m=0,q,h,k,o;while(n<=r){if((n%3)===0&&n!==0){m>>=8;m&=16777215;q=m;q>>=18;q&=63;j+=f.charAt(q);g++;q=m;q>>=12;q&=63;j+=f.charAt(q);g++;q=m;q>>=6;q&=63;j+=f.charAt(q);g++;q=m;q&=63;j+=f.charAt(q);g++;m=0;if(g>=e){j+="\r";j+="\n";g=0}if(r-n<3){break}}q=l[p++];m|=(256+q)%256;m<<=8;n++}h=(r-n)%3;if(h!==0){m=0;for(k=0;k<3;k++){if(k<h){q=l[p++];m|=(256+q)%256;m<<=8;n++}else{m|=0;m<<=8}}m>>=8;m&=16777215;q=m;if(h>=1){q>>=18;q&=63;j+=f.charAt(q);q=m;q>>=12;q&=63;j+=f.charAt(q)}if(h>=2){q=m;q>>=6;q&=63;j+=f.charAt(q)}if(h>=3){q=m;q&=63;j+=f.charAt(q)}for(o=3;o>h;o--){j+="="}}if(j.length===0){c.error("ERR__BASE64")}return j}}());(function(){var e;function g(q,p,h,r,n){var s,m,j,o,l,k;if(q!==undefined){m=e[q.type];if(m!==undefined){s=m.call(null,q,h,r,n);j=q.name;if(h){if(r===false){if(q.shortcutName!==undefined){o=q.shortcutName}}else{if(j!==undefined){o=j}}if(o!==undefined&&n!==undefined){o=n+o}if(o!==undefined){h[o]=s}}if(p){if(j!==undefined&&p!==h){p[j]=s}if(s.constructor===Array){k=s.length;for(l=0;l<k;l++){p.appendChild(s[l])}}else{p.appendChild(s)}}}}return s}function f(i,h){var k,j;if(b.isA(h,Function)){k=h}else{j=i;k=function(l){return new j(l,l.name)}}return k}b._CPGL_JSON_FACTORY=e={array:function(k){var h=[],j,m=k.length,l=k.of;if(b.isA(m,Number)&&l!==undefined){for(j=0;j<m;j++){h[j]=g(l)}}return h}};b.load=function(l,m,q,j,o){var h=null,k,p;if(l){if(l.constructor===Array){h=m||new b.graphics.Group();for(k=0,p=l.length;k<p;k++){g(l[k],h,q,j,o)}}else{if(l.constructor===Object){if(m){g(l,m,q,j,o);h=m}else{h=g(l,null,q,j,o)}}}}return h};b.addJSONLoaderSupport=function(h,j){var i="";if(!b.inheritsFrom(h,b.scene.AbstractNode)){c.error("ERR__JSONLOAD__INV_CLASS")}if(b.isA(j.type,String)){i=j.type}if(i.length>0){if(!e[i]){e[i]=f(h,j.factory)}else{c.warn("WARN__JSONLOAD__DUP_TYPE")}}else{c.warn("WARN__JSONLOAD__EMPTY_STR")}}}());(function(){var g=new RegExp("^(https?:\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})\\/\\S+$",""),i=b.config.hasOwnProperty("base")?b.config.base+"/":"",j=0;function f(k){if(!g.test(k)&&k.indexOf("/")!==0&&k.indexOf("data")!==0){k=i+k}return k}function h(k){if(k.indexOf(i)===0){k=k.substring(i.length)}return k}function e(){b.tree.layout()}b.declare({name:"oui.utils.ImageLoader",mixins:[b.events.EventSupport],eventsDef:{COMPLETE:"complete",ERROR:"error"},membersDef:{init:function(){},load:function(k){var l=this;j++;if(b.tree.isPlatformAvailable()){this._loadImpl(f(k))}else{b.tree.addEventListener(b.tree.events.PLATFORM_AVAILABLE,function(){l._loadImpl(k)})}},_loadImpl:function(){},_dispatchCompleteEvent:function(l,n,m,k,o){this.dispatchEvent({type:this.events.COMPLETE,url:h(l),data:n,width:m,height:k,info:o,defaultAction:e});j--},_dispatchErrorEvent:function(k,l){this.dispatchEvent({type:this.events.ERROR,url:h(k),message:l});j--}}});b.hasImagesLoading=function(){return(j!==0)}}());(function(){b.mixin(b.utils.ImageLoader,{_loadImpl:function(e){var f=new Image();f.onload=this.handler("cvOnComplete");f.onerror=this.handler("cvOnError");f.onabort=this.handler("cvOnAbort");f.src=e},cvOnComplete:function(f){var e=f.target;this._dispatchCompleteEvent(e.src,e,e.width,e.height)},cvOnError:function(e){this._dispatchErrorEvent(e.target.src)},cvOnAbort:function(e){this._dispatchErrorEvent(e.target.src)}})}());(function(){function f(g,h){if(b.isA(g,Function)){g.call(null,h)}else{if(g&&b.isA(g.resourceUpdate,Function)){g.resourceUpdate(h)}}}function e(h){var g=h.observers.pop();while(g){f(g,h);g=h.observers.pop()}b.tree.layout()}b.declare({name:"oui.utils.ResourcesManager",membersDef:{init:function(){var g,h=b.config.embeddedResourcesMap;this._resources={};if(h){for(g in h){if(h.hasOwnProperty(g)){this._initEmbedImpl(g,h[g])}}}},requestResource:function(h,g){var i;h=this._checkURL(h);i=this._resources[h];if(!i){this._loadResource(h,h,g)}else{if(i.data===null){if(g){i.observers.push(g)}}else{f(g,i)}}},hasResource:function(h){var g=false;if(h.indexOf("@cache;")===0){g=true}else{g=(this._resources[h]!==undefined)}return g},removeObserver:function(h,g){var k,l,j;h=this._checkURL(h);k=this._resources[h];if(k){l=k.observers;j=l.length;while(j--){if(l[j]===g){l.splice(j,1);break}}}},_checkURL:function(g){if(g.indexOf("@cache;")===0){g=g.substr(7)}return g},_initEmbedImpl:function(){},_loadResource:function(i,l,h){var j=this,k,g;k={url:i,data:null,width:0,height:0,observers:[h]};this._resources[i]=k;g=new b.utils.ImageLoader();g.onComplete(function(m){j._onComplete(m,k)});g.onError(function(){j._onError(k)});g.load(l)},_onComplete:function(g,h){h.width=g.width;h.height=g.height;this._onCompleteImpl(g,h);e(h)},_onCompleteImpl:function(g,h){h.data=g.data},_onError:function(g){this._resources[g.url]=undefined;c.warn("WARN__RES_MGR__LOAD_FAIL",g.url)},_getBase64Data:function(){return undefined}}})}());(function(){b.mixin(b.utils.ResourcesManager,{_initEmbedImpl:function(e,f){this._loadResource(e,f.data);f.data=null},_getBase64Data:function(f){var e,h=b.config.embeddedResourcesMap,g;f=this._checkURL(f);if(h!==undefined&&h[f]!==undefined){g=this._resources[f];if(g.data){e=g.data.src}}return e}})}());(function(){var e="Obj_",f=0;b.declare({name:"oui.scene.AbstractNode",isAbstract:true,mixins:[b.events.EventSupport,b.lang.AspectSupport],membersDef:{init:function(g){this.dirtyMarkers={};this._id=e+f++;this.name="";this.setName(g);this._createNodeImpl();this._nativeMode=false},load:function(h,g){return b.load(h,g||this)},setName:function(g){if(typeof g==="string"){this.name=g;this.notifyNative(b.TAGS.NAME)}},getName:function(){return this.name},getFullName:function(){var g=this.name;if(this.parentNode){g=this.parentNode.getFullName()+"."+g}return g},getElementById:function(i){var g=null,h;if(this._id===i){g=this}else{h=this.firstChild;while(h&&!g){g=h.getElementById(i);h=h.nextSibling}}return g},getElementsByName:function(h,g){var i;g=g||[];i=this.firstChild;while(i){if(i.name===h){g.push(i)}i.getElementsByName(h,g);i=i.nextSibling}return g},getFirstElementByName:function(h){var g,i=this.firstChild;while(i&&!g){if(i.name===h){g=i}else{g=i.getFirstElementByName(h)}i=i.nextSibling}return g},getId:function(){return this._id},_isValidChild:function(g){return b.isA(g,b.scene.AbstractNode)},_onInsertChild:function(i,g,h){if(!g){this._appendChildImpl(i)}else{this._insertBeforeImpl(i,g)}if(h!==true){i._onParentChanged()}this._onChildrenChanged()},_onRemoveChild:function(i,h,g){i._onParentChanged();if(h===false){this._removeChildImpl(i);this._onChildrenChanged()}else{if(g===true){this._removeChildrenImpl();this._onChildrenChanged()}}},isDescendant:function(h){var g=false;if(this.parentNode===h){g=true}else{if(this.parentNode){g=this.parentNode.isDescendant(h)}}return g},_createNodeImpl:function(){},_appendChildImpl:function(){},_insertBeforeImpl:function(){},_removeChildImpl:function(){},_removeChildrenImpl:function(){},getAncestors:function(){var h=this,g=[];while(h){g.unshift(h);h=h.parentNode}return g},bringToFront:function(){var g=this.parentNode;if(g&&g.lastChild!==this){g.insertBefore(this,null)}},sendToBack:function(){var g=this.parentNode;if(g&&g.firstChild!==this){g.insertBefore(this,g.firstChild)}},bringForward:function(){var g=this.parentNode,h=this.nextSibling;if(g&&h){g.insertBefore(this,h.nextSibling)}},sendBackward:function(){var g=this.parentNode,h=this.previousSibling;if(g&&h){g.insertBefore(this,h)}},notifyNative:function(g){if(this._nativeMode){this.notifyNativeImpl(g)}else{this.dirtyMarkers[g]=true}},notifyNativeImpl:function(g,h){},_preParentChangedImpl:function(){},_onParentChanged:function(){var g=false;this._preParentChangedImpl();if(this.parentNode){g=this.parentNode._nativeMode}this._setNativeMode(g)},_onChildrenChanged:function(){},_setNativeMode:function(g,k){var j,i,h;if(this._nativeMode!==g){this._nativeMode=g;j=this.firstChild;while(j){j._setNativeMode(g,true);j=j.nextSibling}if(g){i=this.dirtyMarkers;for(h in i){if(i[h]){this.notifyNativeImpl(h,k)}}this.dirtyMarkers={}}}},notifyChildren:function(g){var h;this.notifyNative(g);h=this.firstChild;while(h){h.notifyChildren(g);h=h.nextSibling}}}});b.lang.LinkedListSupport.addLinkedList(b.scene.AbstractNode,b.scene.AbstractNode,"nextSibling","previousSibling","parentNode","firstChild","lastChild","appendChild","removeChild","removeChildren","insertBefore","replaceChild","hasChildNodes","_isValidChild","_onInsertChild","_onRemoveChild","childrenCount","getChildAt","getChildIndex","setChildIndex")}());(function(){b.mixin(b.scene.AbstractNode,{cvPaint:function(e){}})}());(function(){function f(r,s,l,n,h,k,i,j,q,g,p,m,o){return{type:r,canBubble:s,cancelable:l,detail:n,screenX:h.x,screenY:h.y,clientX:k,clientY:i,ctrlKey:j,shiftKey:q,altKey:g,metaKey:p,button:m,relatedTarget:o,preventNativeDefault:b.NO_OP,stopNativePropagation:b.NO_OP}}function e(s,u,l,o,h,k,i,j,r,g,q,n,p,t,m,v){return{type:s,canBubble:u,cancelable:l,detail:o,screenX:h.x,screenY:h.y,clientX:k,clientY:i,ctrlKey:j,shiftKey:r,altKey:g,metaKey:q,touches:n,targetTouches:p,changedTouches:t,scale:m,rotation:v,preventNativeDefault:b.NO_OP,stopNativePropagation:b.NO_OP}}b.declare({name:"oui.scene.Tree",mixins:[b.events.EventSupport,b.lang.AspectSupport],membersDef:{events:{PLATFORM_AVAILABLE:"platformAvailable"},init:function(){this.userLayer=this._createLayer("userLayer");this.focusLayer=this._createLayer("focusLayer");this.tooltipLayer=this._createLayer("tooltipLayer");this.layers=[this.userLayer,this.focusLayer,this.tooltipLayer];this._isReady=false;this.addEventListener(this.events.PLATFORM_AVAILABLE,this.handler("_onReady"))},destroy:function(){b.timer.stop();b.events._userEventsSupport.setProperties({fromPlatform:{keyEvents:false,mouseEvents:false,wheelEvents:false,touchEvents:false,gestureEvents:false}});this._destroyImpl()},layout:function(){var g,j,h=this.layers;for(g=0,j=h.length;g<j;g++){h[g].layout()}},setLayoutDir:function(g){var h,k,j=this.layers;if((g===b.RTL||g===b.LTR)&&g!==b.layoutDir){b.layoutDir=g;b.filters._onLayoutDir(g);for(h=0,k=j.length;h<k;h++){j[h].notifyChildren(b.TAGS.LAYOUT_DIR)}if(typeof this._setLayoutDirImpl==="function"){this._setLayoutDirImpl()}}},getNodeAt:function(g,m){var j=null,h,l=this.layers,k=l.length;for(h=k-1;h>=0&&!j;h--){j=this._getChildAtImpl(l[h],g,m)}return j},getElementById:function(l){var h=null,g,k=this.layers,j=k.length;for(g=j-1;g>=0&&!h;g--){h=k[g].getElementById(l)}return h},isPlatformAvailable:function(){return this._isReady},getCSSValues:function(h,i){var g=null;if(typeof b.config.readCSSValues==="function"){g=b.config.readCSSValues(h,i)}return g},_createLayer:function(g){var i=new b.graphics.Group(undefined,g),h=b.events;h.addDragSupport(i);h.addPressNTapSupport(i);h.addPinchSupport(i);h.addSwipeSupport(i);b.addGestureSupport(i,f,e);return i},_initShadowTree:function(g){g._createNodeImpl();var h=g.firstChild;while(h!==null){this._initShadowTree(h);g._appendChildImpl(h);h=h.nextSibling}g.invalidateLayout()},_onReady:function(){var j,l,h,k=this.layers,g=(b.environment===b.EnvironmentEnum.MOBILE);this._enableTreeOpsImpl();b.events._userEventsSupport.setProperties({fromPlatform:{keyEvents:true,mouseEvents:g?false:true,wheelEvents:true,touchEvents:true,gestureEvents:true}});for(j=0,l=k.length;j<l;j++){h=k[j];this._initShadowTree(h);this._attachLayerImpl(h);h._setNativeMode(true)}this.layout();this._isReady=true},_updateViewport:function(i,h){var g=b.viewportWidth,j=b.viewportHeight;if(g!==i||j!==h){b.viewportWidth=i;b.viewportHeight=h;b.viewportBounds.width=i;b.viewportBounds.height=h;this.userLayer.dispatchEvent({type:b.ViewEvents.VIEWPORT_RESIZE,oldViewportWidth:g,oldViewportHeight:j,newViewportWidth:i,newViewportHeight:h});this.layout()}},_updateDeviceOrientation:function(g){if(b.deviceOrientation!==g){b.deviceOrientation=g;this.userLayer.dispatchEvent({type:b.ViewEvents.DEVICE_ORIENTATION,orientation:b.deviceOrientation})}},_setContainerImpl:function(){},_destroyImpl:function(){},_getChildAtImpl:function(h,g,i){return h.hitTest(g,i)},_enableTreeOpsImpl:function(){},_attachLayerImpl:function(g){}}})}());(function(){var e=b.DeviceOrientationEnum,f={};function g(h){var i=false;while(h){if(h===document){i=true;break}h=h.parentNode}return i}b.mixin(b.scene.Tree,{_setContainerImpl:function(m){var h,p,i,l,n,k,o,q,j;this.document=m.ownerDocument;this.domElement=m;l=this.document.defaultView;h=this.cvCreateCanvasElt(0,0);if(!h.getContext){i=this.document.createElement("div");i.innerHTML="Your web browser does not support Canvas";m.appendChild(i);c.error("ERR__CNV__NO_SUPPORT")}h.setAttribute("style",["-webkit-user-select: none;","-webkit-touch-callout: none;","-webkit-tap-highlight-color: transparent;"].join(""));h.tabIndex=0;h.innerHTML=b.config.altText||"";p=h.getContext("2d");p.globalCompositeOperation="copy";m.appendChild(h);q=l.devicePixelRatio||1;j=p.webkitBackingStorePixelRatio||p.mozBackingStorePixelRatio||p.msBackingStorePixelRatio||p.oBackingStorePixelRatio||p.backingStorePixelRatio||1;this.cvPixelRatio=b.config.hiDPI!==false?q/j:1;this.cvBuffers=[];this.cvDirtyList={};this.canvas=h;this.c2d=p;this.offscreen=this.cvCreateCanvasElt(0,0);this.offscreen.style.display="none";this.offscreen2d=this.offscreen.getContext("2d");n=this.document.createElement("div");n.setAttribute("style","margin: 0; padding: 0;");k=this.document.createElement("span");n.appendChild(k);o=this.document.createElement("div");o.setAttribute("style","display: inline-block; vertical-align: baseline; width: 1px; height: 0px; margin: 0; padding: 0;");n.appendChild(o);this.cvTextMeasurer={div:n,span:k,ref:o};b.timer.addEventListener(b.timer.TIMER_EVENT,this.handler("_timerCallback"));this._orientationHandler=this.handler("cvOnDeviceOrientationChanged");l.addEventListener("orientationchange",this._orientationHandler,false);l.addEventListener("resize",this._orientationHandler,false);this.cvResize();this.cvOnDeviceOrientationChanged();this.dispatchEvent({type:this.events.PLATFORM_AVAILABLE})},_destroyImpl:function(){var i,h=this.document.defaultView;this.removeAspect("layout",this.cvRender);h.removeEventListener("orientationchange",this._orientationHandler,false);h.removeEventListener("resize",this._orientationHandler,false);i=this.cvBuffers.pop();while(i){i.width=0;i.height=0;i=this.cvBuffers.pop()}this.canvas.width=0;this.canvas.height=0;this.offscreen.width=0;this.offscreen.height=0;this.canvas=null;this.c2d=null;this.offscreen=null;this.offscreen2d=null;this.document=null},_enableTreeOpsImpl:function(){var j=function(k){b.tree.cvMarkAsDirty(k)},h=function(){b.tree.cvMarkAsDirty(this)},i=b.scene.AbstractNode.prototype;i._appendChildImpl=j;i._insertBeforeImpl=j;i._removeChildImpl=j;i._removeChildrenImpl=h;i=b.graphics.Text.prototype;i._getBBoxImpl=i.cvGetBBox;i=b.graphics.TextBlock.prototype;i._getBBoxImpl=i.cvGetBBox},_setLayoutDirImpl:function(){var h=b.layoutDir.toLowerCase();this.canvas.setAttribute("dir",h);this.offscreen.setAttribute("dir",h);this.cvMarkAsDirty()},cvCreateCanvasElt:function(i,h){var j=this.document.createElement("canvas");j.width=i;j.height=h;return j},cvRender:function(){var s,o,p,k,r,u,h,q,l,j,m;if(this.cvFullyDirty){r=b.viewportBounds}else{j=this.cvDirtyList;m=b.geom.unionRect;for(q in j){if(j.hasOwnProperty(q)){l=j[q];if(l._nativeMode){u=l._safeGetGlobalTxf();h=l._getBoundsImpl(u,b._BoundsType.RENDER);h=m(h,l.cvLastDrawBounds)}else{h=l.cvLastDrawBounds;l.cvLastDrawBounds=undefined}r=m(r,h)}}if(r){r.x=Math.floor(r.x)-1;r.y=Math.floor(r.y)-1;r.width=Math.ceil(r.width)+2;r.height=Math.ceil(r.height)+2}}if(r){this.domElement.appendChild(this.offscreen);s=this.offscreen2d;s.save();s.scale(this.cvPixelRatio,this.cvPixelRatio);s.clearRect(r.x,r.y,r.width,r.height);s.beginPath();s.rect(r.x,r.y,r.width,r.height);s.clip();o=this.layers;for(p=0,k=o.length;p<k;p++){o[p].cvPaint(s,r)}s.restore();this.c2d.drawImage(this.offscreen,0,0);this.cvDirtyList={};this.cvFullyDirty=false;this.domElement.removeChild(this.offscreen)}},cvMarkAsDirty:function(h){if(!this.cvFullyDirty){if(h){this.cvDirtyList[h._id]=h}else{this.cvFullyDirty=true}}},cvCreateBuffer:function(i,h){var j;if(this.cvBuffers.length===0){j=this.cvCreateCanvasElt(i,h);j.style.display="none"}else{j=this.cvBuffers.pop();j.width=i;j.height=h}this.domElement.appendChild(j);j.setAttribute("dir",b.layoutDir.toLowerCase());return j},cvDisposeBuffer:function(h){this.domElement.removeChild(h);this.cvBuffers.push(h)},_timerCallback:function(){if(!this.canvas.parentNode){this.destroy()}else{this.cvResize()}},cvResize:function(){var i=this.canvas.parentNode.getBoundingClientRect(),l=Math.floor(i.width),h=Math.floor(i.height),k=this.cvPixelRatio*l,m=this.cvPixelRatio*h,j=this.canvas;if(k!==j.width||m!==j.height){if(j.width===0||j.height===0){if(k!==0&&m!==0){this.addAspect("layout",this.cvRender)}}else{if(k===0||m===0){if(!g(j)){b.timer.stop()}this.removeAspect("layout",this.cvRender)}}j.width=k;j.height=m;j.style.width=l+"px";j.style.height=h+"px";this.c2d.globalCompositeOperation="copy";this.offscreen.width=k;this.offscreen.height=m;this.cvMarkAsDirty();this._updateViewport(l,h)}},cvOnDeviceOrientationChanged:function(){var h,i,j=this.document.defaultView;if(j.orientation!==undefined){h=Math.abs(j.orientation)===90?e.LANDSCAPE:e.PORTRAIT}else{i=j.screen;h=i.width>i.height?e.LANDSCAPE:e.PORTRAIT}this._updateDeviceOrientation(h)},cvGetRootClientCoords:function(){var h=this.canvas.getBoundingClientRect();return{x:h.left,y:h.top}},cvTextMetrics:function(m,l){var j=this.cvTextMeasurer,u=this.document,n,i=j.div,v=j.span,k=j.ref,h,r,q=0,s=0,p=0,w=0,t=this.c2d;t.font=l;if(m){q=t.measureText(m).width;if(!f[l]){n=u.body;try{if(b.equalIgnoreCase("body",u.defaultView.top.document.body.nodeName)){n=u.defaultView.top.document.body}}catch(o){c.warn(o)}n.appendChild(i);v.style.font=l;v.innerHTML=m;h=v.getBoundingClientRect();p=k.getBoundingClientRect().top-h.top;s=h.bottom-h.top;w=s-p;n.removeChild(i);f[l]={ascent:p,descent:w}}else{r=f[l];p=r.ascent;w=r.descent;s=p+w}}return{ascent:p,descent:w,width:q,height:s}}})}());(function(){b.declare({name:"oui.timing.Timer",mixins:[b.events.EventSupport],membersDef:{TIMER_EVENT:"TIMER_EVENT",DEFAULT_FRAME_RATE:25,init:function(e){if(b.isFinitePositiveNumber(e,true)){this.frameRate=e}else{this.frameRate=this.DEFAULT_FRAME_RATE}},start:function(){var f=this;function e(){f.dispatchEvent({type:f.TIMER_EVENT});b.tree.layout()}if(this.startImpl){this.startImpl(e)}else{if(setInterval){this.currentIntervalID=setInterval(e,1000/this.frameRate)}else{c.error("ERR__TIMER__START")}}},stop:function(){if(this.stopImpl){this.stopImpl()}else{if(this.currentIntervalID&&clearInterval){clearInterval(this.currentIntervalID);this.currentIntervalID=undefined}else{c.error("ERR__TIMER__STOP")}}}}})}());(function(){var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,g=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame,f=navigator.userAgent,e=h&&!(f.match(/(iPod|iPhone|iPad)/)&&f.match(/AppleWebKit/));if(e){b.mixin(b.timing.Timer,{startImpl:function(l){var i,j,k=0;i=function(){k=h(i,b.tree.canvas);l()};if(g){j=function(){g(k);k=0}}else{j=function(){i=b.NO_OP}}this._cancelAnimate=j;i()},stopImpl:function(){if(this._cancelAnimate){this._cancelAnimate();this._cancelAnimate=undefined}}})}else{c.warn("WARN__CNV__REQ_ANIM_FRAME")}}());(function(){var e=b.defs,f="trigger",j=1000,h="begin",i="end",g={source:{type:Object,constraint:b.supportsEvents,defaultValue:null},type:e.String(""),offset:e.PositiveNumber(0)};b.declare({name:"oui.timing.TimeInterval",mixins:[b.events.EventSupport,b.lang.PropertiesSupport],membersDef:{init:function(k){this._plugged=true;this._active=false;this._beginSyncValues=[];this._endSyncValues=[];this._eventValues=[];this._initProperties(k);this._timerHandler=this.handler("_onTimer")},_onTimer:function(n){var m=n.timeStamp,k=this._beginTime,l=this._endTime;if(m>=k&&l>=k){if(!this._active){this.dispatchEvent({type:this.events.BEGIN,bubbles:false,syncTime:k});this._curBegin=k;this._curEnd=k+this._simpleDur;this._active=true;this._start(k)}this._repeat(m);if(m>=l){this._stop(l);this._active=false;b.timer.removeEventListener(b.timer.TIMER_EVENT,this._timerHandler);this.dispatchEvent({type:this.events.END,bubbles:false,syncTime:l,scheduled:(l>=this._curEnd)})}else{this._play(m)}}},_start:function(k){},_play:function(k){},_stop:function(k){},beginAt:function(k){this._beginSyncAt(b.currentTimeMillis(),k)},endAt:function(k){this._endSyncAt(b.currentTimeMillis(),k)},_beginSyncAt:function(m,n){var l=this._properties,k;if(isFinite(n)&&n>0){m+=n*j}this._simpleDur=l.dur*j;k=this._simpleDur;if(l.repeatDur!==0&&l.repeatCount!==0){k=Math.min(l.repeatDur*j,l.repeatCount*this._simpleDur)}else{if(l.repeatDur!==0){k=l.repeatDur*j}else{if(l.repeatCount!==0){k=l.repeatCount*this._simpleDur}}}this._endTime=m+k;this._beginTime=m;this._sync(h,this._beginTime);this._sync(i,this._endTime);b.timer.addEventListener(b.timer.TIMER_EVENT,this._timerHandler)},_endSyncAt:function(k,l){if(isFinite(l)&&l>0){k+=l*j}if(k<this._endTime){this._endTime=k;this._sync(i,this._endTime)}},_sync:function(l,p){var o=(l===h)?this._beginSyncValues:this._endSyncValues,k,n=o.length,m;for(k=0;k<n;k++){m=o[k];m.target[m.funcName](p,m.offset)}},_repeat:function(k){var m=this._beginTime,p=this._endTime,s=this._simpleDur,q=this._curBegin,r=this._curEnd,l,n,o;if(k>=r&&r<p){l=Math.floor((q-m)/s);o=Math.floor((k-q)/s);for(n=1;n<=o&&r<p;n++){q+=s;r+=s;this.dispatchEvent({type:this.events.REPEAT,bubbles:false,syncTime:q,detail:l+n})}this._curBegin=q;this._curEnd=r}},onPropChanged:function(k){if(k===f){this.plug()}},addBeginEvent:function(k){this._addEvent(k,"beginEvents",h,[])},addEndEvent:function(k){this._addEvent(k,"endEvents",i,[true])},_addEvent:function(l,p,o,k){var n=this._properties,m;if(n[p].length===0){n[p]=[]}m=n[p];if(b.isObjectValid(l,g,true)){m.push(l);if(this._plugged){this._plug(l,o,k)}}},plug:function(){var l,k,m;this.unplug();l=this._properties.beginEvents;for(k=0,m=l.length;k<m;k++){this._plug(l[k],h)}l=this._properties.endEvents;for(k=0,m=l.length;k<m;k++){this._plug(l[k],i)}this._plugged=true},_plug:function(o,l){var k=this,n="_"+l+"SyncAt",p=o.offset,m;if(o.type===h||o.type===i){m={target:k,funcName:n,offset:p};o.source._addSyncValue(o.type,m)}else{m=function(q){k[n](q.timeStamp,p)};o.source.addEventListener(o.type,m)}this._eventValues.push({desc:o,data:m})},unplug:function(){var k=this._eventValues,l,p,o,m;for(l=0,p=k.length;l<p;l++){o=k[l].desc;m=k[l].data;if(o.type===h||o.type===i){o.source._removeSyncValue(o.type,m)}else{o.source.removeEventListener(o.type,m)}}k.length=0;this._plugged=false},_addSyncValue:function(k,m){var l=(k===h)?this._beginSyncValues:this._endSyncValues;l.push(m)},_removeSyncValue:function(l,o){var n=(l===h)?this._beginSyncValues:this._endSyncValues,k,m=n.length;for(k=0;k<m;k++){if(n[k]===o){n.splice(k,1)}}}},eventsDef:[b.SyncEvents],propertiesDef:{dur:e.PositiveNumber(0),repeatDur:e.PositiveNumber(0),repeatCount:e.PositiveNumber(0),beginEvents:e.ArrayOfProperties(g,0,Number.MAX_VALUE,[],f),endEvents:e.ArrayOfProperties(g,0,Number.MAX_VALUE,[],f)}});b.timing.eventTriggerDefinition=g}());(function(){b.ns("oui.anim");function e(f){return{easeIn:function(g){return g===0?0:f(g)},easeOut:function(g){return 1-f(1-g)},easeInOut:function(g){if(g<0.5){g=f(2*g)/2}else{g=1-f(2*(1-g))/2}return g}}}b.anim.easing={linear:e(function(f){return f}),quadratic:e(function(f){return f*f}),cubic:e(function(f){return f*f*f}),quartic:e(function(f){return f*f*f*f}),quintic:e(function(f){return f*f*f*f*f}),exponential:e(function(f){return Math.pow(2,10*(f-1))}),circular:e(function(f){return 1-Math.sqrt(1-f*f)}),sine:e(function(f){return 1-Math.cos(f*Math.PI/2)}),back:e(function(g,f){f=f||1.70158;return g*g*((f+1)*g-f)}),bounce:e(function(f){f=1-f;if(f<1/2.75){f=2.75*f;f=f*f}else{if(f<2/2.75){f=2.75*f-1.5;f=f*f+0.75}else{if(f<2.5/2.75){f=2.75*f-2.25;f=f*f+0.9375}else{f=2.75*f-2.625;f=f*f+0.984375}}}return 1-f})}}());(function(){b.ns("oui.anim");b.mixin(b.anim,{interpolateDiscrete:function(h,f,g){var e;if(g<=0.5){e=h}else{e=f}return e},interpolateNumber:function(g,e,f){return g+(e-g)*f},interpolateColor:function(f,e,g){return new b.style.Color(f.red()+(e.red()-f.red())*g,f.green()+(e.green()-f.green())*g,f.blue()+(e.blue()-f.blue())*g,f.alpha()+(e.alpha()-f.alpha())*g)}})}());(function(){var e=b.defs,f=b.FillEnum;b.declare({name:"oui.anim.AbstractAnimation",isAbstract:true,extend:b.timing.TimeInterval,membersDef:{_stop:function(h){var g=this._properties.fill;if(g===f.REMOVE||(g===f._LEGACY&&h<this._curEnd)){this._play(this._curBegin)}else{this._play(h)}},_progress:function(h,i,l){var j,m=b.anim.easing[this._properties.easeMode],g=this._properties.easeIn,k=this._properties.easeOut;if(l<h){j=0}else{if(l>i||h===i){j=1}else{j=(l-h)/(i-h);if(m){if(g&&!k){j=m.easeIn(j)}else{if(!g&&k){j=m.easeOut(j)}else{if(g&&k){j=m.easeInOut(j)}}}}}}return j}},propertiesDef:{easeMode:e.String("quadratic"),easeIn:e.Boolean(false),easeOut:e.Boolean(false),fill:e.Enum(f,f.FREEZE)}})}());(function(){var j=b.anim.AbstractAnimation.prototype,f=b.defs,g=b.BASE_VALUE,i=b.anim.interpolateDiscrete,l=b.anim.interpolateNumber,h=b.anim.interpolateColor,m="ANIM_TAG",e,k;e=function(p,n,o){return b.anim.interpolateDiscrete(p,n,o)};k={interpolator:f.Function(3,e),beginValue:f.ObjectOfType(Object,g,true,false),endValue:f.ObjectOfType(Object,g,true,false)};b.declare({name:"oui.anim.AnimateStyle",extend:b.anim.AbstractAnimation,membersDef:{onPropChanged:function(n){var o=this._properties.targetNode;if(n===m){if(o){this._checkInterpolators(this._properties.animValues,o.StyleDefinition.prototype)}}else{j.onPropChanged.call(this,n)}},_checkInterpolators:function(r,p){var o,q,n,s;if(p===undefined){p={}}for(o in r){if(r.hasOwnProperty(o)){q=r[o];n=p[o];if(q.interpolator===undefined){this._checkInterpolators(q,n)}else{if(q.interpolator!==e){q._interpolate=q.interpolator}else{if(n!==undefined){s=n.type;if(s===Boolean){q._interpolate=i}else{if(s===Number){q._interpolate=l}else{if(s===b.style.Color||(s===b.style.Paint&&b.isA(q.beginValue,b.style.Color)&&b.isA(q.endValue,b.style.Color))){q._interpolate=h}else{q._interpolate=e}}}}else{if(b.isA(q.beginValue,Boolean)&&b.isA(q.endValue,Boolean)){q._interpolate=i}else{if(b.isA(q.beginValue,Number)&&b.isA(q.endValue,Number)){q._interpolate=l}else{if(b.isA(q.beginValue,b.style.Color)&&b.isA(q.endValue,b.style.Color)){q._interpolate=h}else{q._interpolate=e}}}}}}}}},_start:function(){var n=this._properties;this._resolveBaseValues(n.animValues,n.targetNode._style)},_play:function(o){var n=this._properties;n.targetNode.applyStyle(this._buildStyleObjectFor(n.animValues,this._progress(this._curBegin,this._curEnd,o)))},_resolveBaseValues:function(r,p){var n,q,o;for(n in r){q=r[n];o=p[n];if(q.hasOwnProperty("_interpolate")){if(q.beginValue===g){q._beginVal=o}else{q._beginVal=q.beginValue}if(q.endValue===g){q._endVal=o}else{q._endVal=q.endValue}}else{this._resolveBaseValues(q,o)}}},_buildStyleObjectFor:function(r,o){var n,q,p={};for(n in r){q=r[n];if(q.hasOwnProperty("_interpolate")){p[n]=q._interpolate(q._beginVal,q._endVal,o)}else{p[n]=this._buildStyleObjectFor(q,o)}}return p}},propertiesDef:{targetNode:{type:Object,constraint:function(n){return(n===undefined)||(b.isA(n.applyStyle,Function)&&b.isA(n.StyleDefinition,Function))},defaultValue:undefined,tag:m},animValues:f.MapOfProperties(k,{},false,true,true,m)}})}());(function(){var f=b.anim.AbstractAnimation.prototype,h="t",e="s",g="r";b.declare({name:"oui.anim.AnimateTransform",extend:b.anim.AbstractAnimation,membersDef:{init:function(j,i){f.init.call(this,j,i);this._interpolatedValue=new b.geom.Matrix();this._transforms=[]},translate:function(j,l,i,k){if(isFinite(j)&&isFinite(l)&&isFinite(i)&&isFinite(k)){this._transforms.push({type:h,x0:j,x1:i,y0:l,y1:k})}},rotate:function(l,k,j,i){if(isFinite(l)&&isFinite(k)){this._transforms.push({type:g,a0:l/180*Math.PI,a1:k/180*Math.PI,cx:j||0,cy:i||0})}},scale:function(j,l,i,k){if(isFinite(j)&&isFinite(l)&&isFinite(i)&&isFinite(k)){this._transforms.push({type:e,x0:j,x1:i,y0:l,y1:k})}},resetTransforms:function(){this._transforms.length=0},_play:function(p){var j=this._progress(this._curBegin,this._curEnd,p),n=this._transforms,l,o=n.length,k,m=this._interpolatedValue;m.init();for(l=0;l<o;l++){k=n[l];if(k.type===h){m._safeTranslate(k.x0+j*(k.x1-k.x0),k.y0+j*(k.y1-k.y0))}else{if(k.type===g){m._safeRotate(k.a0+j*(k.a1-k.a0),k.cx,k.cy)}else{if(k.type===e){m._safeScale(k.x0+j*(k.x1-k.x0),k.y0+j*(k.y1-k.y0))}}}}this._properties.targetNode.setTransformMatrix(m)}},propertiesDef:{targetNode:b.defs.ObjectOfType(b.scene.AbstractNode,undefined,false,true)}})}());(function(){b.declare({name:"oui.anim.AnimateCallback",extend:b.anim.AbstractAnimation,membersDef:{_play:function(e){this._properties.callback.call(this,this._progress(this._curBegin,this._curEnd,e))}},propertiesDef:{callback:{type:Function,defaultValue:b.NO_OP}}})}());(function(){b.ns("oui.anim");b.anim.EffectsSupport={_effectOn:function(h,g,k,l,f,j){var i,e=h+"Effect";if(this[e]===undefined){i={targetNode:this,dur:j,animValues:{}};i.animValues[k]={beginValue:l,endValue:f};this[e]=new b.anim.AnimateStyle(i)}this[e].addBeginEvent(g)},showOn:function(e){this._effectOn("show",e,"display",false,true,0)},hideOn:function(e){this._effectOn("hide",e,"display",true,false,0)},fadeOn:function(h,i,g,j,e){var f=null;if(b.isA(this,b.graphics.Group)||b.isA(this,b.graphics.Image)){f=new b.anim.AnimateStyle({targetNode:this,animValues:{opacity:{beginValue:i,endValue:g}},dur:j})}else{f=new b.anim.AnimateStyle({targetNode:this,animValues:{fillOpacity:{beginValue:i,endValue:g},strokeOpacity:{beginValue:i,endValue:g}},dur:j})}f.addBeginEvent(h);if(b.isA(e,String)){this[e]=f}},slideOn:function(i,j,l,k,h,g,f){var e=new b.anim.AnimateTransform({targetNode:this,dur:j,beginEvents:[i]});e.translate(l,k,h,g);if(b.isA(f,String)){this[f]=e}},scaleOn:function(g,f,i,h,n,k,l){var m,j,e;e=new b.anim.AnimateTransform({targetNode:this,dur:f,beginEvents:[g]});m=(n!==undefined?n:0);j=(k!==undefined?k:0);e.translate(m,j,m,j);e.scale(i,i,h,h);e.translate(-m,-j,-m,-j);if(b.isA(l,String)){this[l]=e}}}}());(function(){var h=b.defs,j=h._createDef,p={definition:h.ArrayOfProperties({type:h.String("image")},1,undefined,[{type:"image"}]),hotspotX:h.FinitePositiveNumber(0),hotspotY:h.FinitePositiveNumber(0)};function k(q){return b.hasOwnValue(b.CursorType,q,true)||b.isValueOfType(q,p,true)}function l(q){return(q===null)||b.isA(q,b.filters.AbstractFilter)}function m(r,q){return(r===q)||b.isFinitePositiveNumber(r)}function f(q){return(q===null)||b.isA(q,b.graphics.PathCommands)}function i(u,t,q){var w,v,s,r;q.value={};for(w in t){if(u[w]!==undefined){v=u[w];s=t[w];if(s.constructor===Object){r={validValue:false};i(v,s,r);if(r.validValue){q.value[w]=r.value}}else{if(s===true){q.value[w]=v;q.validValue=true}}}}}function g(u,t,q){var w,v,s,r;q.value={};for(w in u){if(u[w]!==undefined){v=u[w];s=t[w];if(s!==undefined&&s.constructor===Object){r={validValue:false};g(v,s,r);if(r.validValue){q.value[w]=r.value}}else{if(s!==false){q.value[w]=v;q.validValue=true}}}}}function o(s,q){var r=b.style.makeColor(s);if(r){q.validValue=true;q.value=r}}function n(s,q){var r;if(typeof s==="string"){s=s.toUpperCase();r=b.filters[s];if(r){q.validValue=true;q.value=r}}}function e(r,q){if(b.isA(r,String)){try{q.value=new b.graphics.PathCommands(r,true);q.validValue=true}catch(s){q.value=s.message;q.validValue=false}}}b.mixin(h,{Paint:function(r,q){if(!b.isA(r,b.style.Paint)){r=b.style.makeColor(r)}return j("Paint",b.style.Paint,r,q,o)},Color:function(r,q){r=b.style.makeColor(r);return j("Color",b.style.Color,r,q,o)},Image:function(t,s,r,q){return{src:h.String(t,q),width:h.FinitePositiveNumber(s,q),height:h.FinitePositiveNumber(r,q)}},Cursor:function(r,q){return j("Cursor",Object,r,q,undefined,k)},FilterEffect:function(r,q){return j("FilterEffect",Object,r,q,n,l)},Size:function(r,q){return j("Size",Object,r,q,undefined,[m,r])},PathData:function(r,q){return j("PathData",b.graphics.PathCommands,r,q,e,f,undefined,true)},PropertyFilter:function(r,s,q){return{type:"PropertyFilter",convertor:function(u,t){if(typeof u==="object"){if(r===true){g(u,s,t)}else{i(u,s,t)}}else{t.validValue=false}},tag:q}}});b.mixin(h,{FontStyle:function(t,z,u,y){var x=255,q=0,s=0,v=0,w;if(b.isA(y,b.style.Paint)){w=y}else{if(b.isA(y,Array)&&y.length>=3){q=y[0];s=y[1];v=y[2];if(y.length>3){x=y[3]}w=new b.style.Color(q,s,v,x)}else{w=b.black}}return{fontFamily:h.String(t),fontSize:h.FinitePositiveNumber(z),fontWeight:h.Enum(b.FontWeightEnum,u),fill:h.Paint(w)}},Padding:function(u,t,s,r,q){return{top:h.PositiveNumber(u,q),bottom:h.PositiveNumber(r,q),lineBegin:h.PositiveNumber(t,q),lineEnd:h.PositiveNumber(s,q)}},Marker:function(v,x,w,q,y,s,r,t,A,u,z){return{d:h.String(v,u||A),refX:h.FiniteNumber(x,A),refY:h.FiniteNumber(w,A),width:h.FinitePositiveNumber(q,A),height:h.FinitePositiveNumber(y,A),orient:{type:Object,constraint:function(B){return B===b.AUTO||b.isNumberInRange(B,[0,360],false)},defaultValue:s,tag:A},strokeUnits:h.Boolean(r,A),paint:{type:Object,defaultValue:t,tag:z||A}}}})}());(function(){b.declare({name:"oui.style.Paint",membersDef:{init:function(){},getOpacity:function(){return 1}}});b.NO_PAINT=new b.style.Paint()}());(function(){b.mixin(b.style.Paint,{cvToStyle:function(){return"rgba(255,255,255,0)"}})}());(function(){var h=b.defs,i=[0,255],m="([0-9a-f])",l="([0-9a-f]{2})",j="([0-9]{1,3})",k="\\s*,\\s*",e=new RegExp("^#?"+l+l+l+l+"?$|^#?"+m+m+m+"$"),f=new RegExp("^rgba\\("+j+k+j+k+j+k+j+"\\)$|^rgb\\("+j+k+j+k+j+"\\)$");function g(n){var o="";if(n<16){o="0"}return o+n.toString(16)}b.declare({name:"oui.style.Color",extend:b.style.Paint,mixins:[b.lang.PropertiesSupport],membersDef:{init:function(q,o,n,p){this._initProperties({red:q,green:o,blue:n,alpha:p});this.onPropChanged()},onPropChanged:function(){var p=this._properties,o,n,q,r;p.red=Math.round(p.red);p.green=Math.round(p.green);p.blue=Math.round(p.blue);p.alpha=Math.round(p.alpha);o=g(p.red);n=g(p.green);q=g(p.blue);r=g(p.alpha);this.hexRGB=o+n+q;this.hexRGBA=o+n+q+r;this.hexARGB=r+o+n+q;this._onPropChangedImpl()},_onPropChangedImpl:function(){},modify:function(o){var p=0,n=this._properties;if(b.isA(o,Number)){if(o<0){p=0}else{if(o>1){p=1}else{p=o}}}return new b.style.Color(n.red*p,n.green*p,n.blue*p,n.alpha)},setColor:function(o){if(b.isA(o,b.style.Color)){var n=o._properties;this.setProperties({red:n.red,green:n.green,blue:n.blue,alpha:n.alpha})}},setARGB:function(q,p,o,n){this.setProperties({red:p,green:o,blue:n,alpha:q})},setOpacity:function(n){this.setAlpha(n*255)},getOpacity:function(){return this._properties.alpha/255},toString:function(){var n,o=this._properties;if(o.alpha===255){n="#"+this.hexRGB}else{n="rgba(".concat(o.red,",",o.green,",",o.blue,",",o.alpha/255,")")}return n}},propertiesDef:{red:h.NumberInRange(i,0),green:h.NumberInRange(i,0),blue:h.NumberInRange(i,0),alpha:h.NumberInRange(i,255)}});b.style.makeColor=function(q){var n=null,p,o,t,s,r;if(b.isA(q,String)){q=b.trim(q).toLowerCase();if(b.style.CSS_COLORS.hasOwnProperty(q)){n=b[q]}if((r=e.exec(q))!==null){p=parseInt(r[1]||r[5]+r[5],16);o=parseInt(r[2]||r[6]+r[6],16);t=parseInt(r[3]||r[7]+r[7],16);s=255;if(r[4]){s=parseInt(r[4],16)}n=new b.style.Color(p,o,t,s)}if((r=f.exec(q))!==null){p=parseInt(r[1]||r[5],10);o=parseInt(r[2]||r[6],10);t=parseInt(r[3]||r[7],10);s=255;if(r[4]){s=parseInt(r[4],10)}n=new b.style.Color(p,o,t,s)}}else{if(b.isA(q,Array)&&(q.length===3||q.length===4)){p=q[0];o=q[1];t=q[2];s=255;if(q.length===4){s=q[3]}if(b.isNumberInRange(p,i)&&b.isNumberInRange(o,i)&&b.isNumberInRange(t,i)&&b.isNumberInRange(s,i)){n=new b.style.Color(p,o,t,s)}}else{if(b.isA(q,b.style.Color)){n=q}}}return n}}());(function(){b.mixin(b.style.Color,{_onPropChangedImpl:function(){this.cvColor=this.toString()},cvToStyle:function(){return this.cvColor}})}());b.style=b.style||{};(function(){var f,e;b.style.CSS_COLORS=f={aliceBlue:"F0F8FF",antiqueWhite:"FAEBD7",aqua:"0FF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000",blanchedAlmond:"FFEBCD",blue:"00F",blueViolet:"8A2BE2",brown:"A52A2A",burlyWood:"DEB887",cadetBlue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerBlue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"0FF",darkBlue:"00008B",darkCyan:"008B8B",darkGoldenRod:"B8860B",darkGray:"A9A9A9",darkGreen:"006400",darkKhaki:"BDB76B",darkMagenta:"8B008B",darkOliveGreen:"556B2F",darkOrange:"FF8C00",darkOrchid:"9932CC",darkRed:"8B0000",darkSalmon:"E9967A",darkSeaGreen:"8FBC8F",darkSlateBlue:"483D8B",darkSlateGray:"2F4F4F",darkTurquoise:"00CED1",darkViolet:"9400D3",deepPink:"FF1493",deepSkyBlue:"00BFFF",dimGray:"696969",dodgerBlue:"1E90FF",fireBrick:"B22222",floralWhite:"FFFAF0",forestGreen:"228B22",fuchsia:"F0F",gainsboro:"DCDCDC",ghostWhite:"F8F8FF",gold:"FFD700",goldenRod:"DAA520",gray:"808080",green:"008000",greenYellow:"ADFF2F",honeyDew:"F0FFF0",hotPink:"FF69B4",indianRed:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderBlush:"FFF0F5",lawnGreen:"7CFC00",lemonChiffon:"FFFACD",lightBlue:"ADD8E6",lightCoral:"F08080",lightCyan:"E0FFFF",lightGoldenRodYellow:"FAFAD2",lightGrey:"D3D3D3",lightGreen:"90EE90",lightPink:"FFB6C1",lightSalmon:"FFA07A",lightSeaGreen:"20B2AA",lightSkyBlue:"87CEFA",lightSlateGray:"789",lightSteelBlue:"B0C4DE",lightYellow:"FFFFE0",lime:"0F0",limeGreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumAquaMarine:"66CDAA",mediumBlue:"0000CD",mediumOrchid:"BA55D3",mediumPurple:"9370D8",mediumSeaGreen:"3CB371",mediumSlateBlue:"7B68EE",mediumSpringGreen:"00FA9A",mediumTurquoise:"48D1CC",mediumVioletRed:"C71585",midnightBlue:"191970",mintCream:"F5FFFA",mistyRose:"FFE4E1",moccasin:"FFE4B5",navajoWhite:"FFDEAD",navy:"000080",oldLace:"FDF5E6",olive:"808000",oliveDrab:"6B8E23",orange:"FFA500",orangeRed:"FF4500",orchid:"DA70D6",paleGoldenRod:"EEE8AA",paleGreen:"98FB98",paleTurquoise:"AFEEEE",paleVioletRed:"D87093",papayaWhip:"FFEFD5",peachPuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderBlue:"B0E0E6",purple:"800080",red:"F00",rosyBrown:"BC8F8F",royalBlue:"4169E1",saddleBrown:"8B4513",salmon:"FA8072",sandyBrown:"F4A460",seaGreen:"2E8B57",seaShell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyBlue:"87CEEB",slateBlue:"6A5ACD",slateGray:"708090",snow:"FFFAFA",springGreen:"00FF7F",steelBlue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",transparent:"FFFFFF00",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFF",whiteSmoke:"F5F5F5",yellow:"FF0",yellowGreen:"9ACD32"};if(typeof b.style.makeColor==="function"){for(e in f){if(f.hasOwnProperty(e)){b[e.replace(/(.)([A-Z])/g,"$1_$2").toUpperCase()]=b[e.toLowerCase()]=b[e]=b.style.makeColor(f[e])}}}for(e in f){if(f.hasOwnProperty(e)){f[e]="#"+f[e];f[e.toLowerCase()]=f[e]}}}());(function(){b.declare({name:"oui.style.GradientStop",mixins:[b.lang.PropertiesSupport],membersDef:{init:function(e){this._initProperties(e)}},propertiesDef:{color:b.defs.Color(b.black),offset:b.defs.NumberInRange([0,1],0)}})}());(function(){b.declare({name:"oui.style.GradientPaint",isAbstract:true,extend:b.style.Paint,mixins:[b.lang.PropertiesSupport],membersDef:{init:function(e){this._initImpl();this._initProperties(e)},onPropChanged:function(){this._onPropChangedImpl()},addGradientStop:function(i,e){if(this._properties.stops.length===0){this._properties.stops=[]}var h=new b.style.GradientStop({offset:i,color:e}),g=this._properties.stops,j=g.length,f=0;while(f<=j-1&&i>=g[f].getOffset()){f++}g.splice(f,0,h);this.onPropChanged()},_initImpl:function(){},_onPropChangedImpl:function(){}},propertiesDef:{useObjectBoundingBox:b.defs.Boolean(true),stops:b.defs.ArrayOfType({type:b.style.GradientStop,convertor:function(h,e,g,k){var j,f=null;if(typeof h==="object"&&typeof h.offset==="number"){j=h.offset;f=b.style.makeColor(h.color)}else{if(k>1){j=g/(k-1);f=b.style.makeColor(h)}}if(f){e.validValue=true;e.value=new b.style.GradientStop({offset:j,color:f})}}},0,undefined,[],undefined,false,true)}})}());(function(){var e=b.defs;b.declare({name:"oui.style.LinearGradient",extend:b.style.GradientPaint,propertiesDef:{x1:e.FiniteNumber(0),y1:e.FiniteNumber(0),x2:e.FiniteNumber(1),y2:e.FiniteNumber(0)}});b.mixin(b.style,{deriveGradient:function(i,j,f){var k,h,g;if(f===undefined){f=0.8}k=i.modify(f);if(j===true){h=i;g=k}else{h=k;g=i}return new b.style.LinearGradient({x1:0,y1:0,x2:0,y2:1,stops:[h,g]})}})}());(function(){b.mixin(b.style.LinearGradient,{cvToStyle:function(e,m){var l=this._properties,n=l.stops,k=n.length,f,g,j,h;if(l.useObjectBoundingBox){f=m.createLinearGradient(l.x1*e.width+e.x,l.y1*e.height+e.y,l.x2*e.width+e.x,l.y2*e.height+e.y)}else{f=m.createLinearGradient(l.x1,l.y1,l.x2,l.y2)}for(h=0;h<k;h++){j=n[h];g=j.getColor();f.addColorStop(j.getOffset(),g.cvToStyle())}return f}})}());(function(){var e=b.defs;b.declare({name:"oui.style.RadialGradient",extend:b.style.GradientPaint,propertiesDef:{cx:e.FiniteNumber(0.5),cy:e.FiniteNumber(0.5),radius:e.FiniteNumber(0.5)}})}());(function(){b.mixin(b.style.RadialGradient,{cvToStyle:function(e,n){var m=this._properties,o=m.stops,l=o.length,j,g,k,f,h;if(m.useObjectBoundingBox){f=Math.min(e.width,e.height);j=n.createRadialGradient(m.cx*e.width+e.x,m.cy*e.height+e.y,0,m.cx*e.width+e.x,m.cy*e.height+e.y,m.radius*f)}else{j=n.createRadialGradient(m.cx,m.cy,0,m.cx,m.cy,m.radius)}for(h=0;h<l;h++){k=o[h];g=k.getColor();j.addColorStop(k.getOffset(),g.cvToStyle())}return j}})}());(function(){b.declare({name:"oui.style.PatternPaint",extend:b.style.Paint,mixins:[b.lang.PropertiesSupport,b.events.EventSupport],eventsDef:{PATTERN_READY:"patternReady"},membersDef:{init:function(e){this._srcW=0;this._srcH=0;this._initImpl();this._initProperties(e)},onPropChanged:function(){var e=this._properties.src;if(this.prevRequest){b.resourcesManager.removeObserver(this.prevRequest,this);this.prevRequest=null}else{if(this.imageLoader){this.imageLoader.offComplete(this);this.imageLoader=null}}this._onPropChangedImpl();if(e.length>0){if(b.resourcesManager.hasResource(e)){b.resourcesManager.requestResource(e,this);this.prevRequest=e}else{this.imageLoader=new b.utils.ImageLoader();this.imageLoader.onComplete(this);this.imageLoader.load(e)}}},handleEvent:function(e){this._srcW=e.width;this._srcH=e.height;this._patternReadyImpl(e);this.dispatchEvent({type:this.events.PATTERN_READY})},resourceUpdate:function(e){this.handleEvent(e)},_initImpl:function(){},_onPropChangedImpl:function(){},_patternReadyImpl:function(e){}},propertiesDef:{src:b.defs.String("")}})}());(function(){var e=b.style.Paint.prototype;b.mixin(b.style.PatternPaint,{_onPropChangedImpl:function(){this.cvImg=null},_patternReadyImpl:function(f){this.cvImg=f.data},cvToStyle:function(f,g){return this.cvImg?g.createPattern(this.cvImg,"repeat"):e.cvToStyle.call(this,f,g)}})}());(function(){b.ns("oui.style");var t=b.GENERIC_FONTS.SANS_SERIF,q=b.GENERIC_FONTS.SERIF,e=b.GENERIC_FONTS.MONOSPACE,g=b.GENERIC_FONTS.CURSIVE,o,p,h,l,k,r,s,f;o=[["Arial","'Helvetica Neue'","Helvetica",t],["'Arial Black'","Gadget",t],["'Comic Sans MS'","'Comic Sans'","Textile",g],["'Courier New'","Courier",e],["Georgia",q],["Impact","Charcoal",t],["'Lucida Console'","Monaco",e],["'Lucida Sans Unicode'","'Lucida Grande'",t],["'Palatino Linotype'","'Book Antiqua'","Palatino",q],["Tahoma","Geneva","'Liberation Sans'","'Nimbus Sans L'","FreeSans",t],["'Times New Roman'","Times",q],["'Trebuchet MS'","Trebuchet",t],["Verdana","Geneva",t],["'MS Sans Serif'","Geneva",t],["'MS Serif'","'New York'",q]];b.cssFonts={};for(p=0,h=o.length;p<h;p++){r=o[p];for(l=0,k=r.length-1;l<k;l++){f=r[l].replace(/'/gi,"").toLowerCase();if(b.cssFonts.hasOwnProperty(f)===false){s=r.slice();s.splice(l,1);s.unshift(r[l]);b.cssFonts[f]=s.join(",")}}}}());(function(){b.ns("oui.text.locales");b.text.locales.en_US={eras:["BC","AD"],months:[{l:"January",s:"Jan"},{l:"February",s:"Feb"},{l:"March",s:"Mar"},{l:"April",s:"Apr"},{l:"May",s:"May"},{l:"June",s:"Jun"},{l:"July",s:"Jul"},{l:"August",s:"Aug"},{l:"September",s:"Sep"},{l:"October",s:"Oct"},{l:"November",s:"Nov"},{l:"December",s:"Dec"}],days:[{l:"Sunday",s:"Sun"},{l:"Monday",s:"Mon"},{l:"Tuesday",s:"Tue"},{l:"Wednesday",s:"Wed"},{l:"Thursday",s:"Thu"},{l:"Friday",s:"Fri"},{l:"Saturday",s:"Sat"}],ampm:["AM","PM"],timezones:{0:{std:{l:"Greenwich Mean Time",s:"GMT"},dst:{l:"Greenwich Mean Time",s:"GMT"}},480:{std:{l:"Pacific Standard Time",s:"PST"},dst:{l:"Pacific Daylight Time",s:"PDT"}},420:{std:{l:"Mountain Standard Time",s:"MST"},dst:{l:"Mountain Daylight Time",s:"MDT"}},360:{std:{l:"Central Standard Time",s:"CST"},dst:{l:"Central Daylight Time",s:"CDT"}},300:{std:{l:"Eastern Standard Time",s:"EST"},dst:{l:"Eastern Daylight Time",s:"EDT"}},600:{std:{l:"Hawaii Standard Time",s:"HST"},dst:{l:"Hawaii Standard Time",s:"HST"}},540:{std:{l:"Alaska Standard Time",s:"AKST"},dst:{l:"Alaska Standard Time",s:"AKST"}},240:{std:{l:"Atlantic Standard Time",s:"AST"},dst:{l:"Atlantic Daylight Time",s:"ADT"}},210:{std:{l:"Newfoundland Standard Time",s:"NST"},dst:{l:"Newfoundland Daylight Time",s:"NDT"}}},shortDate:"M/d/yy",medDate:"d-MMM-yy",longDate:"MMMM d, yyyy",fullDate:"EEEE MMMM d, yyyy G",date:"d-MMMM-yy",shortTime:"h:mm a",medTime:"h:mm:ss a",longTime:"h:mm:ss a z",fullTime:"h:mm:ss;S 'o''clock' a z",time:"h:mm:ss a"}}());b.text=b.text||{};(function(){var t,e="0",s="#",i="0",j="E",p="+",k="-",v="\u221E";t=function(){};t.prototype={tempMinIntegerDigits:0,minDecimalPlaces:0,maxDecimalPlaces:0,minIntegerPlaces:1,maxIntegerPlaces:1,prefix:"",suffix:"",integerPattern:"",decimalPattern:"",grouping:3,percentMode:false,permilleMode:false,color:null};function f(y){var B,z=0,A=y.length,x=false;if(y.charAt(z)===j&&A>1){x=true;z+=1;B=y.charAt(z);if(B===p||B===k){z+=1}while(z<A){if(y.charAt(z)===e){z++}else{x=false;break}}}return x}function l(D,x,y){var z=false,A=false,F=D.length>0,E,C,B;for(C=0,B=D.length;C<B;C++){E=D.charAt(C);if(E===s||E===e){continue}else{if(E===x){if(z){F=false;break}else{z=true}}else{if(E===y){if(A){F=false;break}else{if(z){F=false;break}else{A=true}}}else{if(E===j){F=f(D.substring(C,B));break}else{F=false;break}}}}}return F}function h(A,y){var B,x,z;B=A.indexOf("[");x=A.indexOf("]");if(B>-1&&x>B){z=A.substring(B+1,x).toLowerCase();if(b.style.CSS_COLORS.hasOwnProperty(z)){y.color=b.style.CSS_COLORS[z]}else{if(z.match(/^(0x)?[0-9a-fA-F]{6}$/)){y.color="#"+z.replace("0x","")}}if(y.color!==null){A=A.substring(0,B)+A.substring(x+1)}}return A}function q(I,D,x){var y=I.length,L=I.indexOf(s),z=I.indexOf(e),C=I.indexOf(x),H=I.indexOf("%"),B=I.indexOf("\u2030"),M,E,F,G,K,A,J;if(L<0){L=y-1}if(z<0){z=y-1}if(C<0){C=y-1}F=I.lastIndexOf(s);G=I.lastIndexOf(e);K=I.lastIndexOf(x);A=Math.min(L,C,z);A=A<0?0:A;J=Math.max(F,G,K);D.prefix=I.substring(0,A);D.suffix=I.substring(J+1,y);if(A>J+1||(H>=0&&B>=0)||(H>=0&&H!==I.lastIndexOf("%"))||(B>=0&&B!==I.lastIndexOf("\u2030"))){I=""}else{I=I.substring(A,J+1);if(H>0){D.percentMode=true;M=H;E="%"}else{if(B>0){D.permilleMode=true;M=B;E="\u2030"}}if(M>=A&&M<=J){I=I.replace(E,"");D.suffix=E+D.suffix}}return I}function g(A,y,x){var z=A.lastIndexOf(x);if(z>0){y.grouping=A.length-z-1}else{y.grouping=-1}}function m(y,x){x.minDecimalPlaces=0;x.maxDecimalPlaces=0;if(y.length>0){x.minDecimalPlaces=y.lastIndexOf(e)>-1?y.lastIndexOf(e)+1:0;x.maxDecimalPlaces=y.length}}function w(B,y,x){var A,D,z,C;y.minIntegerPlaces=0;y.maxIntegerPlaces=0;for(z=0,C=B.length;z<C;z++){D=B.charAt(z);if(D===e){y.minIntegerPlaces++;y.maxIntegerPlaces++}if(D===s){y.maxIntegerPlaces++}}A=B.lastIndexOf(x);y.tempMinIntegerDigits=A;if(y.tempMinIntegerDigits===-1){y.tempMinIntegerDigits=y.minIntegerPlaces}}function o(D,A,z,y){var x=D.split(j),C,E,B;A.exponent=0;if(x.length===2){C=x[1];B=0;E=C.charAt(B);if(E===p){B+=1}A.exponent=C.length-B}else{A.exponent=0}C=x[0].split(z);if(z===y&&C.length===3){A.intPattern=C[0];A.intPattern+=y;A.intPattern+=C[1];A.decPattern=C[2]}else{if(C.length===2){A.intPattern=C[0];A.decPattern=C[1]}else{A.intPattern=x[0];A.decPattern=""}}}function u(A,z,y){var x=new t();A=h(A,x);A=q(A,x,z);if(l(A,z,y)){o(A,x,z,y);g(x.intPattern,x,y);m(x.decPattern,x);w(x.intPattern,x,y)}else{x=null}return x}function n(E,A,z,y){var F="",x="",B,C=0,D=0;if(E>0){x=E.toString()}A-=x.length;if(A>0){for(C=0;C<A;C++){F+=i}x=F+x}if(z>0&&x.length>z){B=[];for(C=x.length-1;C>=0;C--){if(D===z-1&&C>0){B.unshift(y,x.charAt(C));D=0}else{B.unshift(x.charAt(C));D++}}x=B.join("")}return x}function r(D,C,y,x){var E="",z=0,B="",A;if(D>0){A=C-Math.floor(C);for(z=0;z<x;z++){A*=10;if(Math.floor(A)===0){B+=i}else{break}}if(z<x){B+=D.toString()}z=B.length-1;while(B.charAt(z)===i&&z>=y){z--}B=B.substring(0,z+1)}y-=B.length;if(y>0){for(z=0;z<y;z++){E+=i}B+=E}return B}b.text.NumberFormatter=function(B){var z=".",D=",",y=null,x=null,A,C=null;this.applyPattern=function(K){var G,J,F="",I=0,H="",L="",E;if(typeof K==="string"&&K.length>0&&K!==A){G=K.indexOf("{");J=K.indexOf("}");if(G===0&&J>=2){F=K.substring(G+1,J);I=F.length;if(J>2){H=F.charAt(I-1);L=F.charAt(I-2)}else{H="\uFFFF";L=F.charAt(I-1)}if(H!==L&&!H.match(/[0-9a-zA-Z]/)&&!L.match(/[0-9a-zA-Z]/)){z=H;D=L;K=K.substring(J+1)}}E=K.split(";");if(E&&E.length>0){y=u(E[0],z,D);if(E.length>1&&E[1]&&E[1].length>0){x=u(E[1],z,D)}else{x=y}}else{y=null;x=null}A=K}};this.format=function(L){var U,G,H="",R,N,I,O,S,T,K,P,Q,J,F,E,M;if(typeof L!=="number"||y===null){U=""}else{G=L<0?x:y;C=G.color;R=G.exponent;N=G.tempMinIntegerDigits;I=G.minIntegerPlaces;O=G.minDecimalPlaces;S=G.maxDecimalPlaces;if(L<0&&y===x){H+=k}if(L<0){L=-L}if(G.percentMode){L*=100}else{if(G.permilleMode){L*=1000}}T=0;K=0;if(R>0){K=Math.floor(Math.log(L)/Math.log(10));if(K!==Infinity){P=K;if(I!==0){K-=I-1}T=(L/Math.pow(10,K));K=P-(N-1)}else{T=L}}else{T=L}T+=5*Math.pow(10,-S-1);Q=Math.floor(T);J=T-Q;F=Math.pow(10,-S);E=Math.floor(J/F);U=n(Q,I,G.grouping,D);if(O>0||E>0){U+=z}U+=r(E,T,O,S);if(R>0){if(K===Infinity||K===-Infinity){if(Math.abs(L)<1){U=i}else{U=v}}else{U+=j;if(K<0){U+=k}else{U+=p}for(M=1;M<R;M++){U+=i}U+=Math.abs(K).toString()}}if(U.length>0&&D===U.charAt(0)){U=U.substring(1,U.length)}if(U.length===0){U=i}U=(G.prefix+H+U+G.suffix)}return U};this.getColor=function(){return C};this.hasColor=function(){return C!==null};this.applyPattern(B)};b.formatNumber=function(y,x){return new b.text.NumberFormatter(y).format(x)}}());(function(){var e=/\|/,f=/(?:#|<)/;b.declare({name:"oui.text.ChoiceFormatter",membersDef:{init:function(g){this.applyPattern(g)},applyPattern:function(q){var h=q.split(e),m,j,r,g,s,k,l,p,o;if(h&&h.length>0){o=[];for(m=0,j=h.length;m<j;m++){r=h[m];g=r.match(f);if(g){s=r.indexOf(g);k=r.substring(0,s);l=r.substring(s+1);p={format:l,open:(g[0]==="<"),min:parseInt(k,10),max:Number.POSITIVE_INFINITY};if(o.length>0){o[o.length-1].max=p.min}o.push(p)}}}this.choiceElements=o},format:function(m){var g,l=this.choiceElements,h,j,p=l.length,k=l[0],o=l[p-1];if(isNaN(m)||m<=k.min){g=k.format}else{if(m>=o.max){g=o.format}else{for(j=0;j<p;j++){h=l[j];if((h.open===false&&h.min===m)||(h.min<m&&m<h.max)){g=h.format;break}}}}return g}}});b.formatChoice=function(h,g){return new b.text.ChoiceFormatter(h).format(g)}}());(function(){var y=b.text.locales.en_US,n="G",f="y",F="M",z="w",i="W",u="D",p="d",D="F",m="E",C="a",A="H",j="k",E="K",v="h",o="m",s="s",k="S",l="z",x="Z",B="short",r="medium",h="long",t="full",g=24*60*60*1000,q=1,w=4;function e(J,I){var G="",H=J.toString();for(I-=H.length;I>0;I--){G+="0"}return G+H}b.declare({name:"oui.text.DateFormatter",membersDef:{init:function(G,H){this.applyPattern(G,H)},applyPattern:function(I,K){var H,N,M,G,L,J;I=this._fixPattern(I,K);this.dateElements=[];if(I){for(H=0,N=I.length;H<N;H++){M=I.charAt(H);if(!this._isSupportedToken(M)){J=undefined;if(M==="'"){G="";L=H+1;while(L<N){M=I.charAt(L);if(M==="'"){if(I.charAt(L+1)==="'"){G+=M;L+=2}else{break}}else{G+=M;L+=1}}if(L>=N){L=H}else{this.dateElements.push(G)}H=L}else{if((M<"a"||M>"z")&&(M<"A"||M>"Z")){this.dateElements.push(M)}}}else{if(J&&(M===J.type)){J.size++}else{J={type:M,size:1};this.dateElements.push(J)}}}}},_fixPattern:function(H,I){var G;if(H){switch(H){case B:G=I?y.shortTime:y.shortDate;break;case r:G=I?y.medTime:y.medDate;break;case h:G=I?y.longTime:y.longDate;break;case t:G=I?y.fullTime:y.fullDate;break;default:G=H;break}}else{G=I?y.time:y.date}return G},_isSupportedToken:function(G){return(G===n||G===f||G===F||G===z||G===i||G===u||G===p||G===D||G===m||G===C||G===A||G===j||G===E||G===v||G===o||G===s||G===k||G===l||G===x)},format:function(N){var L="",I,H,J,G,K,M,O;if(b.isA(N,Date)){I=N}else{I=new Date();I.setDate(N)}for(J=0,G=this.dateElements.length;J<G;J++){H=this.dateElements[J];if(b.isA(H,Object)){switch(H.type){case n:L+=y.eras[I.getFullYear()>0?1:0];break;case f:K=I.getFullYear().toString();if(H.size<4){L+=K.substring(K.length-2)}else{L+=K}break;case F:K=I.getMonth();if(H.size<3){L+=e(K+1,H.size)}else{if(H.size<4){L+=y.months[K].s}else{L+=y.months[K].l}}break;case z:L+=e(this._getWeekOfYear(I),H.size);break;case i:L+=e(this._getWeekOfMonth(I),H.size);break;case u:L+=e(this._getDayOfYear(I),H.size);break;case p:L+=e(I.getDate(),H.size);break;case D:L+=e(I.getDay(),H.size);break;case m:K=I.getDay();if(H.size<4){L+=y.days[K].s}else{L+=y.days[K].l}break;case C:L+=y.ampm[I.getHours()<12?0:1];break;case A:L+=e(I.getHours(),H.size);break;case j:L+=e(((I.getHours()+23)%24)+1,H.size);break;case E:L+=e(I.getHours()%12,H.size);break;case v:L+=e(((I.getHours()+11)%12)+1,H.size);break;case o:L+=e(I.getMinutes(),H.size);break;case s:L+=e(I.getSeconds(),H.size);break;case k:L+=e(I.getMilliseconds(),H.size);break;case l:K=I.getTimezoneOffset();if(this._isDST(I)){M=(K+60).toString();O="dst"}else{M=K.toString();O="std"}if(y.timezones.hasOwnProperty(M)){K=y.timezones[M];if(H.size<4){L+=K[O].s}else{L+=K[O].l}}else{L+="GMT"+(K>0?"-":"+")+Math.floor(K/60)+":"+e((K%60),2)}break;case x:K=I.getTimezoneOffset();L+=(K>0?"-":"+")+e(Math.floor(K/60),2)+e((K%60),2);break;default:c.error("ERR__FORMAT__ILLEGAL_DATE_PATTERN",H)}}else{L+=H.toString()}}return L},_getWeekOfYear:function(H,G,L){var K,I,J,M;if(!isFinite(G)){G=q}if(!isFinite(L)){L=w}K=(7+H.getDay()-G)%7;I=(this._getDayOfYear(H)-K+6)/7;J=new Date(H.getFullYear(),0,L);M=(7+J.getDay()-G)%7;if(L-M<1){I++}return Math.floor(I)},_getWeekOfMonth:function(I,H,L){var K,G,J,M;if(!isFinite(H)){H=q}if(!isFinite(L)){L=w}K=(7+I.getDay()-H)%7;G=(I.getDate()-K+6)/7;J=new Date(I.getFullYear(),I.getMonth(),L);M=(7+J.getDay()-H)%7;if(L-M<1){G++}return Math.floor(G)},_getDayOfYear:function(I){var J=I.getFullYear(),M=I.getMonth(),G=I.getDate(),H=new Date(J,0,1,12,0,0),L=new Date(J,M,G,12,0,0),K=(L.getTime()-H.getTime())/g;return(Math.round(K)+1)},_isDST:function(H){var G=new Date(H.getFullYear(),0,1,H.getHours(),H.getMinutes(),H.getSeconds(),H.getMilliseconds());return(H.getTimezoneOffset()!==G.getTimezoneOffset())}}});b.text.DateFormatter.setLocale=function(G){if(typeof G==="string"&&b.text.locales.hasOwnProperty(G)===true){y=b.text.locales[G]}};b.formatDate=function(H,G){return new b.text.DateFormatter(H).format(G)}}());(function(){var e={NUMBER:"number",CHOICE:"choice",DATE:"date",TIME:"time"};b.declare({name:"oui.text.FormatElement",membersDef:{init:function(k,j,i){var h,f,g;if(b.isFinitePositiveNumber(k)){this.argIndex=k}else{c.error("ERR__FORMAT__ILLEGAL_ARG_INDEX")}h=b.isA(j,String);f=b.isA(i,String);if(h&&f){switch(j){case e.NUMBER:g=new b.text.NumberFormatter(i);break;case e.CHOICE:g=new b.text.ChoiceFormatter(i);break;case e.DATE:g=new b.text.DateFormatter(i);break;case e.TIME:g=new b.text.DateFormatter(i,true);break;default:c.error("ERR__FORMAT__ILLEGAL_ARG_TYPE",j)}this.type=j}else{if(h&&!f){c.error("ERR__FORMAT__ILLEGAL_ARG_NO_STYLE")}else{if(!h&&f){c.error("ERR__FORMAT__ILLEGAL_ARG_NO_TYPE")}}}this.format=function(m){var l;if(this.accepts(m)){if(g){l=g.format(m)}else{l=(m===null?"null":m.toString())}}else{c.error("ERR__FORMAT__ILLEGAL_ARG_VALUE")}return l}},accepts:function(h){var g=true,f=this.type;if(f){if(f===e.NUMBER||f===e.CHOICE){g=b.isA(h,Number)}else{if(f===e.DATE||f===e.TIME){g=b.isA(h,Date)}}}return g},toString:function(){return"{"+this.argIndex+"}"}}});b.text.FormatElement.TypeEnum=e}());(function(){var e=/\{\d+(?:\,(?:choice|number|date|time)\,(?:[^\{]|\{[^\{]+\})+)?\}/g;b.declare({name:"oui.text.MessageFormatter",membersDef:{init:function(f){this.applyPattern(f)},applyPattern:function(q){var h=q.match(e),p=q.split(e),o,j,m,t,l,r,s,g,f,k,u=[];if(h&&h.length>0&&p&&p.length>0){for(o=0,j=h.length;o<j;o++){m=undefined;l=undefined;r=undefined;s=h[o];g=s.indexOf(",");if(g<0){t=s.substring(1,s.length-1);m=parseInt(t,10)}else{m=parseInt(s.substring(1,g),10);f=s.indexOf(",",g+1);l=s.substring(g+1,f);r=s.substring(f+1,s.length-1)}k=new b.text.FormatElement(m,l,r);u.push(p[o]);u.push(k)}u.push(p[h.length])}else{u.push(q)}this.parsedPattern=u},format:function(){var g="",k,j=this.parsedPattern.length,m,f,h,l;for(k=0;k<j;k++){m=this.parsedPattern[k];if(b.isA(m,b.text.FormatElement)){f=arguments[m.argIndex];if(f!==undefined){h=m.format(f);if(m.type===b.text.FormatElement.TypeEnum.CHOICE){l=new b.text.MessageFormatter(h);h=l.format.apply(l,arguments)}g+=h}else{g+=m.toString()}}else{if(b.isA(m,String)){g+=m}}}return g}}});b.formatMessage=function(h,g){var f=new b.text.MessageFormatter(h);return f.format.apply(f,g)}}());(function(){var f=new RegExp("\\S+","g");function e(k){var i=[],g,j,h=0;while((g=f.exec(k))!==null){j=g[0];i.push({beginIndex:g.index,endIndex:g.index+(j.length-1),length:j.length,value:j,wordIndex:h});h++}return i}b.declare({name:"oui.text.WordIterator",membersDef:{init:function(g){this._words=e(g);this._wordCount=this._words.length;this._currWord=null},first:function(){var g=null;if(this._wordCount>0){g=this._words[0]}this._currWord=g;return g},last:function(){var g=null;if(this._wordCount>0){g=this._words[this._wordCount-1]}this._currWord=g;return g},next:function(){var i=null,j=this._wordCount,h,g;if(j>0){h=this._currWord;g=0;if(h){g=h.wordIndex+1}if(g<j){i=this._words[g]}}this._currWord=i;return i},previous:function(){var i=null,h=this._wordCount,g,j;if(h>0){g=this._currWord;j=h-1;if(g){j=g.wordIndex-1}if(j>=0){i=this._words[j]}}this._currWord=i;return i},current:function(){return this._currWord},wordAt:function(n){var m=this._words,h=this._wordCount,k=null,l=0,j,g=null;if(this._currWord){l=this._currWord.wordIndex}for(j=l;j<h;j++){g=m[j];if(n<g.beginIndex){break}else{if(n<=g.endIndex){k=g;break}}}this._currWord=g;return k}}})}());(function(){var e="\n";b.declare({name:"oui.text.LineBreakMeasurer",membersDef:{init:function(f){this._textValue=f.textValue();this._position=0;this._wordIterator=new b.text.WordIterator(this._textValue);this._wordIterator.first();this._initOffsetLimits();this._initImpl(f)},nextLine:function(g){var f=this._nextLineImpl(g);if(f&&f.leading===undefined){f.leading=this._computeLeadingApproximation(f)}return f},replaceText:function(g,j,i){var h=this._textValue,f=h.length;if(g<0||j>f||g>j){c.error("ERR__LINEBREAK__ILLEGAL_REPLACE_ARG")}this._textValue="";if(g!==0){this._textValue+=h.slice(0,g)}if(i!==null){this._textValue+=i}if(j!==f){this._textValue+=h.slice(j)}this._position=0;this._wordIterator.init(this._textValue);this._wordIterator.first();this._initOffsetLimits();this._replaceTextImpl(g,j,i)},getRawText:function(){return this._textValue},getTextLength:function(){return this._textValue.length},_initImpl:function(f){},_nextLineImpl:function(l){var k=this._getCurrentOffsetLimit(),n=null,i=this._wordIterator,j=this._position,g=j,f=i.current(),m,h;if(f){m=f.endIndex+1;if(m>k||this._measureImpl(j,m)>l){g=this._fitChars(l,k);h=true}else{g=this._fitWords(l,k);h=false}this._updateOffsetLimit(g);if(g>j){n=this._createLineObjImpl(j,g,h);this._position=g}}return n},_measureImpl:function(g,f){return 0},_createLineObjImpl:function(h,f,g){return{textValue:this._textValue.substring(h,f),textBlockBeginIndex:h,lastWordTruncated:g,lineWidth:0,lineHeight:0,ascent:0,descent:0,userData:null}},_replaceTextImpl:function(f,h,g){},_initOffsetLimits:function(){this._offsetLimits=this._findOffsetLimits(this._textValue);this._offsetLimitsCount=this._offsetLimits.length;this._currOffsetLimit=0},_findOffsetLimits:function(g){var f=[],j=0,h=g.length;for(j=0;j<h;j++){if(e===g.charAt(j)){f.push(j+1)}}return f},_getCurrentOffsetLimit:function(){var f=this._textValue.length;if(this._currOffsetLimit<this._offsetLimitsCount){f=this._offsetLimits[this._currOffsetLimit]}return f},_updateOffsetLimit:function(f){if(f===this._offsetLimits[this._currOffsetLimit]){this._currOffsetLimit++}},_fitChars:function(h,g){var j=this._position,i=this._position+1,f=i;while(i<g&&this._measureImpl(j,i)<=h){f=i;i++}return f},_fitWords:function(g,f){var h=this._wordIterator.current(),j=this._position,i=j;while(h&&(h.endIndex+1)<=f&&this._measureImpl(j,h.endIndex+1)<=g){i=h.endIndex+1;h=this._wordIterator.next()}if(h&&i!==j&&i!==f){if(h.beginIndex>f){i=f}else{i=h.beginIndex}}return i},_computeLeadingApproximation:function(f){return(f.ascent+f.descent)*0.2}}})}());(function(){b.mixin(b.text.LineBreakMeasurer,{_initImpl:function(e){this._font=e.cvGetFont();this._fontSize=e.fontSize();this.cvTextMeasurer=b.tree.canvas.getContext("2d")},_measureImpl:function(h,e){var f,g=this.cvTextMeasurer;g.save();g.font=this._font;f=g.measureText(this._textValue.substring(h,e));g.restore();return f.width},_createLineObjImpl:function(i,e,h){var f=this._textValue.substring(i,e),g=b.tree.cvTextMetrics(f,this._font);return{textValue:f,textBlockBeginIndex:i,textBlockEndIndex:e,lastWordTruncated:h,lineWidth:g.width,lineHeight:g.height,ascent:g.ascent,descent:g.descent,leading:0,userData:null}}})}());(function(){var e="FILTER_EVENT";b.declare({name:"oui.filters.AbstractFilter",isAbstract:true,mixins:[b.events.EventSupport],membersDef:{init:function(f){this._style=new this.Style();this.applyStyle(f)},applyStyle:function(f){var g=this._style.updateObject(f),h;if(this.shadowFilter){for(h in g){if(g.hasOwnProperty(h)){this._updateShadowFilter(h)}}}this.dispatchEvent({type:e})},_getFilteredBounds:function(f){return f},_getShadowFilter:function(){if(!this.shadowFilter){this.shadowFilter=this._createShadowFilter()}return this.shadowFilter},_createShadowFilter:function(){},_updateShadowFilter:function(f){}}});b.filters.FILTER_EVENT=e}());(function(){b.mixin(b.filters.AbstractFilter,{cvApplyFX:function(e,f){return e}})}());(function(){var e={RADIUS:"RADIUS"};b.declare({name:"oui.filters.Blur",extend:b.filters.AbstractFilter,membersDef:{_getFilteredBounds:function(g){var f=this._style.radius;return{x:g.x-f,y:g.y-f,width:g.width+2*f,height:g.height+2*f}},_styleTags:e}});b.addStyleSupport(b.filters.Blur,{radius:b.defs.FinitePositiveNumber(3,e.RADIUS)})}());(function(){var e=b.defs,f={COLOR:"COLOR",OPACITY:"OPACITY",RADIUS:"RADIUS",ANGLE:"ANGLE",OFFSET:"OFFSET",KNOCKOUT:"KNOCKOUT"};b.declare({name:"oui.filters.DropShadow",extend:b.filters.AbstractFilter,membersDef:{_getFilteredBounds:function(i){var h=this._style,k=h.angle*Math.PI/180,j=h.offset,g=h.radius;return b.geom.unionRect(i,{x:i.x+j*Math.cos(k)-g,y:i.y+j*Math.sin(k)-g,width:i.width+2*g,height:i.height+2*g})},_styleTags:f},styleDef:{color:e.Color(b.black,f.COLOR),opacity:e.NumberInRange([0,1],0.5,f.OPACITY),radius:e.FinitePositiveNumber(2,f.RADIUS),angle:e.NumberInRange([0,360],45,f.ANGLE),offset:e.FinitePositiveNumber(2,f.OFFSET),knockout:e.Boolean(false,f.KNOCKOUT)}})}());(function(){b.mixin(b.filters.DropShadow,{isInGlobalSpace:true,cvApplyFX:function(h,e){var g,q,r=b.tree.cvPixelRatio,f=this._style,k=f.color,i=f.angle*Math.PI/180,m=f.offset*r,p=f.radius*r,l=m*Math.cos(i),j=m*Math.sin(i),o=Math.floor(e.x+l-p),n=Math.floor(e.y+j-p);g=b.tree.cvCreateBuffer(e.width,e.height);q=g.getContext("2d");q.translate(-o,-n);q.shadowColor="rgba(".concat(k.getRed(),",",k.getGreen(),",",k.getBlue(),",",(f.opacity*k.getOpacity()),")");q.shadowOffsetX=l;q.shadowOffsetY=j;q.shadowBlur=p;q.drawImage(h,o,n);if(f.knockout){q.globalCompositeOperation="destination-out";q.drawImage(h,o,n)}b.tree.cvDisposeBuffer(h);return g}})}());(function(){var e=b.defs,f={STRENGTH:"STRENGTH",COLOR:"COLOR",OPACITY:"OPACITY"};b.declare({name:"oui.filters.Glow",extend:b.filters.AbstractFilter,membersDef:{_getFilteredBounds:function(g){var h=this._style.strength;return{x:g.x-h,y:g.y-h,width:g.width+2*h,height:g.height+2*h}},_styleTags:f}});b.addStyleSupport(b.filters.Glow,{color:e.Color(b.white,f.COLOR),strength:e.FinitePositiveNumber(3,f.STRENGTH)})}());(function(){b.mixin(b.filters.Glow,{isInGlobalSpace:true,cvApplyFX:function(i,e){var g,l,f=this._style,j=f.color,h=f.strength*b.tree.cvPixelRatio,m=Math.floor(e.x-h),k=Math.floor(e.y-h);g=b.tree.cvCreateBuffer(e.width,e.height);l=g.getContext("2d");l.translate(-m,-k);l.shadowColor="rgba(".concat(j.getRed(),",",j.getGreen(),",",j.getBlue(),",",j.getOpacity(),")");l.shadowBlur=h;l.drawImage(i,m,k);b.tree.cvDisposeBuffer(i);return g}})}());(function(){b.mixin(b.filters,{NONE:null,BLUR:new b.filters.Blur(),DROP_SHADOW:new b.filters.DropShadow(),DROP_SHADOW_KNOCKED_OUT:new b.filters.DropShadow({knockout:true}),_onLayoutDir:function(e){var f=e===b.LTR?45:135;b.filters.DROP_SHADOW.setAngle(f);b.filters.DROP_SHADOW_KNOCKED_OUT.setAngle(f)}})}());(function(){var f=b.scene.AbstractNode.prototype,e=b.defs,g=b.TAGS;b.declare({name:"oui.graphics.AbstractGraphicNode",isAbstract:true,extend:b.scene.AbstractNode,mixins:[b.lang.BindingSupport,b.anim.EffectsSupport],membersDef:{init:function(h,i){f.init.call(this,i);this._globalTxf=undefined;this._globalTxfInv=undefined;this._layoutDirty=true;this._layoutPosDirty=true;this._layoutBox=undefined;this._prevLayoutBox=undefined;this._filterFX=null;this._ctrlPts=[];this._style=new this.Style();this._style.transform=new b.geom.Matrix();this._txf=this._style.transform;if(h){this.styleBinding=h.styleBinding;this.dataBinding=h.dataBinding;this.resourcesBinding=h.resourcesBinding}this.applyStyle(h)},notifyNative:function(i){var h=this.parentNode;if(i===g.TRANSFO){this.clearGlobalTransformMatrix();if(h&&this.preventParentInvalidateLayout!==true){h._clearCtrlPts();h.invalidateLayout()}}else{if(i===g.LAYOUT_DIR){this._onLayoutDirChanged();if(b.isA(this._style.tooltip,b.graphics.AbstractGraphicNode)){this._style.tooltip.notifyChildren(i)}}}f.notifyNative.call(this,i)},_onParentChanged:function(){this.clearGlobalTransformMatrix();f._onParentChanged.call(this)},_onChildrenChanged:function(){this._clearCtrlPts();this.invalidateLayout();f._onChildrenChanged.call(this)},onPropertyChanged:function(){},onStyleChanged:function(h){if(h===b.DEFAULT_TAG){this.onPropertyChanged()}else{if(h===g.VISIBILITY||h===g.SENSITIVITY||h===g.DESC){this.notifyNative(h)}else{if(h===g.LAYOUT||h===g.PREF_SIZE){this.invalidateLayout()}else{if(h===g.DISPLAY||h===g.CLIP){this._clearCtrlPts();this.invalidateLayout();this.notifyNative(h)}else{if(h===g.FILTER){this._updateFilterFX();this.notifyNative(h)}else{if(h===g.CURSOR){this._onCursorChanged();this.notifyNative(h)}else{if(h===g.TRANSFO_SET){this._style.transform=this._style.transform.clone();this._txf=this._style.transform;this.notifyNative(g.TRANSFO)}}}}}}}},applyStyle:function(h){var i,j;if(h){i=this._style.updateObject(h);for(j in i){if(i[j]===true){this.onStyleChanged(j)}}}},applyStyleBinding:function(j,i,h){this._applyBinding(j,i,"styleBinding","styleBindingScope",this.applyStyle,h)},applyDataBinding:function(j,i,h){this._applyBinding(j,i,"dataBinding","dataBindingScope",this.applyStyle,h)},applyResourcesBinding:function(j,i,h){this._applyBinding(j,i,"resourcesBinding","resourcesBindingScope",this.applyStyle,h)},requestFocus:function(){if(b.focusManager){b.focusManager.requestFocus(this)}},getDefaultDragAction:function(){return function(h){var i=h.target;if(i&&i.draggable()){i.translate(h.dragUserX,h.dragUserY)}}},translate:function(i,h){if(i!==0||h!==0){this._txf.translate(i,h);this.notifyNative(g.TRANSFO)}return this},scale:function(i,h){this._txf.scale(i,h);this.notifyNative(g.TRANSFO);return this},rotate:function(j,h,k){var i=j/180*Math.PI;this._txf.rotate(i,h,k);this.notifyNative(g.TRANSFO);return this},setTranslation:function(h,i){if(b.isFiniteNumber(h)&&b.isFiniteNumber(i)){this._setTranslation(h,i)}},_setTranslation:function(h,j){var i=this._txf;if(i.tx!==h||i.ty!==j){i.tx=h;i.ty=j;this.notifyNative(g.TRANSFO)}},getTranslation:function(){return{x:this._txf.tx,y:this._txf.ty}},resetTransform:function(){this._style.transform=b.geom.Matrix.IDENTITY.clone();this._txf=this._style.transform;this.notifyNative(g.TRANSFO)},getTransformMatrix:function(){return this._txf.clone()},setTransformMatrix:function(h){this._txf.set(h);this.notifyNative(g.TRANSFO)},getGlobalTransformMatrix:function(){return this._safeGetGlobalTxf().clone()},getGlobalTransformMatrixInv:function(){return this._safeGetGlobalTxfInv().clone()},_safeGetGlobalTxfInv:function(){if(!this._globalTxfInv){this._globalTxfInv=this._safeGetGlobalTxf().inv()}return this._globalTxfInv},_safeGetGlobalTxf:function(){var h=this._globalTxf;if(!h){if(this.parentNode){h=this.parentNode._safeGetGlobalTxf();if(!this._txf.isIdentity()){h=h.clone();h._concat(this._txf)}}else{h=this._txf}this._globalTxf=h}return h},clearGlobalTransformMatrix:function(h){var i;if(this._globalTxf||this._globalTxfInv){this._globalTxf=undefined;this._globalTxfInv=undefined;i=this.firstChild;while(i){i.clearGlobalTransformMatrix(true);i=i.nextSibling}}this._clearGlobalTxfImpl(h)},_clearGlobalTxfImpl:function(h){},_transformCtrlPts:function(i,j){var h=this._getCtrlPts(j);if(h.length>0){if(j===b._BoundsType.RENDER){h=this._filterCtrlPts(h)}h=this._clipCtrlPts(h);if(i&&!i.isIdentity()){h=i.transformAll(h,[])}}return h},_filterCtrlPts:function(i){var h=i,k=this._filterFX,j;if(k){if(k.isInGlobalSpace){h=this._safeGetGlobalTxf().transformAll(i,[])}j=b.geom.computeBounds(h);j=this._filterFX._getFilteredBounds(j);h=b.geom.getBoxCtrlPts(j.x,j.y,j.width,j.height);if(k.isInGlobalSpace){h=this._safeGetGlobalTxfInv().transformAll(h)}}return h},_clipCtrlPts:function(i){var h=i,k=this._style.clip,j;if(k[2]>=0&&k[3]>=0){j=b.geom.computeBounds(h);j=b.geom.intersectRect(j,{x:k[0],y:k[1],width:k[2],height:k[3]});if(j){h=b.geom.getBoxCtrlPts(j.x,j.y,j.width,j.height)}else{h=[]}}return h},getLayoutBounds:function(i){this.layout();var h=this._txf;if(i&&i.getGlobalTransformMatrixInv){h=i.getGlobalTransformMatrixInv();h._concat(this._safeGetGlobalTxf())}return this._getBoundsImpl(h,b._BoundsType.LAYOUT)},getLocalBounds:function(){if(!this._localBoundsCache){this._localBoundsCache=b.geom.computeBounds(this._clipCtrlPts(this._getCtrlPts(b._BoundsType.RENDER)))}return this._localBoundsCache},_getBoundsImpl:function(h,i){return b.geom.computeBounds(this._transformCtrlPts(h,i))},getTransformToNode:function(k){var i=new b.geom.Matrix(),j,h;if(b.isA(k,b.graphics.AbstractGraphicNode)){j=this.getGlobalTransformMatrix();h=k.getGlobalTransformMatrixInv();i.concat(h);i.concat(j)}return i},_getCtrlPts:function(j){var h,i=this._ctrlPts;if(j!==b._BoundsType.LAYOUT||this._style.display){j=this._fixBoundsType(j);if(!i[j]){i[j]=this._computeCtrlPts(j)}h=i[j]}else{h=[]}return h},_fixBoundsType:function(h){return h},_clearCtrlPts:function(){this._ctrlPts.length=0;this._localBoundsCache=undefined;var h=this.parentNode;if(h&&h._ctrlPts.length>0){h._clearCtrlPts()}},localToGlobal:function(h,i){return this._safeGetGlobalTxf().transform(h,i)},globalToLocal:function(h,i){return this._safeGetGlobalTxfInv().transform(h,i)},hitTest:function(i,k){var h=null,j=this._style;if(j.display&&j.visibility&&j.pointerSensitivity){h=this._hitTest(i,k)}return h},_hitTest:function(h,j){var i=this.globalToLocal(h,j);return this._isWithinBounds(i.x,i.y)?this:null},_isWithinBounds:function(i,h,k){var j=this.getLocalBounds();if(typeof k!=="number"){k=0}return j!==undefined&&i>=j.x-k&&i<=j.x+j.width+k&&h>=j.y-k&&h<=j.y+j.height+k},_updateFilterFX:function(){if(!this._filterFXListener){this._filterFXListener=this._getFilterFXListener()}var h=this._style.filter,i=this._filterFX;if(i){i.removeEventListener(this._filterFXListener)}if(h){h.addEventListener(b.filters.FILTER_EVENT,this._filterFXListener)}this._filterFX=h},_getFilterFXListener:function(){var h=this;return function(){h.notifyNative(g.FILTER)}},_onCursorChanged:function(){var i=this,j=this._style.cursor,h;if(typeof j==="object"){this._customCursor=b.load(j.definition)}else{this._customCursor=null}if(this._customCursor){this._customCursor.setPointerSensitivity(false);if(!this._showCustomCursor){h=function(k){i._customCursor._setTranslation(k.clientX-j.hotspotX,k.clientY-j.hotspotY)};this._showCustomCursor=function(k){b.tree.userLayer.appendChild(i._customCursor);h(k);i.onMouseMove(h)};this._hideCustomCursor=function(){i.offMouseMove(h);b.tree.userLayer.removeChild(i._customCursor)}}this.onMouseOver(this._showCustomCursor);this.onMouseOut(this._hideCustomCursor)}else{this.offMouseOver(this._showCustomCursor);this.offMouseOut(this._hideCustomCursor)}},getPreferredLayoutBox:function(j){var i,l=this._style.display,h=this._style.layout,k;j=j||{};if(l){k=h.padding;if(h.preferredWidth>=0){j.width=h.preferredWidth}if(h.preferredHeight>=0){j.height=h.preferredHeight}if(j.width===undefined||j.height===undefined){i=this._getContentPreferredLayoutBox();if(j.width===undefined){j.width=i.width+k.lineBegin+k.lineEnd}if(j.height===undefined){j.height=i.height+k.top+k.bottom}}}else{j.width=0;j.height=0}return j},_getContentPreferredLayoutBox:function(){this.layout();var i={width:0,height:0},h=this._getBoundsImpl(this._txf,b._BoundsType.LAYOUT);if(h){i.width=h.width;i.height=h.height}return i},setLayoutBox:function(i,m,l,h){var k=this._style.layout.padding.lineBegin,j=this._style.layout.padding.top;if(b.layoutDir===b.RTL){k=this._style.layout.padding.lineEnd}this._layoutBox={x:i+k,y:m+j,width:l-this._style.layout.padding.lineBegin-this._style.layout.padding.lineEnd,height:h-j-this._style.layout.padding.bottom};if(this._layoutBox.width<0){this._layoutBox.width=0}if(this._layoutBox.height<0){this._layoutBox.height=0}if(!this._layoutDirty){if(!this._prevLayoutBox){this._layoutDirty=true}else{if(this._prevLayoutBox.width!==this._layoutBox.width||this._prevLayoutBox.height!==this._layoutBox.height){this._layoutDirty=true}else{if(this._prevLayoutBox.x!==this._layoutBox.x||this._prevLayoutBox.y!==this._layoutBox.y){this._layoutPosDirty=true}}}}this._prevLayoutBox=this._layoutBox;this.layout()},layout:function(){if(!this._layingOut){if(this._layoutDirty){this._layingOut=true;if(this._style.display){this._safeLayout()}this._layoutDirty=false;this._layoutPosDirty=false;this._layingOut=false}else{if(this._layoutPosDirty){this._layingOut=true;if(this._style.display){this._positionInLayoutBox()}this._layoutPosDirty=false;this._layingOut=false}}}},_safeLayout:function(){},_positionInLayoutBox:function(){var l=this._txf,j=this._layoutBox,k=this._style.layout,o,n,m,p,i,h;if(j){m=k.hAlign;i=l.tx;h=l.ty;p=this._getBoundsImpl(l,b._BoundsType.LAYOUT)||{x:i,y:h,width:0,height:0};if(k.xAnchor<0){o=k.hAlign}else{o=k.xAnchor}if(b.layoutDir===b.RTL){o=1-o;m=1-m}o*=p.width;if(k.yAnchor<0){n=k.vAlign}else{n=k.yAnchor}n*=p.height;this._setTranslation(i-o-p.x+j.x+m*j.width,h-n-p.y+j.y+k.vAlign*j.height)}},invalidateLayout:function(){if(this._layingOut!==true&&this._layoutDirty!==true){this._layoutDirty=true;this._layoutPosDirty=true;this._layoutBox=undefined;this._prevLayoutBox=undefined;if(this._ctrlPts.length>0){this._clearCtrlPts()}if(this.parentNode&&this.preventParentInvalidateLayout!==true){this.parentNode.invalidateLayout()}}},_onLayoutDirChanged:function(){this.invalidateLayout()}},eventsDef:[b.MouseEvents,b.KeyEvents,b.DragEvents,b.TouchEvents,b.GenericGestureEvents,b.GestureEvents,b.UIEvents]});b.addStyleSupport(b.graphics.AbstractGraphicNode,{transform:e.Matrix(b.geom.Matrix.IDENTITY,g.TRANSFO_SET),clip:e.ArrayOfType({type:Number},4,4,[0,0,-1,-1],g.CLIP,true),cursor:e.Cursor(b.CursorType.AUTO,g.CURSOR),description:e.String("",g.DESC),display:e.Boolean(true,g.DISPLAY),draggable:e.Boolean(false),filter:e.FilterEffect(null,g.FILTER),focusable:e.Boolean(false,g.FOCUSABLE),focusOutlineOffset:e.Number(2),layout:{hAlign:e.NumberInRange([0,1],b.NodeAlign.CENTER,g.LAYOUT),vAlign:e.NumberInRange([0,1],b.NodeAlign.CENTER,g.LAYOUT),hWeight:e.FinitePositiveNumber(0,g.LAYOUT),vWeight:e.FinitePositiveNumber(0,g.LAYOUT),xAnchor:e.FiniteNumber(-1,g.LAYOUT),yAnchor:e.FiniteNumber(-1,g.LAYOUT),padding:e.Padding(0,0,0,0,g.LAYOUT),preferredWidth:e.FiniteNumber(-1,g.PREF_SIZE),preferredHeight:e.FiniteNumber(-1,g.PREF_SIZE),isLayoutChild:e.Boolean(true,g.LAYOUT)},pointerSensitivity:e.Boolean(true,g.SENSITIVITY),tooltip:e.ObjectOfConstraint([function(h){return b.isA(h,String)||b.isA(h,b.graphics.AbstractGraphicNode)}],null,true,false),visibility:e.Boolean(true,g.VISIBILITY),cacheAsBitmap:e.Boolean(false)})}());(function(){var e=b.TAGS;b.mixin(b.graphics.AbstractGraphicNode,{notifyNativeImpl:function(g,f){if(g===e.CURSOR){if(this===b.events.cvGetLastTarget()){b.events.cvSetCursor(this)}}else{if(g!==e.SENSITIVITY&&g!==e.DESC){if(g!==e.TRANSFO){this.cvClearBuffer(!f)}if(!f){b.tree.cvMarkAsDirty(this)}}}},_clearGlobalTxfImpl:function(f){this.cvClearBuffer(!f)},cvPaint:function(m,n){var g=this._style,o,k,l,q,f,i,h=this._filterFX,j,p=b.tree.cvPixelRatio,r=true;if(this.cvIsInView()){q=this._safeGetGlobalTxf();f=this._getBoundsImpl(q,b._BoundsType.RENDER);if(f){r=false;n=b.geom.intersectRect(f,n,true);if(n){m.save();k=this.cvUseBuffer();if(k){i={x:Math.floor(f.x*p),y:Math.floor(f.y*p)}}l=this.cvBuffer;if(!l){if(k){i.width=Math.ceil(f.width*p);i.height=Math.ceil(f.height*p);l=b.tree.cvCreateBuffer(i.width,i.height);o=l.getContext("2d");o.translate(-i.x,-i.y);o.scale(p,p);o.transform(q.a,q.b,q.c,q.d,q.tx,q.ty)}else{o=m;q=this._txf;o.transform(q.a,q.b,q.c,q.d,q.tx,q.ty)}j=g.clip;if(j[2]>=0&&j[3]>=0){o.beginPath();o.rect(j[0],j[1],j[2],j[3]);o.clip()}this.cvPaintSelf(o,n);if(h){l=h.cvApplyFX(l,i)}this.cvBuffer=l}if(l){q=this.parentNode._safeGetGlobalTxfInv();m.transform(q.a,q.b,q.c,q.d,q.tx,q.ty);m.scale(1/p,1/p);this.cvPaintBuffer(m,l,i.x,i.y)}m.restore();this.cvLastDrawBounds=f}}}if(r){this.cvLastDrawBounds=undefined}},cvIsInView:function(){return this._style.display&&this._style.visibility},cvUseBuffer:function(){return(this._filterFX!==null)||this._style.cacheAsBitmap},cvClearBuffer:function(f){if(this.cvBuffer){b.tree.cvDisposeBuffer(this.cvBuffer);this.cvBuffer=undefined;b.tree.cvMarkAsDirty(this)}if(f&&this.parentNode){this.parentNode.cvClearBuffer(f)}},cvPaintSelf:function(){},cvPaintBuffer:function(g,h,f,i){g.drawImage(h,f,i)}})}());(function(){var f=b.graphics.AbstractGraphicNode.prototype,e=b.defs,g=b.TAGS;b.declare({name:"oui.graphics.AbstractShape",isAbstract:true,extend:b.graphics.AbstractGraphicNode,membersDef:{onStyleChanged:function(h){if(h===g.PAINT){this.notifyNative(h)}else{if(h===g.GEOM){this._clearCtrlPts();this.invalidateLayout();this.notifyNative(h)}else{f.onStyleChanged.call(this,h)}}},_fixBoundsType:function(i){var h=this._style;if(i===b._BoundsType.LAYOUT||(i===b._BoundsType.RENDER&&(h.stroke===b.NO_PAINT||h.strokeThickness===0))){i=b._BoundsType.DEFAULT}return i},getFillBounds:function(){return b.geom.computeBounds(this._clipCtrlPts(this._getCtrlPts(b._BoundsType.DEFAULT)))},_isValidChild:function(){return false},_safeLayout:function(){this._positionInLayoutBox()},_hitTest:function(i,m){var h=null,j=this._style,l=true,k;if(j.fill!==b.NO_PAINT){k=this.globalToLocal(i,m);if(this.hitTestOnFill(k.x,k.y)){h=this}else{l=false}}if(!h&&j.stroke!==b.NO_PAINT&&j.strokeThickness>0){k=k||this.globalToLocal(i,m);if(this.hitTestOnStroke(k.x,k.y,l)){h=this}}return h},hitTestOnFill:function(i,h){return false},hitTestOnStroke:function(j,i,h){return false}},styleDef:{htmlExportClassName:e.String(""),fill:e.Paint(b.black,g.PAINT),fillOpacity:e.NumberInRange([0,1],1,g.PAINT),fixedStrokeWidth:e.Boolean(false,g.PAINT),snapToGrid:e.Boolean(true,g.PAINT),stroke:e.Paint(b.NO_PAINT,g.PAINT),strokeOpacity:e.NumberInRange([0,1],1,g.PAINT),strokeThickness:e.FinitePositiveNumber(1,g.PAINT),strokeLineJoin:e.Enum(b.LineJoin,b.LineJoin.MITER,g.PAINT),strokeLineCap:e.Enum(b.LineCap,b.LineCap.BUTT,g.PAINT),strokeMiterLimit:e.FinitePositiveNumber(3,g.PAINT),strokeDashArray:e.ArrayOfType(e.StrictlyPositiveNumber(1),undefined,undefined,[],g.PAINT)}})}());(function(){var e=b.graphics.AbstractGraphicNode.prototype;b.mixin(b.graphics.AbstractShape,{notifyNativeImpl:function(h,f){var g=this._style;if(h===b.TAGS.PAINT){this.cvCheckPatternPaint(g.fill,"_cvPatternFill");this.cvCheckPatternPaint(g.stroke,"_cvPatternStroke")}e.notifyNativeImpl.call(this,h,f)},cvIsInView:function(){var f=this._style;return e.cvIsInView.call(this)&&((f.fill!==b.NO_PAINT&&f.fillOpacity>0)||(f.stroke!==b.NO_PAINT&&f.strokeOpacity>0&&f.strokeThickness>0))},cvSetFill:function(g){var f=this._style;g.globalAlpha=f.fillOpacity;g.fillStyle=f.fill.cvToStyle(this.getFillBounds(),g)},cvSetStroke:function(g){var f=this._style;g.globalAlpha=f.strokeOpacity;g.strokeStyle=f.stroke.cvToStyle(this.getLocalBounds(),g);g.lineWidth=f.strokeThickness;g.lineCap=f.strokeLineCap;g.lineJoin=f.strokeLineJoin;g.miterLimit=f.strokeMiterLimit;if(g.setLineDash){g.setLineDash(f.strokeDashArray)}},cvGetPatternReadyCallback:function(){var f=this;if(!this.cvPatternReadyCallback){this.cvPatternReadyCallback=function(){b.tree.cvMarkAsDirty(f)}}return this.cvPatternReadyCallback},cvCheckPatternPaint:function(h,g){var f=this[g];if(f&&f!==h){f.offPatternReady(this.cvGetPatternReadyCallback());this[g]=undefined}if(h.onPatternReady&&h!==f){h.onPatternReady(this.cvGetPatternReadyCallback());this[g]=h}}})}());(function(){var h="move",k="close",o="line",l="curve",j="quad",q=b.geom.DEG_TO_RAD,m=Math.PI/2,s={M:"moveTo",L:"lineTo",H:"horizontalLineTo",V:"verticalLineTo",Q:"quadTo",T:"smoothQuadTo",C:"curveTo",S:"smoothCurveTo",Z:"closePath",A:"arc",aM:"arcMoveTo",aL:"arcLineTo"},n,i={},f,g;b.graphics.PathType={MOVE_TO:h,CLOSE:k,LINE_TO:o,CURVE_TO:l,QUAD_TO:j};b.declare({name:"oui.graphics.PathCommands",mixins:[b.events.EventSupport],eventsDef:{DATA_UPDATE:"dataUpdate"},membersDef:{init:function(t,p){this._preventEvents=false;this.set(t,p)},_dispatchDataUpdate:function(){if(!this._preventEvents){this.dispatchEvent({type:this.events.DATA_UPDATE})}},set:function(t,p){this._preventEvents=true;this.resetPath();this._preventEvents=false;if(b.isA(t,String)){this._parseString(t,p)}this._dispatchDataUpdate()},resetPath:function(){this.dataTypes=[];this.dataValues=[];this.x=0;this.y=0;this.lastMX=0;this.lastMY=0;this.lastQX=0;this.lastQY=0;this.lastCX=0;this.lastCY=0;this._hasCubics=false;this._hasQuads=false;this._dispatchDataUpdate()},toString:function(A,D,v){var u=this.dataTypes,t=this.dataValues,C,w=u.length,E=[],B=0,I=(A===true)?" ":"",H,G="Z",x="M",y="L",p="Q",F="C";if(typeof D==="function"){H=D}else{if(typeof D==="number"){H=function(z){return z.toFixed(D)}}else{H=function(z){return z}}}if(v){G=v.CLOSE;x=v.MOVE_TO;y=v.LINE_TO;p=v.QUAD_TO;F=v.CURVE_TO}for(C=0;C<w;C++){switch(u[C]){case k:B+=2;E.push(G,I);break;case h:E.push(x,I,H(t[B++]),",",H(t[B++]),I);break;case o:E.push(y,I,H(t[B++]),",",H(t[B++]),I);break;case j:E.push(p,I,H(t[B++]),",",H(t[B++])," ",H(t[B++]),",",H(t[B++]),I);break;case l:E.push(F,I,H(t[B++]),",",H(t[B++])," ",H(t[B++]),",",H(t[B++])," ",H(t[B++]),",",H(t[B++]),I);break;default:break}}return b.trim(E.join(""))},isPointInPath:function(t,v,u){var p=this._countXings(t,v);if(u===b.WindingRuleEnum.NON_ZERO){p=(p!==0)}else{p=(p%2)!==0}return p},_isPointOnStrokedPath:function(I,G,F){var E=false,H=this.flatten(),A=H.dataTypes,u=H.dataValues,D,B=A.length,C=0,K=F*F,z=b.geom.ptSegDistSq,J,w,t,v,p;for(D=0;D<B&&!E;D++){J=A[D];if(J===h){v=u[C++];p=u[C++];E=(I===v&&G===p)}else{w=u[C++];t=u[C++];E=z(v,p,w,t,I,G)<K;v=w;p=t}}return E},_getStrokeCtrlPts:function(R){var ae=[],F=this.flatten(),z=F.dataTypes,y=F.dataValues,Z,Y=z.length,I,E=0,ah,ag,B,A,ac,ab,aa,v,p,V,U,af,X,ad,W,O,K,N,J,w,aj,t,ai,T,Q,S,P,M,H,L,G,D,x,C,u;for(Z=0;Z<Y;Z++){I=z[Z];if(I===h){w=aj=t=ai=T=Q=S=P=M=H=L=G=D=x=C=u=undefined;B=ac=y[E++];A=ab=y[E++];ae.push(B,A)}else{if(I===k){ah=ac;ag=ab}else{ah=y[E++];ag=y[E++]}v=ah-B;p=ag-A;V=R;if(v!==0||p!==0){U=v!==0?p/v:Number.POSITIVE_INFINITY;U=U>0?1:-1;V=V/Math.sqrt(v*v+p*p);v=U*v*V;p=U*p*V;af=B-p;X=A+v;ad=ah-p;W=ag+v;O=ah+p;K=ag-v;N=B+p;J=A-v;ae.push(af,X,ad,W,O,K,N,J);if(w!==undefined){ae.push.apply(ae,b.geom.intersectLine(af,X,ad,W,w,aj,t,ai));ae.push.apply(ae,b.geom.intersectLine(af,X,ad,W,T,Q,S,P));ae.push.apply(ae,b.geom.intersectLine(O,K,N,J,w,aj,t,ai));ae.push.apply(ae,b.geom.intersectLine(O,K,N,J,T,Q,S,P))}w=af;aj=X;t=ad;ai=W;T=O;Q=K;S=N;P=J}if(I===k&&M!==undefined){ae.push.apply(ae,b.geom.intersectLine(w,aj,t,ai,M,H,L,G));ae.push.apply(ae,b.geom.intersectLine(w,aj,t,ai,D,x,C,u));ae.push.apply(ae,b.geom.intersectLine(T,Q,S,P,M,H,L,G));ae.push.apply(ae,b.geom.intersectLine(T,Q,S,P,D,x,C,u))}B=ah;A=ag;if(aa===h){M=af;H=X;L=ad;G=W;D=O;x=K;C=N;u=J}}aa=I}return ae},flatten:function(x,t){var C,u,p,B,v,z,w,y,A;if(this._hasCubics||this._hasQuads){C=new b.graphics.PathCommands();if(typeof x!=="number"){x=5}u=this.dataTypes;p=this.dataValues;v=u.length;for(B=0,y=0,A=[];B<v;B++){switch(u[B]){case k:y+=2;C.closePath();break;case h:C._M(p[y++],p[y++]);break;case o:C._L(p[y++],p[y++]);break;case j:b.geom.flattenQuad(p[y-2],p[y-1],p[y++],p[y++],p[y++],p[y++],A,x,t);z=0;w=A.length;while(z<w){C._L(A[z++],A[z++])}A.length=0;break;case l:b.geom.flattenCubic(p[y-2],p[y-1],p[y++],p[y++],p[y++],p[y++],p[y++],p[y++],A,x,t);z=0;w=A.length;while(z<w){C._L(A[z++],A[z++])}A.length=0;break;default:break}}}else{C=this}return C},snap:function(D,v,E){var w=this.dataTypes,t=this.dataValues,I,H,u,p,G,F,C,J,B,A,z=w.length;if(typeof E!=="number"){E=0}if(v){C=v.inv()}for(B=0,A=0;B<z;B++){switch(w[B]){case h:case k:u=t[A++];p=t[A++];break;case o:I=G=t[A++];H=F=t[A++];if(v){J=v.transform(u,p);u=J.x;p=J.y;J=v.transform(I,H);I=J.x;H=J.y}if(Math.abs(I-u)<=E){if(D===true){u=Math.floor(u)+0.5}else{if(Math.floor(u)!==u){u=Math.round(u)}}if(C){t[A-4]=C.a*u+C.c*p+C.tx;t[A-2]=C.a*u+C.c*H+C.tx}else{t[A-4]=t[A-2]=u}}if(Math.abs(H-p)<=E){if(D===true){p=Math.floor(p)+0.5}else{if(Math.floor(p)!==p){p=Math.round(p)}}if(C){t[A-3]=C.b*u+C.d*p+C.ty;t[A-1]=C.b*I+C.d*p+C.ty}else{t[A-3]=t[A-1]=p}}u=G;p=F;break;case j:A+=2;u=t[A++];p=t[A++];break;case l:A+=4;u=t[A++];p=t[A++];break;default:break}}this._dispatchDataUpdate()},cubicify:function(){var v=this.dataTypes,t=this.dataValues,p,w=0,x=v.length,u;if(this._hasQuads){for(p=0;p<x;p++){switch(v[p]){case h:case k:case o:w+=2;break;case j:u=b.geom.quad2Cubic(t[w-2],t[w-1],t[w],t[w+1],t[w+2],t[w+3]);v[p]=l;t.splice(w,2,u[0],u[1],u[2],u[3]);w+=6;break;case l:w+=6;break}}this._hasQuads=false;this._dispatchDataUpdate()}},closePath:function(){this.dataTypes.push(k);this.dataValues.push(this.lastMX,this.lastMY);this.x=this.lastMX;this.y=this.lastMY;this._dispatchDataUpdate();return this},_safeMoveTo:function(p,u,t){if(t===true){p+=this.x;u+=this.y}this.dataTypes.push(h);this.dataValues.push(p,u);this.x=p;this.y=u;this.lastMX=p;this.lastMY=u;this.lastQX=p;this.lastQY=u;this.lastCX=p;this.lastCY=u;return this},_safeLineTo:function(p,u,t){if(t===true){p+=this.x;u+=this.y}this.dataTypes.push(o);this.dataValues.push(p,u);this.x=p;this.y=u;this.lastQX=p;this.lastQY=u;this.lastCX=p;this.lastCY=u;return this},_safeHorizontalLineTo:function(p,t){if(t===true){p+=this.x}return this._safeLineTo(p,this.y,false)},_safeVerticalLineTo:function(t,p){if(p===true){t+=this.y}return this._safeLineTo(this.x,t,false)},_safeQuadTo:function(t,v,p,u,w){if(w===true){t+=this.x;v+=this.y;p+=this.x;u+=this.y}this.dataTypes.push(j);this.dataValues.push(t,v,p,u);this.x=p;this.y=u;this.lastQX=t;this.lastQY=v;this.lastCX=p;this.lastCY=u;this._hasQuads=true;return this},_safeSmoothQuadTo:function(p,u,w){var t,v;if(w===true){p+=this.x;u+=this.y}t=2*this.x-this.lastQX;v=2*this.y-this.lastQY;return this._safeQuadTo(t,v,p,u,false)},_safeCurveTo:function(v,x,t,w,p,u,y){if(y===true){v+=this.x;x+=this.y;t+=this.x;w+=this.y;p+=this.x;u+=this.y}this.dataTypes.push(l);this.dataValues.push(v,x,t,w,p,u);this.x=p;this.y=u;this.lastQX=p;this.lastQY=u;this.lastCX=t;this.lastCY=w;this._hasCubics=true;return this},_safeSmoothCurveTo:function(t,w,p,v,y){var u,x;if(y===true){t+=this.x;w+=this.y;p+=this.x;v+=this.y}u=2*this.x-this.lastCX;x=2*this.y-this.lastCY;return this._safeCurveTo(u,x,t,w,p,v,false)},_safeArc:function(t,y,u,p,x,w,v){if(v===true){t+=this.x;y+=this.y}u=u*q;p=p*q;this._arcImpl(t,y,u,p,x,w);return this},_arcImpl:function(x,w,v,t,u,p){var A,z=0.523598775598,y=0.506145483078356;if(t>v){while(t-v>z){A=v+y;this._smallArcACW(x,w,v,A,u,p);v=A}this._smallArcACW(x,w,v,t,u,p)}else{if(v>t){while(v-t>z){A=v-y;this._smallArcCW(x,w,v,A,u,p);v=A}this._smallArcCW(x,w,v,t,u,p)}}},_smallArcACW:function(z,y,x,u,w,t){var B=w*Math.cos(u),A=t*Math.sin(u),C=Math.tan((u-x)/2),D=u-m,v=B+w*C*Math.cos(D),p=A+t*C*Math.sin(D);this._safeQuadTo(v+z,p+y,B+z,A+y)},_smallArcCW:function(B,A,z,w,y,v){var D=y*Math.cos(w),C=v*Math.sin(w),u=y*Math.cos(z),p=v*Math.sin(z),E=Math.tan((z-w)/2),F=(z-m),x=u+y*E*Math.cos(F),t=p+v*E*Math.sin(F);this._safeQuadTo(x+B,t+A,D+B,C+A)},_safeArcMoveTo:function(p,y,x,w,v,u){var t=x*q;return this._safeMoveTo(p+w*Math.cos(t),y+v*Math.sin(t),u)},_safeArcLineTo:function(p,y,x,w,v,u){var t=x*q;return this._safeLineTo(p+w*Math.cos(t),y+v*Math.sin(t),u)},_countXings:function(G,F){var E=b.geom,v=this.dataTypes,t=this.dataValues,w=v.length,A,B=0,u=0,p=0,I=0,H=0,z=0,D=false,C;for(C=0;C<w;C++){A=v[C];switch(A){case h:if(C>0&&v[C-1]!==k){z+=E.crossLine(u,p,I,H,G,F)}I=u=t[B++];H=p=t[B++];break;case k:case o:z+=E.crossLine(u,p,t[B++],t[B++],G,F);u=t[B-2];p=t[B-1];break;case j:z+=E.crossQuad(u,p,t[B++],t[B++],t[B++],t[B++],G,F);u=t[B-2];p=t[B-1];break;case l:z+=E.crossCubic(u,p,t[B++],t[B++],t[B++],t[B++],t[B++],t[B++],G,F);u=t[B-2];p=t[B-1];break}if(u===G&&p===F){z=0;D=true;break}}if(!D&&A!==k){z+=E.crossLine(u,p,I,H,G,F)}return z},_parseString:function(u,v){var t=0,y,x,z,w,p=Number;y=u.replace(/^\s+|\s+$/g,"").replace(/([mlhvcsqtz])/gi,",$1,").replace(/\s+/g,",").replace(/,{2,}/g,",").replace(/^,|,$/g,"").split(",");x=y.length;if(v===true){p=function(B){var A=Number(B);if(isNaN(A)){c.error("ERR__PATH__MALFORMED_DATA",y.slice(0,t).join(" "))}return A}}while(t<x){z=y[t++];w=false;switch(z){case"m":w=true;case"M":this._safeMoveTo(p(y[t++]),p(y[t++]),w);while(!isNaN(Number(y[t]))&&t<x){this._safeLineTo(p(y[t++]),p(y[t++]),w)}break;case"l":w=true;case"L":do{this._safeLineTo(p(y[t++]),p(y[t++]),w)}while(!isNaN(Number(y[t]))&&t<x);break;case"h":w=true;case"H":do{this._safeHorizontalLineTo(p(y[t++]),w)}while(!isNaN(Number(y[t]))&&t<x);break;case"v":w=true;case"V":do{this._safeVerticalLineTo(p(y[t++]),w)}while(!isNaN(Number(y[t]))&&t<x);break;case"q":w=true;case"Q":do{this._safeQuadTo(p(y[t++]),p(y[t++]),p(y[t++]),p(y[t++]),w)}while(!isNaN(Number(y[t]))&&t<x);break;case"t":w=true;case"T":do{this._safeSmoothQuadTo(p(y[t++]),p(y[t++]),w)}while(!isNaN(Number(y[t]))&&t<x);break;case"c":w=true;case"C":do{this._safeCurveTo(p(y[t++]),p(y[t++]),p(y[t++]),p(y[t++]),p(y[t++]),p(y[t++]),w)}while(!isNaN(Number(y[t]))&&t<x);break;case"s":w=true;case"S":do{this._safeSmoothCurveTo(p(y[t++]),p(y[t++]),p(y[t++]),p(y[t++]),w)}while(!isNaN(Number(y[t]))&&t<x);break;case"a":w=true;case"A":if(v===true){c.error("ERR__PATH__NO_ARCTO")}break;case"z":case"Z":this.closePath();break;default:if(v===true){c.error("ERR__PATH__UNKNOWN_CMD",[z,t])}}}}}});function e(t){var p=t.length-1;return function(){var v=p-1,u=true;do{u=b.isFiniteNumber(arguments[v])}while(v--&&u);if(u){t.apply(this,arguments);this._dispatchDataUpdate()}return this}}n=b.graphics.PathCommands.prototype;for(g in n){if(n.hasOwnProperty(g)&&g.indexOf("_safe")===0){i[g.charAt(5).toLowerCase()+g.substr(6)]=e(n[g])}}b.mixin(b.graphics.PathCommands,i);function r(t,p){return function(){var u=[];u.push.apply(u,arguments);u[t.length-1]=p;return t.apply(this,u)}}for(g in s){if(s.hasOwnProperty(g)){i=s[g];f=n[i];n[g]=r(f,false);n[g.toLowerCase()]=r(f,true);g="_"+g;i="_safe"+i.charAt(0).toUpperCase()+i.substr(1);f=n[i]||f;n[g]=r(f,false);n[g.toLowerCase()]=r(f,true)}}}());(function(){var e=b.graphics.AbstractShape.prototype;b.declare({name:"oui.graphics.AbstractPath",isAbstract:true,extend:b.graphics.AbstractShape,membersDef:{init:function(f,g){this._flattenedPathCache=null;e.init.call(this,f,g)},onStyleChanged:function(f){if(f===b.TAGS.GEOM){this._flattenedPathCache=null}e.onStyleChanged.call(this,f)},_computeCtrlPts:function(h){var g=this.getFlattenedPathCommands(),f=[];if(g){f=b.geom.computeConvexHull(h?g._getStrokeCtrlPts(this._style.strokeThickness/2):g.dataValues)}return f},hitTestOnFill:function(h,g){var f=false,i=this.getFlattenedPathCommands();if(i&&this._isWithinBounds(h,g)){f=i.isPointInPath(h,g,this.getWindingRule())}return f},hitTestOnStroke:function(i,h,g){var f=false,k=this._style.strokeThickness/2,j=this.getFlattenedPathCommands();if(j&&this._isWithinBounds(i,h,k)){f=j._isPointOnStrokedPath(i,h,k)}return f},getPathCommands:function(){c.warn("WARN__PATH__NO_OVERRIDE");return null},getFlattenedPathCommands:function(){var f;if(!this._flattenedPathCache){f=this.getPathCommands();if(f){this._flattenedPathCache=f.flatten(10)}}return this._flattenedPathCache},getWindingRule:function(){return b.WindingRuleEnum.EVEN_ODD}}})}());(function(){var i=b.graphics.PathType,f=i.MOVE_TO,e=i.LINE_TO,g=i.QUAD_TO,h=i.CURVE_TO,j=i.CLOSE;b.mixin(b.graphics.AbstractPath,{cvPaintSelf:function(t,r){var s=this.getPathCommands(),p=0,m,l,q,o,k;if(s){m=s.dataTypes;l=s.dataValues;o=m.length;t.beginPath();for(q=0;q<o;q++){switch(m[q]){case f:t.moveTo(l[p++],l[p++]);break;case e:t.lineTo(l[p++],l[p++]);break;case g:t.quadraticCurveTo(l[p++],l[p++],l[p++],l[p++]);break;case h:t.bezierCurveTo(l[p++],l[p++],l[p++],l[p++],l[p++],l[p++]);break;case j:p+=2;t.closePath();break;default:c.error("ERR__CNV__INV_PATHDATA");break}}k=this._style;if(k.fill!==b.NO_PAINT){this.cvSetFill(t);t.fill()}if(k.stroke!==b.NO_PAINT){this.cvSetStroke(t);t.stroke()}}}})}());(function(){var h=b.graphics.AbstractPath.prototype,e=b.defs,i=b.TAGS,g={markerStart:0,markerEnd:1,markerMid:2},f="pathData";b.declare({name:"oui.graphics.Path",extend:b.graphics.AbstractPath,jsonDef:{type:"path"},membersDef:{init:function(j,k){var l=this;this._markers=[];this._initImpl();this._oldPC=null;this._dataUpdateHandler=function(){l._updateMarkerTxf("markerStart",g.markerStart);l._updateMarkerTxf("markerEnd",g.markerEnd);l.onStyleChanged(b.TAGS.GEOM)};h.init.call(this,j,k)},_initImpl:function(){},_computeCtrlPts:function(m){var k=h._computeCtrlPts.call(this,m),o=this._markers,j,l,p=0;if(k.length>0){for(l=0,p=o.length;l<p;l++){j=o[l];if(j){k.push.apply(k,j._transformCtrlPts(j._txf,m))}}}return p>0?b.geom.computeConvexHull(k):k},onStyleChanged:function(k){var p=this._style,m=p.pathCommands,l,q=this._markers,o,r,j;if(k===f){l=this._oldPC;if(l){l.offDataUpdate(this._dataUpdateHandler)}if(m){m.onDataUpdate(this._dataUpdateHandler)}this._oldPC=m;this._updateMarker("markerStart",g.markerStart);this._updateMarker("markerEnd",g.markerEnd);h.onStyleChanged.call(this,i.GEOM)}else{if(k===i.PAINT){for(o=0,r=q.length;o<r;o++){if(q[o]){q[o].applyStyle({fill:p.stroke,fillOpacity:p.strokeOpacity})}}h.onStyleChanged.call(this,k)}else{if(k===i.MARKER_START_DATA||k===i.MARKER_END_DATA){j=k.substring(0,k.length-4);this._updateMarker(j,g[j]);this.notifyNative(k)}else{if(k===i.MARKER_START||k===i.MARKER_END){this._updateMarkerTxf(k,g[k]);this.notifyNative(k)}else{if(k===i.MARKER_START_PAINT||k===i.MARKER_END_PAINT){j=k.substring(0,k.length-5);this._updateMarkerPaint(j,g[j]);this.notifyNative(k)}else{h.onStyleChanged.call(this,k)}}}}}},_updateMarker:function(k,j){var n=this._style,m=n[k],l=this._markers[j];if(m.d.length===0){this._markers[j]=undefined}else{if(!l){this._markers[j]=new b.graphics.Path({pathCommands:m.d})}else{l.applyStyle({pathCommands:m.d})}this._updateMarkerPaint(k,j);this._updateMarkerTxf(k,j)}},_updateMarkerTxf:function(o,w){var k=this._style[o],m=this._markers[w],t=this._style.pathCommands,j,l,v,r,q=0,p=0,z=k.strokeUnits?this._style.strokeThickness:1,u=k.orient;if(m&&t&&t.dataValues.length>=2){j=t.dataValues;l=j.length;if(w===g.markerStart){v=j[0];r=j[1];if(l>=4){q=j[2]-v;p=j[3]-r}}else{if(w===g.markerEnd){v=j[l-2];r=j[l-1];if(l>=4){q=v-j[l-4];p=r-j[l-3]}}}if(u===b.AUTO){u=Math.atan2(p,q)}else{u*=b.geom.DEG_TO_RAD}m.setTransform(new b.geom.Matrix().translate(v,r).rotate(u).scale(z*k.width,z*k.height).translate(-k.refX,-k.refY))}this._clearCtrlPts()},_updateMarkerPaint:function(k,j){var m=this._style,n={fill:m.stroke,fillOpacity:m.strokeOpacity,stroke:b.NO_PAINT},l=this._markers[j];if(l){b.merge(n,m[k].paint,true);l.applyStyle(n)}}},styleDef:{pathCommands:e.PathData(null,f),windingRule:e.Enum(b.WindingRuleEnum,b.WindingRuleEnum.EVEN_ODD,i.GEOM),markerStart:e.Marker("",0,0,1,1,b.AUTO,true,{},i.MARKER_START,i.MARKER_START_DATA,i.MARKER_START_PAINT),markerEnd:e.Marker("",0,0,1,1,b.AUTO,true,{},i.MARKER_END,i.MARKER_END_DATA,i.MARKER_END_PAINT)}})}());(function(){var e=b.graphics.AbstractPath.prototype;b.mixin(b.graphics.Path,{cvPaintSelf:function(o,k){var g=this._style.pathCommands,l=this._markers,f,j,h,m;e.cvPaintSelf.call(this,o,k);if(g&&g.dataTypes.length>0){for(h=0,m=l.length;h<m;h++){f=l[h];if(f){o.save();j=f._txf;o.transform(j.a,j.b,j.c,j.d,j.tx,j.ty);f.cvPaintSelf(o,k);o.restore()}}}}})}());(function(){var g=b.graphics.AbstractPath.prototype,e=b.defs,h=b.TAGS.GEOM,f;f=function(j,i){if(j>i){j=i}return j};b.declare({name:"oui.graphics.HalfRoundedRectangle",extend:b.graphics.AbstractPath,jsonDef:{type:"hrrect"},membersDef:{init:function(i,j){this._d=new b.graphics.PathCommands();g.init.call(this,i,j)},onStyleChanged:function(i){if(i===h){this._updatePath()}g.onStyleChanged.call(this,i)},getPathCommands:function(){return this._d},_onLayoutDirChanged:function(){this._updatePath();g._onLayoutDirChanged.call(this)},_updatePath:function(){var p=this._style,s=p.x,q=p.y,t=p.width,B=p.height,o=p.rx,m=p.ry,z=p.rounded,D=this._d,C=(b.layoutDir===b.LTR),n=!C,l=(C&&z.topLineBegin)||(n&&z.topLineEnd),i=(C&&z.topLineEnd)||(n&&z.topLineBegin),j=(C&&z.bottomLineBegin)||(n&&z.bottomLineEnd),E=(C&&z.bottomLineEnd)||(n&&z.bottomLineBegin),k=f(o,(l&&i)?t/2:t),A=f(m,(l&&j)?B/2:B),v=f(o,(j&&E)?t/2:t),u=f(m,(i&&E)?B/2:B);D.resetPath();if(l){D._M(s,q+A)._Q(s,q,s+k,q)}else{D._M(s,q)}if(i){D._L(s+t-k,q)._Q(s+t,q,s+t,q+u)}else{D._L(s+t,q)}if(E){D._L(s+t,q+B-u)._Q(s+t,q+B,s+t-v,q+B)}else{D._L(s+t,q+B)}if(j){D._L(s+v,q+B)._Q(s,q+B,s,q+B-A)}else{D._L(s,q+B)}D._Z()},hitTestOnFill:function(i,M){var I=this._style,z=i,v=M,B=I.width,H=I.height,t=I.rx,q=I.ry,p=I.x,E=I.y,u=E+H,K=p+B,A=false,F,J,s,o,k,j,L,m,G,D,C,n,l;if(z>=p&&z<=K&&v>=E&&v<=u){F=I.rounded;J=(b.layoutDir===b.LTR);s=!J;o=(J&&F.topLineBegin)||(s&&F.topLineEnd);k=(J&&F.topLineEnd)||(s&&F.topLineBegin);j=(J&&F.bottomLineBegin)||(s&&F.bottomLineEnd);L=(J&&F.bottomLineEnd)||(s&&F.bottomLineBegin);m=f(t,(o&&k)?B/2:B);G=f(q,(o&&j)?H/2:H);D=f(t,(j&&L)?B/2:B);C=f(q,(k&&L)?H/2:H);if(o&&(z<p+m)&&(v<E+G)){n=p+m;l=E+G;t=m;q=G}else{if(k&&(z>K-m)&&(v<E+C)){n=K-m;l=E+C;t=m;q=C}else{if(L&&(z>K-D)&&(v>u-C)){n=K-D;l=u-C;t=D;q=C}else{if(j&&(z<p+D)&&(v>u-G)){n=p+D;l=u-G;t=D;q=G}}}}if(n!==undefined&&l!==undefined){z=(i-n)/t;v=(M-l)/q;A=((z*z+v*v)<=1)}else{A=true}}return A}},styleDef:{x:e.FiniteNumber(0,h),y:e.FiniteNumber(0,h),width:e.PositiveNumber(0,h),height:e.PositiveNumber(0,h),rx:e.PositiveNumber(10,h),ry:e.PositiveNumber(10,h),rounded:{topLineBegin:e.Boolean(true,h),topLineEnd:e.Boolean(true,h),bottomLineBegin:e.Boolean(false,h),bottomLineEnd:e.Boolean(false,h)}}})}());(function(){var h=b.graphics.AbstractPath.prototype,e=b.defs,i=b.TAGS.GEOM,f=b.geom.DEG_TO_RAD;function g(j){if(j<0){j=360+j}return j}b.declare({name:"oui.graphics.DiskSector",extend:b.graphics.AbstractPath,jsonDef:{type:"diskSector"},membersDef:{init:function(j,k){this._d=new b.graphics.PathCommands();h.init.call(this,j,k)},onStyleChanged:function(j){if(j===i){this._updatePath()}h.onStyleChanged.call(this,j)},getPathCommands:function(){return this._d},_updatePath:function(){var k=this._style,o=this._d,j=k.cx,q=k.cy,n=k.minAngle,p=k.maxAngle,m=k.minRadius,l=k.maxRadius;o.resetPath();o._aM(j,q,n,l,l);o._A(j,q,n,p,l,l);if((p-n)<360){o._aL(j,q,p,m,m);if(m>0){o._A(j,q,p,n,m,m)}}else{if(m>0){o._Z();o._aM(j,q,p,m,m);o._A(j,q,p,n,m,m)}}o._Z()},hitTestOnFill:function(o,n){var k=this._style,s=false,r=o-k.cx,q=n-k.cy,p=Math.sqrt(r*r+q*q),l,j,m;if(p>=k.minRadius&&p<=k.maxRadius){l=k.minAngle;j=k.maxAngle;if(Math.abs(j-l)===360){s=true}else{m=Math.atan2(q,r)*180/Math.PI;m=(m+360)%360;if(l>j){l=j;j=k.minAngle}if(l<0&&j>=0){l=(l+360)%360;s=(m<=360&&m>=l)||m<=j}else{if(l<0&&j<0){l=(l+360)%360;j=(j+360)%360;s=m>=l&&m<=j}else{l=(l+360)%360;j=(j+360)%360;s=m>=l&&m<=j}}}}return s},getInsideGeomPath:function(M){var N=this._style,V=new b.graphics.PathCommands(),H=M/2,I=N.minAngle,O=N.maxAngle,n=N.minRadius,C=N.maxRadius,q,Z,l,w,u,v,B,T,k,K,Q,P,A,r,J,D,j,m,z,E,W,U,S,R,p,o,Y,X,G,F,L,y,x;if(n>C){n=C;C=N.minRadius}if(I>O){I=N.maxAngle;O=N.minAngle}q=f*(O-I);Z=Math.cos(q/2);l=Math.sin(q);w=N.cx;u=N.cy;v=Math.sin(f*I);B=Math.cos(f*I);T=Math.sin(f*O);k=Math.cos(f*O);K=0;if(l!==0){K=M*Z/l}Q=f*(I+(O-I)/2);P=w+K*Math.cos(Q);A=u+K*Math.sin(Q);r=n-K*Z+H;J=r+C-n-M;D=(J+r)/2;C-=H;n+=H;if(r<J){R={x:P+r*B,y:A+r*v};S={x:P+J*B,y:A+J*v};U={x:P+J*k,y:A+J*T};W={x:P+r*k,y:A+r*T};j=g(Math.atan2(R.y-u,R.x-w)/f);m=g(Math.atan2(W.y-u,W.x-w)/f);z=g(Math.atan2(S.y-u,S.x-w)/f);E=g(Math.atan2(U.y-u,U.x-w)/f);if(j>m){m+=360}if(z>E){E+=360}if((E-j)<q/f){if((m-j)>q/f){p=(U.x-W.x);o=(U.y-W.y);Y=(R.x-S.x);X=(R.y-S.y);G=(W.x-S.x);F=(W.y-S.y);L=(p*F-o*G)/(p*X-o*Y);y=S.x+L*Y;x=S.y+L*X;V._M(S.x,S.y)._L(y,x)._L(U.x,U.y);V._A(w,u,E,z,C,C);V._Z()}else{if(O-I<360){V._aM(P,A,O,D,D);V._aL(P,A,O,J,J);V._A(w,u,E,z,C,C);V._aL(P,A,I,r,r);if(n>H){V._A(w,u,j,m,n,n)}V._aL(P,A,O,D,D);V._Z()}else{V._aM(w,u,0,C,C);V._A(w,u,0,360,C,C);if(n>H){V._aM(w,u,360,n,n);V._A(w,u,360,0,n,n)}}}}}return V}},styleDef:{minAngle:e.FiniteNumber(0,i),maxAngle:e.FiniteNumber(360,i),minRadius:e.FinitePositiveNumber(0,i),maxRadius:e.FinitePositiveNumber(100,i),cx:e.Number(0,i),cy:e.Number(0,i)}})}());(function(){var e=b.graphics.AbstractGraphicNode.prototype;b.declare({name:"oui.graphics.Group",extend:b.graphics.AbstractGraphicNode,jsonDef:{type:"group",factory:function(h,j,g,i){var f=new b.graphics.Group(h,h.name);b.load(h.children,f,j,g,i);return f}},membersDef:{onStyleChanged:function(f){if(f===b.TAGS.OPACITY){this.notifyNative(f)}else{e.onStyleChanged.call(this,f)}},_computeCtrlPts:function(h){var f,i,g;if(h===b._BoundsType.LAYOUT){f=this._computeLayoutCtrlPts(h)}else{f=[];i=this.firstChild;while(i){g=i._transformCtrlPts(i._txf,h);f.push.apply(f,g);i=i.nextSibling}f=b.geom.computeConvexHull(f)}return f},_computeLayoutCtrlPts:function(h){var f=[],i=this.firstChild,g;while(i){if(i._style.layout.isLayoutChild){g=i._transformCtrlPts(i._txf,h);f.push.apply(f,g)}i=i.nextSibling}return b.geom.computeConvexHull(f)},_safeLayout:function(){var f=this.firstChild;while(f){f.layout();f=f.nextSibling}this._positionInLayoutBox()},_hitTest:function(g,j){var f=null,h=this.globalToLocal(g,j),i;if(this._isWithinBounds(h.x,h.y)){i=this.lastChild;while(i&&!f){f=i.hitTest(g,j);i=i.previousSibling}}return f}},styleDef:{opacity:b.defs.NumberInRange([0,1],1,b.TAGS.OPACITY)}})}());(function(){var e=b.graphics.AbstractGraphicNode.prototype;b.mixin(b.graphics.Group,{cvIsInView:function(){return e.cvIsInView.call(this)&&this.firstChild!==null},cvUseBuffer:function(){return e.cvUseBuffer.call(this)||this._style.opacity<1},cvPaintSelf:function(f,g){var h=this.firstChild;while(h){h.cvPaint(f,g);h=h.nextSibling}},cvPaintBuffer:function(g,h,f,i){if(this._style.opacity<1){g.globalAlpha=this._style.opacity}e.cvPaintBuffer.call(this,g,h,f,i)}})}());(function(){var f=b.graphics.AbstractGraphicNode.prototype,e=b.defs,g=b.TAGS;b.declare({name:"oui.graphics.Image",extend:b.graphics.AbstractGraphicNode,jsonDef:{type:"image"},membersDef:{init:function(h,i){this._srcWidth=0;this._srcHeight=0;this._actualWidth=0;this._actualHeight=0;f.init.call(this,h,i)},onStyleChanged:function(h){if(h===g.SRC){var i=this._style.src;if(this.prevRequest){b.resourcesManager.removeObserver(this.prevRequest,this);this.prevRequest=null}else{if(this.imageLoader){this.imageLoader.offComplete(this);this.imageLoader=null}}if(b.resourcesManager.hasResource(i)){b.resourcesManager.requestResource(i,this);this.prevRequest=i}else{this.imageLoader=new b.utils.ImageLoader();this.imageLoader.onComplete(this);this.imageLoader.load(i)}}else{if(h===g.GEOM){this._updateActualDimensions();this._clearCtrlPts();this.invalidateLayout();this.notifyNative(h)}else{if(h===g.OPACITY){this.notifyNative(h)}else{f.onStyleChanged.call(this,h)}}}},resourceUpdate:function(h){this._srcWidth=h.width;this._srcHeight=h.height;this._updateActualDimensions();this._resourceUpdateImpl(h)},handleEvent:function(h){this.resourceUpdate(h)},_resourceUpdateImpl:function(h){},_fixBoundsType:function(){return b._BoundsType.DEFAULT},_computeCtrlPts:function(){var h=this._style;return b.geom.getBoxCtrlPts(h.x,h.y,this._actualWidth,this._actualHeight)},_safeLayout:function(){this._positionInLayoutBox()},toDataURL:function(){var i,h=this._style.src;if(b.resourcesManager.hasResource(h)){i=b.resourcesManager._getBase64Data(h)}if(i===undefined){i=this._toDataURLImpl()}if(i===undefined){i=h}return i},_toDataURLImpl:function(){},_isValidChild:function(){return false},_updateActualDimensions:function(){var h=this._style,j=h.preserveAspectRatio,n=this._srcWidth,q=this._srcHeight,l=h.width,k=h.height,i=(l===b.AUTO)?n:l,p=(k===b.AUTO)?q:k,o,m;o=n>0?i/n:1;m=q>0?p/q:1;if(j===b.PreserveAspectRatioEnum.MIN){if(o<m){if(n>0){p=q*o}}else{if(q>0){i=n*m}}}else{if(j===b.PreserveAspectRatioEnum.MAX){if(o<m){if(q>0){i=n*m}}else{if(n>0){p=q*o}}}}if(this._actualWidth!==i||this._actualHeight!==p){this._actualWidth=i;this._actualHeight=p;this._clearCtrlPts();this.invalidateLayout()}}},styleDef:{src:{type:String,constraint:b.isStringNotEmpty,defaultValue:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAEklEQVR4nGNgGAWjYBSMAggAAAQQAAFVN1rQAAAAAElFTkSuQmCC",tag:g.SRC},x:e.FiniteNumber(0,g.GEOM),y:e.FiniteNumber(0,g.GEOM),width:e.Size(b.AUTO,g.GEOM),height:e.Size(b.AUTO,g.GEOM),opacity:e.NumberInRange([0,1],1,g.OPACITY),preserveAspectRatio:e.Enum(b.PreserveAspectRatioEnum,b.PreserveAspectRatioEnum.NONE,g.GEOM)}})}());(function(){b.mixin(b.graphics.Image,{_resourceUpdateImpl:function(e){this.cvImage=e.data;this.cvClearBuffer(true);b.tree.cvMarkAsDirty(this)},_toDataURLImpl:function(){var i,g,f;if(this.cvImage){g=b.tree.cvCreateBuffer(this._srcWidth,this._srcHeight);f=g.getContext("2d");f.drawImage(this.cvImage,0,0);try{i=g.toDataURL()}catch(h){c.warn(h);i=undefined}b.tree.cvDisposeBuffer(g)}return i},cvPaintSelf:function(e,f){var g;if(this.cvImage){g=this._style;if(g.opacity<1){e.globalAlpha=g.opacity}e.drawImage(this.cvImage,g.x,g.y,this._actualWidth,this._actualHeight)}}})}());(function(){var e=b.defs,f=b.TAGS.GEOM;b.declare({name:"oui.graphics.Line",extend:b.graphics.AbstractShape,jsonDef:{type:"line"},membersDef:{_computeCtrlPts:function(k){var i=[],j=this._style,h=j.x1,g=j.x2,n=j.y1,l=j.y2,q=j.strokeThickness,s=j.strokeLineCap,r,p,o,m;if(k){o=q/2;if(s===b.LineCap.SQUARE){m=Math.atan2(l-n,g-h);r=o*Math.cos(m);p=o*Math.sin(m);h-=r;g+=r;n-=p;l+=p}r=g-h;p=l-n;if(s!==b.LineCap.ROUND){if(r!==0||p!==0){o=o/Math.sqrt(r*r+p*p);r=r*o;p=p*o;i.push(h-p,n+r,g-p,l+r,g+p,l-r,h+p,n-r)}else{if(s===b.LineCap.SQUARE){i.push(h-o,n-o,h+o,n-o,h+o,n+o,h-o,n+o)}else{if(s===b.LineCap.BUTT){i.push(h,n)}}}}else{i.push(h-o,n-o,h+o,n+o,h+o,n+o,h+o,n-o,g-o,l-o,g+o,l+o,g+o,l+o,g+o,l-o)}}else{i.push(h,n);if(h!==g||n!==l){i.push(g,l)}}return i},hitTestOnStroke:function(k,j,q){var r=k,n=j,h=this._style,t=h.strokeLineCap,l=h.strokeThickness/2,s=l*l,i=h.x1,p=h.y1,g=h.x2,m=h.y2,w=false,o,v,u;if(t===b.LineCap.SQUARE){o=Math.atan2(m-p,g-i);v=l*Math.cos(o);u=l*Math.sin(o);i-=v;g+=v;p-=u;m+=u}w=b.geom.ptSegDistSq(i,p,g,m,r,n)<=s;if(t!==b.LineCap.ROUND){w=w&&b.geom.dotprod(g-i,m-p,r-i,n-p)>=0&&b.geom.dotprod(g-i,m-p,g-r,m-n)>=0}return w}},styleDef:{x1:e.FiniteNumber(0,f),y1:e.FiniteNumber(0,f),x2:e.FiniteNumber(0,f),y2:e.FiniteNumber(0,f)}})}());(function(){b.mixin(b.graphics.Line,{cvPaintSelf:function(e,f){var g=this._style;if(g.stroke!==b.NO_PAINT){this.cvSetStroke(e);e.beginPath();e.moveTo(g.x1,g.y1);e.lineTo(g.x2,g.y2);e.stroke()}}})}());(function(){var f=b.geom.isPointInEllipse,g=(Math.sqrt(2)-1)/2,e=b.defs,h=b.TAGS.GEOM;b.declare({name:"oui.graphics.Ellipse",extend:b.graphics.AbstractShape,jsonDef:{type:"ellipse"},membersDef:{_computeCtrlPts:function(p){var l,m=this._style,o=m.cx,n=m.cy,j=m.width,s=m.height,q,i,k,r,u,t;if(p){j+=m.strokeThickness;s+=m.strokeThickness}q=n-s/2;i=n+s/2;k=o-j/2;r=o+j/2;if(j===0&&s===0){l=[o,n]}else{if(j===0){l=[o,q,o,i]}else{if(s===0){l=[k,n,r,n]}else{u=j*g;t=s*g;l=[k,n-t,o-u,q,o+u,q,r,n-t,r,n+t,o+u,i,o-u,i,k,n+t]}}}return l},hitTestOnFill:function(j,i){var k=this._style;return f(j,i,k.cx,k.cy,k.width/2,k.height/2)},hitTestOnStroke:function(n,m,q){var j=this._style,r=n,p=m,o=j.cx,l=j.cy,k=j.width/2,i=j.height/2,s=j.strokeThickness/2;q=(q!==false);return f(r,p,o,l,k+s,i+s)&&!(q&&f(r,p,o,l,k-s,i-s))}},styleDef:{cx:e.FiniteNumber(0,h),cy:e.FiniteNumber(0,h),width:e.FinitePositiveNumber(0,h),height:e.FinitePositiveNumber(0,h)}})}());(function(){var f=new b.graphics.PathCommands(),g=new b.graphics.Path({pathCommands:f}),e=2*Math.PI;b.mixin(b.graphics.Ellipse,{cvPaintSelf:function(n,i){var j=this._style,h=j.cx,m=j.cy,l=j.width/2,k=j.height/2;if(l===k){n.beginPath();n.arc(h,m,l,0,e,false);n.closePath();if(j.fill!==b.NO_PAINT){this.cvSetFill(n);n.fill()}if(j.stroke!==b.NO_PAINT){this.cvSetStroke(n);n.stroke()}}else{f.resetPath();f._safeMoveTo(h+l,m)._safeArc(h,m,0,360,l,k).closePath();g.applyStyle(j);g.cvPaintSelf(n,i)}}})}());(function(){var g=b.geom.isPointInEllipse,f=b.geom.isPointInTriangle,e=b.defs,h=b.TAGS.GEOM;b.declare({name:"oui.graphics.Rectangle",extend:b.graphics.AbstractShape,jsonDef:{type:"rect"},membersDef:{_computeCtrlPts:function(n){var l=this._style,k=l.strokeThickness,j=l.x,o=l.y,m=l.width,i=l.height;if(n){j-=k/2;o-=k/2;m+=k;i+=k}return b.geom.getBoxCtrlPts(j,o,m,i)},hitTestOnFill:function(s,o){var k=this._style,w=s,u=o,p=k.x,z=k.y,v=z+k.height,i=p+k.width,m=k.rx,j=k.ry,q,n,A;A=(w>=p&&w<=i&&u>=z&&u<=v);if(A&&m!==0&&j!==0){if(w<p+m){q=p+m}else{if(w>i-m){q=i-m}}if(u<z+j){n=z+j}else{if(u>v-j){n=v-j}}if(q!==undefined&&n!==undefined){A=g(w,u,q,n,m,j)}}return A},hitTestOnStroke:function(i,K,J){var v=false,s=i,p=K,E=this._style,I=E.strokeThickness/2,C=E.x,w=E.y,H=w+E.height,z=C+E.width,n=E.rx,m=E.ry,G=(n!==0&&m!==0),o=E.strokeLineJoin,k,j,B=(G&&n>I)?n:I,A=(G&&m>I)?m:I,u,q,F,D;J=(J!==false);v=(s>=C-I&&s<=z+I&&p>=w-I&&p<=H+I);v=v&&!(J&&((s>=C+B&&s<=z-B&&p>=w+I&&p<=H-I)||(G&&s>=C+I&&s<=z-I&&p>=w+A&&p<=H-A)));if(v){if(G||o===b.LineJoin.ROUND){if(s<C+n){k=C+n}else{if(s>z-n){k=z-n}}if(p<w+m){j=w+m}else{if(p>H-m){j=H-m}}if(k!==undefined&&j!==undefined){v=g(s,p,k,j,n+I,m+I);if(v&&J&&G&&n>I&&m>I){v=!g(s,p,k,j,n-I,m-I)}}}else{if(o===b.LineJoin.BEVEL){if(s<C){u=C-I;F=C;k=C}else{if(s>z){u=z+I;F=z;k=z}}if(p<w){q=w;D=w-I;j=w}else{if(p>H){q=H;D=H+I;j=H}}if(k!==undefined&&j!==undefined){v=f(s,p,u,q,F,D,k,j)}}}}return v}},styleDef:{x:e.FiniteNumber(0,h),y:e.FiniteNumber(0,h),width:e.FinitePositiveNumber(0,h),height:e.FinitePositiveNumber(0,h),rx:e.FinitePositiveNumber(0,h),ry:e.FinitePositiveNumber(0,h)}})}());(function(){var e=new b.graphics.HalfRoundedRectangle({rounded:{topLineBegin:true,topLineEnd:true,bottomLineBegin:true,bottomLineEnd:true}});b.mixin(b.graphics.Rectangle,{cvPaintSelf:function(f,g){var h=this._style;if(h.rx===0&&h.ry===0){if(h.fill!==b.NO_PAINT){this.cvSetFill(f);f.fillRect(h.x,h.y,h.width,h.height)}if(h.stroke!==b.NO_PAINT){this.cvSetStroke(f);f.strokeRect(h.x,h.y,h.width,h.height)}}else{e.applyStyle(h);e.cvPaintSelf(f)}}})}());(function(){var e=b.defs,i=b.TAGS.GEOM,g=b.TextAlignEnum,f=b.GENERIC_FONTS;function h(j){j=j.toLowerCase();return j.indexOf(" ")>=0&&j[0]!=="'"&&j!==f.SERIF&&j!==f.SANS_SERIF&&j!==f.CURSIVE&&j!==f.MONOSPACE}b.declare({name:"oui.graphics.Text",extend:b.graphics.AbstractShape,jsonDef:{type:"text"},membersDef:{_computeCtrlPts:function(){var k=this._style,l,o,n,m,j,p;if(k.textValue.length>0){p=this._getBBoxImpl();if(!p){m=k.fontSize*k.textValue.length/2;j=k.fontSize;o=k.x;if(k.textAlign===g.CENTER){o-=m/2}else{if((b.layoutDir===b.LTR&&k.textAlign===g.LINE_END)||(b.layoutDir===b.RTL&&k.textAlign===g.LINE_BEGIN)){o-=m}}n=k.y-j}else{m=p.width;j=p.height;o=p.x;n=p.y}l=b.geom.getBoxCtrlPts(o,n,m,j)}else{l=[k.x,k.y]}return l},hitTestOnFill:function(k,j){return this._isWithinBounds(k,j)},getBaselineYAnchor:function(){var k=this._style,j=k.layout.yAnchor,l=this._getBBoxImpl();if(l){j=(k.y-l.y)/l.height}return j},_getXAlignOffset:function(l){var k=0,j=(b.layoutDir===b.LTR);switch(this._style.textAlign){case g.JUSTIFY:c.warn("WARN__TEXT__NO_JUSTIFY");case g.LINE_BEGIN:k=j?0:-l;break;case g.CENTER:k=-l/2;break;case g.LINE_END:k=j?-l:0;break}return k},_getCSSFontFamily:function(l){var j=this._style.fontFamily,m,p,k,o;j=j.replace(/\s+/g," ").replace(/\s*,\s*/g,",").replace(/"/g,"'").replace(/^\s+|\s+$/g,"");if(j.indexOf(",")>0){if(l===true){p=j.split(",");for(k=0,o=p.length;k<o;k++){if(h(p[k])){p[k]="'"+p[k]+"'"}}j=p.join(",")}}else{m=j.replace(/'/g,"").toLowerCase();if(b.cssFonts.hasOwnProperty(m)){j=b.cssFonts[m]}else{if(l===true&&h(j)){j="'"+j+"'"}}}if(l!==true){j=j.replace(/'/g,"")}return j},_getBBoxImpl:function(){return null}},styleDef:{textValue:e.String("",i),x:e.FiniteNumber(0,i),y:e.FiniteNumber(0,i),fontFamily:e.String("Verdana",i),fontSize:e.FinitePositiveNumber(12,i),fontWeight:e.Enum(b.FontWeightEnum,b.FontWeightEnum.NORMAL,i),fontStyle:e.Enum(b.FontStyleEnum,b.FontStyleEnum.NORMAL,i),underline:e.Boolean(false,i),textAlign:e.Enum(g,g.LINE_BEGIN,i)}})}());(function(){var e=b.graphics.AbstractShape.prototype,g=new b.graphics.Line(),f=b.TextAlignEnum;b.mixin(b.graphics.Text,{cvPaintSelf:function(h,j){var k=this._style,l=this.cvBBox,i,m;h.font=this.cvGetFont();h.textAlign=this.cvToCSSAlign(this._style.textAlign);if(k.fill!==b.NO_PAINT){this.cvSetFill(h);h.fillText(k.textValue,k.x,k.y);i=k.fill;m=k.fillOpacity}if(k.stroke!==b.NO_PAINT){this.cvSetStroke(h);h.strokeText(k.textValue,k.x,k.y);i=k.stroke;m=k.strokeOpacity}if(k.underline){this.cvPaintUnderline(h,j,l.x,k.y,l.width,i,m)}},cvPaintUnderline:function(p,o,q,n,i,j,m){var h=this._style,l,k;l=Math.round(h.fontSize*5/100);if(l<1){l=1}k=Math.round(n+3*l);if(l%2===1){k+=0.5}g.applyStyle({x1:q,y1:k,x2:q+i,y2:k,strokeThickness:l,stroke:j,strokeOpacity:m});g.cvPaintSelf(p,o)},cvGetBBox:function(){var i=this._style,h=b.tree.cvTextMetrics(i.textValue,this.cvGetFont());return{x:i.x+this._getXAlignOffset(h.width),y:i.y-h.ascent,width:h.width,height:h.height}},notifyNativeImpl:function(h,i){if(h===b.TAGS.GEOM){this.cvCacheFont();this.cvBBox=this.cvGetBBox()}else{if(h===b.TAGS.LAYOUT_DIR){this.cvBBox=this.cvGetBBox()}}e.notifyNativeImpl.call(this,h,i)},cvGetFont:function(){if(!this.cvFont){this.cvCacheFont()}return this.cvFont},cvCacheFont:function(){var i=this._style,h="";if(i.fontStyle===b.FontStyleEnum.ITALIC){h+="italic "}if(i.fontWeight===b.FontWeightEnum.BOLD){h+="bold "}h+=i.fontSize+"px "+this._getCSSFontFamily(true);this.cvFont=h},cvToCSSAlign:function(i){var h=(b.layoutDir===b.LTR);switch(i){case f.CENTER:i="center";break;case f.LINE_END:i=h?"right":"left";break;default:i=h?"left":"right";break}return i}})}());(function(){var e=b.defs,f=b.TAGS.GEOM;b.declare({name:"oui.graphics.TextBlock",extend:b.graphics.Text,jsonDef:{type:"textBlock"},membersDef:{convertToText:function(){var o=[],h=new b.text.LineBreakMeasurer(this),n=this._breakText(h),q=n.length,p,g,k=this._style,j=k.y,m=k.x,l;for(l=0;l<q;l++){g=n[l];if(l!==0){j+=g.leading+g.ascent}p=new b.graphics.Text(k);p.applyStyle({textValue:g.textValue,x:m+this._getXAlignOffset(g.lineWidth),y:j});o.push(p);j+=g.descent}return o},_breakText:function(g){var h=this._style,i=h.textValue,p=h.maxWidth,m=h.maxLines,j=h.autoTooltip,l=h.useEllipsis,n=h.ellipsis,o=false,r=[],q=g.getTextLength(),k;g.replaceText(0,q,i);if(l){q=g.getTextLength();k=this._fitText(g,r,p,m,true);while(k>=1&&k<q){g.replaceText(k-1,q,n);q=g.getTextLength();k=this._fitText(g,r,p,m,true)}o=(k!==i.length)}else{this._fitText(g,r,p,m,false)}if(j&&o){this.setTooltip(i)}else{this.setTooltip(null)}return r},_fitText:function(g,o,m,l,k){var n=0,j=0,h=this._style.minChar,i=g.nextLine(m);o.length=0;while(i){o.push(i);n++;j=i.textBlockEndIndex;if(n===l||(k&&i.lastWordTruncated)){break}i=g.nextLine(m)}if(k){h++}if(n>0&&o[0].lastWordTruncated&&o[0].textValue.length<h){o.length=0;j=0}return j}},styleDef:{maxWidth:e.PositiveNumber(Number.POSITIVE_INFINITY,f),maxLines:e.NumberInRange([1,Number.POSITIVE_INFINITY],Number.POSITIVE_INFINITY,f),minChar:e.FinitePositiveNumber(0,f),useEllipsis:e.Boolean(false),ellipsis:e.Char("\u2026"),autoTooltip:e.Boolean(false)}})}());(function(){b.mixin(b.graphics.TextBlock,{cvPaintSelf:function(l,q){var g=this._style,s,t,k,f,j,e,o=(g.fill!==b.NO_PAINT),r=(g.stroke!==b.NO_PAINT),h=g.underline,p,m;if(o){this.cvSetFill(l);p=g.fill;m=g.fillOpacity}if(r){this.cvSetStroke(l);p=g.stroke;m=g.strokeOpacity}if(o||r){l.font=this.cvGetFont();l.textAlign=this.cvToCSSAlign(this._style.textAlign);s=this.cvTextLines;k=g.x;f=g.y;for(j=0,e=s.length;j<e;j++){t=s[j];if(j!==0){f+=s[j-1].descent+t.leading+t.ascent}if(o){l.fillText(t.textValue,k,f)}if(r){l.strokeText(t.textValue,k,f)}if(h){this.cvPaintUnderline(l,q,g.x+this._getXAlignOffset(t.lineWidth),f,t.lineWidth,p,m)}}}},cvGetBBox:function(){var g=this._style,f=new b.text.LineBreakMeasurer(this),m=this._breakText(f),e=m.length,k=0,l=0,j=0,n,h;for(h=0;h<e;h++){n=m[h];k=Math.max(k,n.lineWidth);l+=n.lineHeight+n.leading}if(e>0){j=m[0].ascent}return{x:g.x+this._getXAlignOffset(k),y:g.y-j,width:k,height:l}},notifyNativeImpl:function(e,g){var f;if(e===b.TAGS.GEOM||e===b.TAGS.LAYOUT_DIR){this.cvCacheFont();f=new b.text.LineBreakMeasurer(this);this.cvTextLines=this._breakText(f);this.cvBBox=this.cvGetBBox()}b.graphics.AbstractShape.prototype.notifyNativeImpl.call(this,e,g)}})}());(function(){var e=b.graphics.Group.prototype,f="background";b.declare({name:"oui.layout.AbstractLayoutBox",isAbstract:true,extend:b.graphics.Group,membersDef:{_computeLayoutCtrlPts:function(){var g=this._box;return b.geom.getBoxCtrlPts(g.x,g.y,g.width,g.height)},invalidateLayout:function(){var g;if(!this._layingOut&&!this._layoutDirty){g=this.getFirstContentChild();this.invalidateLayout=b.NO_OP;while(g){if((g.getLayoutHWeight()!==0)||(g.getLayoutVWeight()!==0)){g.invalidateLayout()}g=g.nextSibling}delete this.invalidateLayout;e.invalidateLayout.call(this)}},_getLayoutInformation:function(){var j,g,h,o,l,i,m,p,k,n;j={maxChildWidth:0,maxChildHeight:0,maxLayoutWidth:Number.MAX_VALUE,maxLayoutHeight:Number.MAX_VALUE,totalChildWidth:0,totalChildHeight:0,totalChildHWeight:0,totalChildVWeight:0,children:[],spacingsCount:0};h=this.getFirstContentChild();while(h){o=h._style;l=h.getPreferredLayoutBox();i=o.layout.hWeight;m=o.layout.vWeight;n=o.display;j.totalChildWidth+=l.width;j.totalChildHWeight+=i;j.totalChildHeight+=l.height;j.totalChildVWeight+=m;if(l.height>j.maxChildHeight){j.maxChildHeight=l.height}if(l.width>j.maxChildWidth){j.maxChildWidth=l.width}j.children.push({node:h,layoutBox:l,hWeight:i,vWeight:m,needSpace:n});if(n){j.spacingsCount++}h=h.nextSibling}if(j.spacingsCount>0){j.spacingsCount--}g=this._layoutBox;if(g){if(j.maxChildHeight>g.height){j.maxChildHeight=g.height}if(j.maxChildWidth>g.width){j.maxChildWidth=g.width}j.maxLayoutWidth=g.width;j.maxLayoutHeight=g.height}p=this._style.layout.preferredWidth;k=this._style.layout.preferredHeight;if(p>=0&&j.maxLayoutWidth>p){j.maxLayoutWidth=p}if(k>=0&&j.maxLayoutHeight>k){j.maxLayoutHeight=k}return j},onStyleChanged:function(g){if(g===f){this._updateBackground()}else{e.onStyleChanged.call(this,g)}},_updateBackground:function(){var g=this._style,h={fill:g.background};if(this._background){this._background.applyStyle(h)}else{this._background=new b.graphics.Rectangle(h);this.insertBefore(this._background,this.firstChild)}},getFirstContentChild:function(){return this._background?this._background.nextSibling:this.firstChild},hasBackground:function(){return(this._background!==undefined)}},styleDef:{background:b.defs.Paint(b.NO_PAINT,f)}})}());(function(){var h=b.defs,n=b.DirectionEnum,o=b.LTR,g=b.RTL,i=b.OrientationEnum.VERTICAL,f=b.OrientationEnum.HORIZONTAL,q=n.UP,p=n.DOWN,e=n.LEFT,m=n.RIGHT,k=n.TO_LINE_BEGIN,l=n.TO_LINE_END,j=b.TAGS.LAYOUT;b.declare({name:"oui.layout.FlowBox",extend:b.layout.AbstractLayoutBox,jsonDef:{type:"flowbox",factory:function(t,v,s,u){var r=new b.layout.FlowBox(t,t.name);b.load(t.children,r,v,s,u);return r}},membersDef:{_safeLayout:function(){var r=this._style.orientation;if(r===f){this._hFlowLayout()}else{this._vFlowLayout()}if(this._background){this._background.applyStyle(this._box)}this._positionInLayoutBox()},_vFlowLayout:function(){var r=this._style,t=0,s=0,A=[],D=0,F=r.wrapLength,z=r.hSpacing,G=r.vSpacing,C,u=this.firstChild,x=0,w=0,E=1,v=0,B=0,y=1;if(this._isRTLLayout()){v=1;E=-1}if(r.vDirection===q){B=1;y=-1}while(u){C=u.getPreferredLayoutBox();if(y*s+C.height>F){this._layoutColumn(A,D,v*E*D);if(x>0){x+=z}x+=D;s=0;t+=E*(D+z);A=[];D=0}A.push({node:u,x:t,y:s+B*y*C.height,width:C.width,height:C.height});if(D<C.width){D=C.width}if(y*s+C.height>w){w=y*s+C.height}s+=y*(C.height+(u._style.display?G:0));u=u.nextSibling}if(A.length>0){this._layoutColumn(A,D,v*E*D);if(x>0){x+=z}x+=D}this._box={x:v*E*x,y:B*y*w,width:x,height:w}},_layoutColumn:function(r,u,t){var s,w,v;for(s=0,w=r.length;s<w;s++){v=r[s];v.node.setLayoutBox(v.x+t,v.y,u,v.height)}},_hFlowLayout:function(){var r=this._style,t=0,s=0,w=[],C=0,F=r.wrapLength,y=r.hSpacing,G=r.vSpacing,B,u=this.firstChild,z=0,E=0,D=1,v=0,A=0,x=1;if(this._isRTLLayout()){v=1;D=-1}if(r.vDirection===q){A=1;x=-1}while(u){B=u.getPreferredLayoutBox();if(D*t+B.width>F){this._layoutRow(w,C,A*x*C);if(z>0){z+=G}z+=C;t=0;s+=x*(C+G);w=[];C=0}w.push({node:u,x:t+v*D*B.width,y:s,width:B.width,height:B.height});if(C<B.height){C=B.height}if(D*t+B.width>E){E=D*t+B.width}t+=D*(B.width+(u._style.display?y:0));u=u.nextSibling}if(w.length>0){this._layoutRow(w,C,A*x*C);if(z>0){z+=G}z+=C}this._box={x:v*D*E,y:A*x*z,width:E,height:z}},_layoutRow:function(u,s,t){var r,w,v=u.length;for(r=0;r<v;r++){w=u[r];w.node.setLayoutBox(w.x,w.y+t,w.width,s)}},_isRTLLayout:function(){var r=this._style.hDirection;return r===e||(r===k&&b.layoutDir===o)||(r===l&&b.layoutDir===g)}},styleDef:{orientation:h.Enum(b.OrientationEnum,i,j),wrapLength:h.PositiveNumber(100,j),hDirection:{type:[e,m,k,l],defaultValue:l,tag:j},vDirection:{type:[q,p],defaultValue:p,tag:j},hSpacing:h.FinitePositiveNumber(5,j),vSpacing:h.FinitePositiveNumber(5,j)}})}());(function(){var f=b.LTR,k=b.RTL,i=b.DirectionEnum,g=i.LEFT,h=i.RIGHT,l=i.TO_LINE_BEGIN,e=i.TO_LINE_END,j=b.TAGS.LAYOUT;b.declare({name:"oui.layout.HBox",extend:b.layout.AbstractLayoutBox,jsonDef:{type:"hbox",factory:function(n,q,m,p){var o=new b.layout.HBox(n,n.name);b.load(n.children,o,q,m,p);return o}},membersDef:{_safeLayout:function(){var y,A,s,m,E,o,u,B,p,w,C,v=this._style,q=0,D=0,z,t=1,n=0,x=v.direction,r=v.spacing;A=this._getLayoutInformation();m=A.maxChildHeight;if(A.maxLayoutHeight!==Number.MAX_VALUE&&((A.totalChildVWeight!==0)||(A.maxLayoutHeight<A.maxChildHeight))){m=A.maxLayoutHeight}p=A.maxLayoutWidth;s=A.children;w=0;E=p;o=s.length;D=A.maxLayoutWidth-A.totalChildWidth-A.spacingsCount*r;if(D<0||A.maxLayoutWidth===Number.MAX_VALUE){D=0}z=A.totalChildHWeight;if(z===0){z=1}if(x===g||(x===l&&b.layoutDir===f)||(x===e&&b.layoutDir===k)){n=1;t=-1}for(C=0;C<o;C++){u=s[C];B=u.node;y=u.layoutBox.width+D*u.hWeight/z;if(y>p){y=p}B.setLayoutBox(w+n*t*y,0,y,m);q=t*w+y;w+=t*(y+(u.needSpace?r:0));if(t*w>E){w=t*E}p=A.maxLayoutWidth-t*w;if(p<0){p=0}}this._box={x:n*t*q,y:0,width:q,height:m};if(this._background){this._background.applyStyle(this._box)}this._positionInLayoutBox()}},styleDef:{spacing:b.defs.FinitePositiveNumber(5,j),direction:{type:[g,h,l,e],defaultValue:e,tag:j}}})}());(function(){var g=b.DirectionEnum,e=g.UP,f=g.DOWN,h=b.TAGS.LAYOUT;b.declare({name:"oui.layout.VBox",extend:b.layout.AbstractLayoutBox,jsonDef:{type:"vbox",factory:function(j,m,i,l){var k=new b.layout.VBox(j,j.name);b.load(j.children,k,m,i,l);return k}},membersDef:{_safeLayout:function(){var p,u,m,n,z,j,o,v,y,r,w,q=this._style,A=0,t=0,k,x=0,s=1,l=q.spacing;u=this._getLayoutInformation();n=u.maxChildWidth;if(u.maxLayoutWidth!==Number.MAX_VALUE&&((u.totalChildHWeight!==0)||(u.maxLayoutWidth<u.maxChildWidth))){n=u.maxLayoutWidth}y=u.maxLayoutHeight;m=u.children;r=0;z=y;j=m.length;t=u.maxLayoutHeight-u.totalChildHeight-u.spacingsCount*l;if(t<0||u.maxLayoutHeight===Number.MAX_VALUE){t=0}k=u.totalChildVWeight;if(k===0){k=1}if(q.direction===e){x=1;s=-1}for(w=0;w<j;w++){o=m[w];v=o.node;p=o.layoutBox.height+t*o.vWeight/k;if(p>y){p=y}v.setLayoutBox(0,r+x*s*p,n,p);A=s*r+p;r+=s*(p+(o.needSpace?l:0));if(s*r>z){r=s*z}y=u.maxLayoutHeight-s*r;if(y<0){y=0}}this._box={x:0,y:x*s*A,width:n,height:A};if(this._background){this._background.applyStyle(this._box)}this._positionInLayoutBox()}},styleDef:{spacing:b.defs.FinitePositiveNumber(5,h),direction:{type:[e,f],defaultValue:f,tag:h}}})}());(function(){var f=b.graphics.Group.prototype,e=b.defs;b.declare({name:"oui.layout.Box",extend:b.graphics.Group,jsonDef:{type:"box",factory:function(h,k,g,j){var i=new b.layout.Box(h,h.name);b.load(h.children,i,k,g,j);return i}},membersDef:{init:function(g,h){f.init.call(this,g,h);this._updateBackground()},onPropertyChanged:function(){this._updateBackground()},_updateBackground:function(){var j=this._style,i=j.border,h=i.rounded,g,k;if((h.topLineBegin===h.topLineEnd&&h.topLineEnd===h.bottomLineBegin&&h.bottomLineBegin===h.bottomLineEnd)){k={stroke:i.stroke,strokeThickness:i.strokeThickness,rx:h.topLineBegin?i.rx:0,ry:h.topLineBegin?i.ry:0,fill:j.background,filter:j.backgroundFilter};if(!this._rect){this._rect=new b.graphics.Rectangle(k)}else{this._rect.applyStyle(k)}g=this._rect}else{k={stroke:i.stroke,strokeThickness:i.strokeThickness,rx:i.rx,ry:i.ry,rounded:i.rounded,fill:j.background,filter:j.backgroundFilter};if(!this._hrrect){this._hrrect=new b.graphics.HalfRoundedRectangle(k)}else{this._hrrect.applyStyle(k)}g=this._hrrect}if(g!==this._background){if(this._background){this.removeChild(this._background)}this.insertBefore(g,this.firstChild);this._background=g}},_safeLayout:function(){var l,h=null,k,g,i,j;if(!this._layoutBox){l=this.getPreferredLayoutBox();this.setLayoutBox(0,0,l.width,l.height)}k=this._layoutBox.width;g=this._layoutBox.height;i=this._style.layout.preferredWidth;j=this._style.layout.preferredHeight;if(i>=0&&i<k){k=i}if(j>=0&&j<g){g=j}if(this._background){h=this._background.nextSibling;this._background.applyStyle({width:k,height:g})}else{h=this.firstChild}while(h){h.setLayoutBox(0,0,k,g);h=h.nextSibling}this._positionInLayoutBox()},_getContentPreferredLayoutBox:function(){var g=null,i,h={width:0,height:0};if(this._background){g=this._background.nextSibling}while(g){i=g.getPreferredLayoutBox();h.width=Math.max(h.width,i.width);h.height=Math.max(h.height,i.height);g=g.nextSibling}return h}},styleDef:{border:{strokeThickness:e.FinitePositiveNumber(1),stroke:e.Paint(b.NO_PAINT),rx:e.PositiveNumber(3),ry:e.PositiveNumber(3),rounded:{topLineBegin:e.Boolean(true),topLineEnd:e.Boolean(true),bottomLineBegin:e.Boolean(false),bottomLineEnd:e.Boolean(false)}},background:e.Paint(b.NO_PAINT),backgroundFilter:e.FilterEffect(null)}})}());(function(){var f=b.graphics.Group.prototype,e=b.defs,g;g={name:"content",type:"box",children:[{name:"shadow",type:"box",background:b.black,border:{stroke:b.black},styleBinding:{display:function(h){return h.shadow!==null},filter:"@shadow",border:{strokeThickness:"@border.strokeThickness",rx:"@border.rx",ry:"@border.ry",rounded:"@border.rounded"}}},{name:"background",type:"box",styleBinding:{border:"@border",background:"@background"}},{name:"data",type:"box",background:b.NO_PAINT,border:{stroke:b.NO_PAINT},styleBinding:{layout:{padding:"@padding"}},children:[{name:"text",type:"textBlock",useEllipsis:true,autoTooltip:false,styleBinding:{fontFamily:"@text.fontFamily",fontSize:"@text.fontSize",fontWeight:"@text.fontWeight",fill:"@text.fill",maxLines:"@text.maxLines",maxWidth:"#_computeMaxWidth"}},{name:"graphics",type:"group"}]}]};b.declare({name:"oui.tooltip.Tooltip",extend:b.graphics.Group,membersDef:{init:function(h,i){f.init.call(this,h,i);this.isShown=false;this._isTextBased=false;this.content=b.load(g);this.appendChild(this.content);this.onPropertyChanged();this.setPointerSensitivity(false);this._viewportResizeHandler=this.handler("_computeMaxWidth")},setContent:function(h){this.content.data.text.setDisplay(false);this.content.data.graphics.setDisplay(false);if(b.isA(h,String)){this._setTextContent(h)}else{if(b.isA(h,b.graphics.AbstractGraphicNode)){this._setGraphicContent(h)}else{if(b.isA(h,Number)){this._setTextContent(h.toString(10))}else{if(b.isA(h,Date)){this._setTextContent(h.toLocaleString())}}}}},show:function(){this.appendChild(this.content);this.isShown=true},hide:function(){this.isShown=false;if(this.firstChild){this.removeChild(this.content)}},onPropertyChanged:function(){if(this.content!==undefined){this.content.applyStyleBinding(this._style,this)}},_setTextContent:function(h){this.content.data.text.applyStyle({display:true,textValue:h,maxWidth:this._computeMaxWidth()});if(!this._isTextBased){b.rootNode.addEventListener(b.ViewEvents.VIEWPORT_RESIZE,this._viewportResizeHandler);this._isTextBased=true}},_setGraphicContent:function(i){var h=this.content.data.graphics;h.removeChildren();h.appendChild(i);h.setDisplay(true);if(this._isTextBased){b.rootNode.removeEventListener(b.ViewEvents.VIEWPORT_RESIZE,this._viewportResizeHandler);this._isTextBased=false}},_computeMaxWidth:function(){var h=this._style,i=h.padding,j=b.viewportWidth-(i.lineBegin+i.lineEnd);return Math.min(h.text.maxWidth,j)}},styleDef:{border:{strokeThickness:e.FinitePositiveNumber(1),stroke:e.Paint(new b.style.Color(204,204,204)),rx:e.PositiveNumber(4),ry:e.PositiveNumber(4),rounded:{topLineBegin:e.Boolean(true),topLineEnd:e.Boolean(true),bottomLineBegin:e.Boolean(true),bottomLineEnd:e.Boolean(true)}},background:e.Paint(new b.style.Color(0,0,0,191)),text:{fontFamily:e.String("Trebuchet MS"),fontSize:e.FinitePositiveNumber(11),fontWeight:e.Enum(b.FontWeightEnum,b.FontWeightEnum.NORMAL),fill:e.Paint(b.white),maxLines:e.NumberInRange([1,Number.POSITIVE_INFINITY],Number.POSITIVE_INFINITY),maxWidth:e.PositiveNumber(Number.POSITIVE_INFINITY,b.TAGS.GEOM)},padding:e.Padding(5,5,5,5),shadow:e.ObjectOfType(b.filters.DropShadow,b.filters.DROP_SHADOW_KNOCKED_OUT,true)}})}());(function(){var e=b.defs;b.declare({name:"oui.tooltip.TooltipManager",mixins:[b.lang.PropertiesSupport],membersDef:{events:{SHOW_TOOLTIP:"showTooltip",HIDE_TOOLTIP:"hideTooltip"},init:function(){var g=this,f=b.tree;this._initProperties();this._initCallbacks();this._initMouseListeners();this._style=new this.Style();this._tooltip=new b.tooltip.Tooltip(this._style);this._ttTarget=null;this._ttX=0;this._ttY=0;if(f.isPlatformAvailable()){this.enableAutoTooltips()}else{f.addEventListener(f.events.PLATFORM_AVAILABLE,function(){f._initShadowTree(g._tooltip);g.enableAutoTooltips()})}},enableAutoTooltips:function(){b.tree.tooltipLayer.appendChild(this._tooltip);this._tooltip.hide();b.rootNode.onMouseOver(this._mouseOverListener)},disableAutoTooltips:function(){b.tree.tooltipLayer.removeChild(this._tooltip);b.rootNode.offMouseOver(this._mouseOverListener)},applyStyle:function(f){this._tooltip.applyStyle(f)},showTooltip:function(h,g,f,i){this.cancelDismissTooltip();this.cancelHideTooltip();if(g!==this._tooltipContent){this._tooltip.setContent(g)}this._tooltip.show();this._positionTooltipTo(f,i);this.scheduleDismissTooltip();this._tooltipContent=g},hideTooltip:function(){this._tooltip.hide()},_initMouseListeners:function(){var j=this,f,i,g;function h(k){var l=null;while(k){l=k.getTooltip();if(l===null||l===""){k=k.parentNode}else{break}}return k}f=function(l){var k=h(l.relatedTarget),m=h(l.target);if(m&&m!==k){m.onMouseMove(g);m.onMouseOut(i)}};i=function(k){var l=k.currentTarget,m=h(k.relatedTarget);if(m!==l){j.cancelShowTooltip();j.cancelDismissTooltip();j.scheduleHideTooltip();l.offMouseMove(g);l.offMouseOut(i)}};g=function(k){j._ttTarget=k.currentTarget;j._ttX=k.clientX;j._ttY=k.clientY;j.cancelShowTooltip();j.scheduleShowTooltip()};this._mouseOverListener=f},_initCallbacks:function(){var f=this;this._showTooltipDefaultAction=function(g){var h=g.target.getTooltip();f.showTooltip(g.target,h,g.tooltipX,g.tooltipY)};this._dispatchShowTooltip=function(){f._ttTarget.dispatchEvent({type:f.events.SHOW_TOOLTIP,tooltipX:f._ttX,tooltipY:f._ttY,cancelable:true,defaultAction:f._showTooltipDefaultAction})};this._hideTooltipDefaultAction=function(){f.hideTooltip()};this._dispatchHideTooltip=function(){if(f._ttTarget){f._ttTarget.dispatchEvent({type:f.events.HIDE_TOOLTIP,defaultAction:f._hideTooltipDefaultAction})}}},scheduleShowTooltip:function(){var f=this._properties.showDelay;if(f===0){this._dispatchShowTooltip()}else{this._showTooltipTimeoutID=setTimeout(this._dispatchShowTooltip,f)}},cancelShowTooltip:function(){if(this._showTooltipTimeoutID){clearTimeout(this._showTooltipTimeoutID);this._showTooltipTimeoutID=undefined}},scheduleHideTooltip:function(){var f=this._properties.hideDelay;if(f===0){this._dispatchHideTooltip()}else{this._hideTooltipTimeoutID=setTimeout(this._dispatchHideTooltip,f)}},cancelHideTooltip:function(){if(this._hideTooltipTimeoutID){clearTimeout(this._hideTooltipTimeoutID);this._hideTooltipTimeoutID=undefined}},scheduleDismissTooltip:function(){var f=this._properties.dismissDelay;if(f===0){this._dispatchHideTooltip()}else{if(isFinite(f)){this._dismissTooltipTimeoutID=setTimeout(this._dispatchHideTooltip,f)}}},cancelDismissTooltip:function(){if(this._dismissTooltipTimeoutID){clearTimeout(this._dismissTooltipTimeoutID);this._dismissTooltipTimeoutID=undefined}},_positionTooltipTo:function(f,k){var j=this._tooltip,i=this._properties,g={x:f,y:k},h;j._setTranslation(f+i.cursorOffset,k+i.cursorOffset);h=j.getLayoutBounds();g=b.geom.getBoundedXY(h,b.viewportBounds,undefined,g);if(g.x!==h.x||g.y!==h.y){j._setTranslation(g.x,g.y)}}},propertiesDef:{showDelay:e.FinitePositiveNumber(200),hideDelay:e.FinitePositiveNumber(250),dismissDelay:e.PositiveNumber(5000),cursorOffset:e.Number(12),followCursor:e.Boolean(false)},styleDef:b.tooltip.Tooltip.StyleDefinition})}());(function(){b.declare({name:"oui.io.JSONExporter",membersDef:{init:function(){this._resources={};this._root={type:"group"};this._containerHierarchy=[this._root];this._curContainer=this._root},snapshotNodes:function(p,s,m,o){var r,q,t;if(b.isA(p,Array)){for(q=0,t=p.length;q<t;q++){this.captureNode(p[q])}r={type:"snapshot",width:m,height:o,viewBox:b.geom.isValidRect(s)?[s.x,s.y,s.width,s.height]:undefined,resources:this._captureResources(),content:this._root}}return r},captureNode:function(m){if(m.jsonNodeExporter!==undefined){m.jsonNodeExporter.captureNode(m,this)}},startNodeExport:function(m){if(this._curContainer.children===undefined){this._curContainer.children=[m]}else{this._curContainer.children.push(m)}this._containerHierarchy.push(m);this._curContainer=m},endNodeExport:function(){var m;this._containerHierarchy.pop();m=this._containerHierarchy.length;this._curContainer=this._containerHierarchy[m-1]},_DEFAULT_RESOURCE_COMPARE:function(n,m){return n===m},getResourceId:function(p,o,t,s){var r=0,m=0,q;if(t===undefined){t=this._DEFAULT_RESOURCE_COMPARE}if(this._resources[o]===undefined){q=[];this._resources[o]=q}else{q=this._resources[o];for(m=0,r=q.length;m<r;m++){if(t(q[m],p)===true){break}}}if(m===r){if(typeof s==="function"){s(p)}q.push(p)}return o.concat(m)},getImgResourceId:function(m,n){return this.getResourceId({type:"imageResource",src:m},"image_",function(p,o){return p.src===o.src},n)},_captureResources:function(){var r=this._resources,m={},o,s,q;for(q in r){if(r.hasOwnProperty(q)===true){m[q]={};for(o=0,s=r[q].length;o<s;o++){m[q][q+o]=this._resourceToJSON(r[q][o])}}}return m},_resourceToJSON:function(n){var m=n;if(b.isA(n.exportValueToJSON,Function)){m=n.exportValueToJSON(this)}return m}}});b.graphics.AbstractGraphicNode.prototype.jsonNodeExporter={exportNode:function(u,o,q){var m,p=u._style,r=u.StyleDefinition.prototype,s=u.jsonExportConfig.styleExporter,t=u.jsonExportConfig.propertiesExporter;for(m in p){if(s.hasOwnProperty(m)){s[m](m,p[m],r[m].defaultValue,o,u,q)}}if(t!==undefined){t(o,u,q)}},captureNode:function(p,o){var m;if(p.shouldCapture()){m={type:p.jsonExportConfig.type,__node:p};this.exportNode(p,m,o);o.startNodeExport(m);this.exportChildren(p,o);o.endNodeExport(m)}},exportChildren:function(m,n){var o=m.firstChild;while(o){n.captureNode(o);o=o.nextSibling}}};var f,l,j,h,e,k,g,i;f=function(n,m){n.prototype.exportToJSON=m};l=function(n,m){n.prototype.exportValueToJSON=m};j=function(n,m){var o=n.prototype.jsonExportConfig;n.prototype.jsonExportConfig=m;if(o!==undefined){b.mixin(m.styleExporter,o.styleExporter)}};b.graphics.AbstractGraphicNode.prototype.shouldCapture=function(){return this._style.display&&this._style.visibility};b.graphics.AbstractPath.prototype.shouldCapture=function(){var m=this.getPathCommands();return this._style.display&&this._style.visibility&&m!==null&&m.dataTypes.length>0};h=function(o,r,m,p,s,q){if(r!==m){p[o]=r}};e=function(o,r,m,p,s,q){if(r!==m){p[o]=r.concat()}};k=function(o,r,m,p,s,q){if(r!==m){p[o]=r.exportToJSON(q)}};g=function(r){var o=[],m,q,p,s=r.length;for(p=0;p<s;p++){q=r[p];m=q.getColor();o.push({type:"stop",offset:q.getOffset(),color:m.exportToJSON(),opacity:m.getOpacity(),origColor:m})}return o};i=function(n,m){return n===m||(n._style.color===m._style.color&&n._style.opacity===m._style.opacity&&n._style.radius===m._style.radius&&n._style.angle===m._style.angle&&n._style.offset===m._style.offset&&n._style.knockout===m._style.knockout)};j(b.graphics.AbstractGraphicNode,{styleExporter:{clip:e,transform:function(o,r,m,p,s,q){if(!r.isIdentity()){p[o]=r.exportToJSON(q)}},filter:function(o,r,m,p,s,q){if(r!==m){s._updateFilterFX();k(o,s._filterFX,m,p,s,q)}}}});j(b.graphics.Group,{type:"group",styleExporter:{opacity:h}});j(b.graphics.AbstractShape,{styleExporter:{fill:k,fillOpacity:h,stroke:k,strokeOpacity:h,strokeThickness:h,strokeLineJoin:h,strokeLineCap:h,strokeMiterLimit:h,htmlExportClassName:h}});j(b.graphics.Ellipse,{type:"ellipse",styleExporter:{cx:h,cy:h,width:h,height:h}});j(b.graphics.Image,{type:"image",styleExporter:{src:function(o,r,m,p,t,q){var s=q.getImgResourceId(r,function(n){n.href=t.toDataURL()});p[o]="#"+s},x:h,y:h,width:h,height:h}});j(b.graphics.Line,{type:"line",styleExporter:{x1:h,y1:h,x2:h,y2:h}});j(b.graphics.AbstractPath,{type:"path",propertiesExporter:function(m,o,n){m.pathCommands=o.getPathCommands().exportToJSON(n)},styleExporter:{}});j(b.graphics.Rectangle,{type:"rect",styleExporter:{x:h,y:h,width:h,height:h,rx:h,ry:h}});j(b.graphics.Text,{type:"text",styleExporter:{x:h,y:h,fontSize:h,fontWeight:h,fontFamily:h,underline:h,textAlign:h,textValue:h}});j(b.graphics.TextBlock,{type:"textBlock",styleExporter:{}});f(b.style.Color,function(){return"#".concat(this.hexRGBA)});f(b.style.GradientPaint,function(m){return"url(#"+m.getResourceId(this,"gradient_")+")"});f(b.style.PatternPaint,function(m){m.getImgResourceId(this._properties.src,function(n){var o=n.src;n.href=b.resourcesManager._getBase64Data(o)||o});return"url(#"+m.getResourceId(this,"pattern_")+")"});f(b.style.Paint,function(){return"none"});f(b.filters.AbstractFilter,function(m){return"url(#"+m.getResourceId(this,"filter_")+")"});f(b.filters.DropShadow,function(m){return"url(#"+m.getResourceId(this,"filter_",i)+")"});l(b.style.LinearGradient,function(){var m=this._properties;return{type:"linearGradient",x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,useObjectBoundingBox:m.useObjectBoundingBox,stops:g(m.stops)}});l(b.style.RadialGradient,function(){var m=this._properties;return{type:"radialGradient",cx:m.cx,cy:m.cy,r:m.radius,useObjectBoundingBox:m.useObjectBoundingBox,stops:g(m.stops)}});l(b.style.PatternPaint,function(m){return{type:"pattern",width:this._srcW,height:this._srcH,src:"#"+m.getImgResourceId(this._properties.src),origSrc:this._properties.src}});l(b.filters.DropShadow,function(){var m=this._style;return{type:"dropShadow",color:m.color.hexRGBA,opacity:m.opacity,radius:m.radius,angle:m.angle,offset:m.offset,knockout:m.knockout}});l(b.filters.Blur,function(){return{type:"blur",radius:this._style.radius}});f(b.geom.Matrix,function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]});f(b.graphics.PathCommands,function(){return{dataTypes:this.dataTypes.concat(),dataValues:this.dataValues.concat()}})}());(function(){b.ns("oui.io");b.io.XMLConverter={convert:function(f,l){var g,j,h,k,e=l;if(typeof f==="string"){e=e.concat(b.xmlSpecialChars(f))}else{e=e.concat("<",f.__type);g=[];if(f.hasOwnProperty("__style")){for(j in f.__style){if(f.__style.hasOwnProperty(j)===true){g.push("".concat(j,":",f.__style[j],";"))}}f.style=g.join("")}g=[];for(j in f){if(j!=="children"&&j!=="__type"&&j!=="__style"&&f.hasOwnProperty(j)===true){g.push(" ".concat(j,"='",f[j],"'"))}}if(g.length>0){g.sort();e=String.prototype.concat.apply(e,g)}if(f.children!==undefined){e=e.concat(">");k=f.children.length;for(h=0;h<k;h++){e=b.io.XMLConverter.convert(f.children[h],e)}e=e.concat("</"+f.__type+">")}else{if(f.__type==="div"||f.__type==="style"){e=e.concat("></"+f.__type+">")}else{e=e.concat(" />")}}}return e}}}());(function(){var u,e=3*Math.sqrt(2*Math.PI),v={LTR:{LINE_BEGIN:"start",LINE_END:"end",CENTER:"middle",JUSTIFY:"start"},RTL:{LINE_BEGIN:"end",LINE_END:"start",CENTER:"middle",JUSTIFY:"start"}},s={},f={};function h(y){if(s[y]===undefined){s[y]=0}else{s[y]++}return y+s[y]}function q(y){return y.substring(0,7)}function w(z){var y=z;if(z&&z.charAt(0)==="#"){y=q(z)}return y}function p(z){var y=z.substr(7),A=1;if(y!=="FF"){A=parseInt(y,16)/255}return A}function m(z){var y=1;if(z&&z.charAt(0)==="#"){y=p(z)}return y}function r(y){return[parseInt(y.substr(0,2),16),parseInt(y.substr(2,2),16),parseInt(y.substr(4,2),16),parseInt(y.substr(6,2),16)]}function k(z,y){if(z){if(!y.children){y.children=[]}y.children.push(z)}}function x(y){return(y*4-2)/e}function o(z,y,A){return{__type:"feFunc"+z,type:"linear",slope:y,intercept:A}}function l(z){var A={},y;for(y in z){if(z.hasOwnProperty(y)===true&&y!=="children"&&y!=="type"&&y!=="__node"){A[y]=z[y]}}if(z.hasOwnProperty("type")===true){A.__type=z.type}return A}function t(z){var A=l(z),y=A.color;A["stop-color"]=q(y);delete A.color;A["stop-opacity"]=p(y);return A}function n(z){var B=l(z),A=B.stops,y,C;B.gradientUnits=B.useObjectBoundingBox?"objectBoundingBox":"userSpaceOnUse";delete B.useObjectBoundingBox;delete B.stops;if(A){for(y=0,C=A.length;y<C;y++){k(t(A[y]),B)}}return B}function j(y){return{__type:"filter",id:y.id,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[]}}function i(A){var D=l(A),z=D.transform,C=D.clip,B,y;delete D.clip;if(C&&C[2]!==-1){y=h("clipPath_");B={__type:"clipPath",id:y,children:[{__type:"rect",x:C[0],y:C[1],width:C[2],height:C[3]}]};D["clip-path"]="url(#"+y+")";k(B,D)}if(z){D.transform="matrix("+z.join(",")+")"}return D}function g(A){var B=i(A),E=w(B.fill),F=m(B.fill),y=B.fillOpacity,D=w(B.stroke),z=B.strokeOpacity,C=m(B.stroke);if(y===undefined){y=1}y*=F;if(z===undefined){z=1}z*=C;if(E){B.fill=E}if(y!==1){B["fill-opacity"]=y}if(D){B.stroke=D}if(z!==1){B["stroke-opacity"]=z}if(B.strokeThickness!==undefined){B["stroke-width"]=B.strokeThickness}if(B.strokeLineJoin!==undefined){B["stroke-linejoin"]=B.strokeLineJoin.toLowerCase()}if(B.strokeLineCap!==undefined){B["stroke-linecap"]=B.strokeLineCap.toLowerCase()}if(B.strokeMiterLimit!==undefined){B["stroke-miter-limit"]=B.strokeMiterLimit}delete B.strokeOpacity;delete B.fillOpacity;delete B.strokeThickness;delete B.strokeLineJoin;delete B.strokeLineCap;delete B.strokeMiterLimit;return B}u={radialGradient:n,linearGradient:n,pattern:function(y){var z={__type:"pattern",id:y.id,patternUnits:"userSpaceOnUse",width:y.width,height:y.height,children:[]};k({__type:"use","xlink:href":y.src,width:y.width,height:y.height},z);return z},blur:function(y){var z=j(y);k({__type:"feGaussianBlur","in":"SourceGraphic",stdDeviation:x(y.radius)},z);return z},dropShadow:function(F){var y=j(F),B,z,D,G,E,A,C;z={__type:"feComponentTransfer","in":"SourceAlpha",result:"compTransfer"};k(z,y);B=r(F.color);k(o("R",0,B[0]/255),z);k(o("G",0,B[1]/255),z);k(o("B",0,B[2]/255),z);k(o("A",F.opacity*B[3]/255,0),z);D={__type:"feGaussianBlur","in":"compTransfer",result:"blur",stdDeviation:x(F.radius)};k(D,y);A=F.angle*Math.PI/180;C=F.offset;G={__type:"feOffset","in":"blur",result:"castShadow",dx:C*Math.cos(A),dy:C*Math.sin(A)};k(G,y);E={__type:"feComposite"};if(F.knockout===true){E["in"]="castShadow";E.in2="SourceGraphic";E.operator="out"}else{E["in"]="SourceGraphic";E.in2="castShadow";E.operator="over"}k(E,y);return y},group:function(A){var B=i(A),z=A.children,y,C;B.__type="g";if(z!==undefined){for(y=0,C=z.length;y<C;y++){k(u[z[y].type](z[y]),B)}}else{B=undefined}return B},ellipse:function(z){var B=g(z),A=B.width,y=B.height;B.rx=A/2;B.ry=y/2;delete B.width;delete B.height;return B},image:function(z){var B=i(z),y,A;y={__type:"use","xlink:href":B.src};B.__type="g";A=z.__node.getLocalBounds();if(B.x!==undefined){y.x=B.x}if(B.y!==undefined){y.y=B.y}if(A){y.width=A.width;y.height=A.height}B.children=[y];delete B.src;delete B.x;delete B.y;delete B.width;delete B.height;return B},imageResource:function(y){return{__type:"symbol",id:y.id,children:[{__type:"image",width:"100%",height:"100%",preserveAspectRatio:"none","xlink:href":y.href}]}},line:g,path:function(z){var A=g(z),y=A.pathCommands;delete A.pathCommands;if(y){A.d=b.graphics.PathCommands.prototype.toString.call(y)}return A},rect:g,text:function(z){var A=g(z),y=b.layoutDir;if(A.fontSize!==undefined){A["font-size"]=A.fontSize}if(A.fontWeight===b.FontWeightEnum.BOLD){A["font-weight"]="bold"}if(A.underline===true){A["text-decoration"]="underline"}delete A.underline;if(A.textAlign!==undefined){A["text-anchor"]=v[y][A.textAlign]}if(A.textValue!==undefined){k(A.textValue,A);delete A.textValue}if(A.fontFamily!==undefined){A["font-family"]=A.fontFamily}A.direction=(y===b.RTL)?"rtl":"ltr";A["unicode-bidi"]="embed";delete A.fontSize;delete A.fontWeight;delete A.textAlign;delete A.fontFamily;return A},textBlock:function(B){var y=(B.x!==undefined)?B.x:0,D,A,F,C,E,z;delete B.textValue;delete B.x;delete B.y;C=B.__node.convertToText();F=C.length;if(F===1){D=u.text(B);D.__type="text";D.x=y;D.y=C[0]._style.y;k(C[0]._style.textValue,D)}else{if(f.noTspan===true){D={__type:"g"};if(B.transform){D.transform="matrix("+B.transform.join(",")+")";delete B.transform}for(A=0;A<F;A++){E=C[A];z=u.text(B);z.__type="text";z.x=E._style.x;z.y=E._style.y;k(E._style.textValue,z);k(z,D)}}else{D=u.text(B);D.__type="text";for(A=0;A<F;A++){E=C[A];z={__type:"tspan",x:y,y:E._style.y};k(E._style.textValue,z);k(z,D)}}}return D}};b.declare({name:"oui.io.svg.SVGExporter",membersDef:{init:function(){},snapshotNodes:function(A,D,y,z,C){var B=new b.io.JSONExporter().snapshotNodes(A,D,y,z);s={};f={noTspan:C};return this._toSVG(B)},_getSVGBoilerPlate:function(){return{__type:"svg",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",stroke:"none",fill:"black","fill-rule":"evenodd","font-size":12,"font-family":"Verdana","text-anchor":v[b.layoutDir].LINE_BEGIN,children:[{__type:"style",type:"text/css",children:["text {stroke: none;}"]}]}},_toSVG:function(I){var H=I.viewBox,C,G,B=I.resources,z=I.content.children,D,A=z?z.length:0,y,F,E;E=this._getSVGBoilerPlate();E.width=I.width;E.height=I.height;E.viewBox=H.join(" ");C={__type:"defs"};E.children.push(C);for(G in B){if(B.hasOwnProperty(G)===true){F=B[G];for(y in F){if(F.hasOwnProperty(y)){F[y].id=y;this._toSVGNode(F[y],C)}}}}for(D=0;D<A;D++){this._toSVGNode(z[D],E)}return E},_toSVGNode:function(z,y){var A=u[z.type];if(A){k(A(z),y)}}}})}());(function(){var j,o="px",e=[1,0,0,1,0,0];function p(q){c.warn("WARN__IO__HTML_FAIL",q.hasOwnProperty("type")?q.type:q)}function f(q){return q?q.y:0}function h(q){return q.substring(0,7)}function i(r){var q=r;if(r&&r.charAt(0)==="#"){q=h(r)}return q}function n(r,q){if(r){if(!q.children){q.children=[]}q.children.push(r)}}function m(r){var s={},q;for(q in r){if(r.hasOwnProperty(q)===true&&q!=="children"&&q!=="type"&&q!=="__node"){s[q]=r[q]}}if(r.hasOwnProperty("type")===true){s.__type=r.type}s.__style={};return s}function l(D){var F=D.stops,v,s,r="",B,t="",z="to ",y,x,E,A,u,w,C,G,q;if(F&&F.length>1){for(v=0,s=F.length;v<s;v++){B=F[v];r+=B.origColor.toString()+" "+Math.round(B.offset*100)+"%";if(v<s-1){r+=", "}}x="background-image: ";E=");";if(D.type==="linearGradient"){A="linear-gradient(";if(D.x1<D.x2){t+="left";z+="right";C=F[0].color;G=F[s-1].color;q=1}else{if(D.x1>D.x2){t+="right";z+="left";C=F[s-1].color;G=F[0].color;q=1}}if(D.y1<D.y2){t+=" top";z+=" bottom";C=F[0].color;G=F[s-1].color;q=0}else{if(D.y1>D.y2){t+=" bottom";z+=" top";C=F[s-1].color;G=F[0].color;q=0}}}else{A="radial-gradient(";t="center, ellipse cover";z="ellipse at center";C=F[0].color;G=F[s-1].color;q=1}w="progid:DXImageTransform.Microsoft.gradient(";u=A+t+", "+r+E;y=x+"-webkit-"+u;y+=x+"-moz-"+u;y+=x+"-ms-"+u;y+=x+"-o-"+u;y+='-ms-filter: "'+w+"startColorstr='"+h(C)+"', endColorstr='"+h(G)+"', GradientType="+q+')";';y+="filter: "+w+"startColorstr='"+h(C)+"', endColorstr='"+h(G)+"', GradientType="+q+E;y+=x+A+z+", "+r+E}else{y="background-color: black;"}return"."+D.id+"{"+y+"}"}function k(r){var t=m(r),q=t.transform,s=t.clip;t["class"]="ouiNodes";delete t.clip;if(s&&s[2]!==-1){p("clip")}if(q){t.__style.left=q[4]+o;t.__style.top=q[5]+o}delete t.transform;return t}function g(q){var r=k(q),t,s;if(q.htmlExportClassName){r["class"]+=" "+q.htmlExportClassName}else{t=i(r.fill);if(t){if(t.indexOf("url(#")===0){r["class"]+=" "+t.substring(5,t.length-1)}else{if(q.type==="text"||q.type==="textBlock"){r.__style.color=t}else{r.__style["background-color"]=t}}}if(r.fillOpacity){p("fill-opacity")}s=i(r.stroke);if(s){r.__style["border-color"]=s}if(r.strokeOpacity){p("stroke-opacity")}if(r.strokeThickness!==undefined){r.__style["border-width"]=r.strokeThickness}if(r.strokeLineJoin!==undefined){p("stroke-linejoin")}if(r.strokeLineCap!==undefined){p("stroke-linecap")}if(r.strokeMiterLimit!==undefined){p("stroke-miterlimit")}}delete r.htmlExportClassName;delete r.fill;delete r.stroke;delete r.strokeOpacity;delete r.fillOpacity;delete r.strokeThickness;delete r.strokeLineJoin;delete r.strokeLineCap;delete r.strokeMiterLimit;return r}j={radialGradient:l,linearGradient:l,pattern:function(r){var q="."+r.id+"{ ",s=r.origSrc;if(b.resourcesManager.hasResource(s)){q+="background-image: url("+b.resourcesManager._getBase64Data(s)+");"}else{p(r)}q+=" }";return q},blur:p,dropShadow:p,group:function(s){var t=k(s),r=s.children,q,u;t.__type="div";if(r!==undefined){for(q=0,u=r.length;q<u;q++){n(j[r[q].type](r[q]),t)}}else{t=undefined}return t},ellipse:p,image:function(r){var s=k(r),q=r.transform||e;s.__type="img";s.src=r.__node.toDataURL();if(s.width){s.__style.width=s.width+o}if(s.height){s.__style.height=s.height+o}if(s.x){s.__style.left=(s.x+q[4])+o}if(s.y){s.__style.top=(s.y+q[5])+o}delete s.x;delete s.y;delete s.width;delete s.height;return s},imageResource:function(){},line:g,path:p,rect:function(r){var s=g(r),q=r.transform||e;s.__type="div";s.__style.overflow="hidden";if(s.width){s.__style.width=s.width+o}if(s.height){s.__style.height=s.height+o}if(s.x){s.__style.left=(s.x+q[4])+o}if(s.y){s.__style.top=(s.y+q[5])+o}delete s.width;delete s.height;delete s.x;delete s.y;return s},text:function(t){var v=g(t),s=b.layoutDir,r=t.transform||e,u=t.__node._getBBoxImpl(),q=(v.x!==undefined)?v.x:0,w=f(u);v.__type="div";v.__style["white-space"]="pre";q+=r[4];if(s===b.RTL&&u){q-=u.width}if(q){v.__style.left=q+o}if(w){v.__style.top=(w+r[5])+o}if(v.fontFamily!==undefined){v.__style["font-family"]=v.fontFamily}if(v.fontSize!==undefined){v.__style["font-size"]=v.fontSize+o}if(v.fontWeight===b.FontWeightEnum.BOLD){v.__style["font-weight"]="bold"}if(v.underline===true){v.__style["text-decoration"]="underline"}if(v.textAlign!==undefined){p("textAlign")}if(v.textValue!==undefined){n(v.textValue,v)}v.dir=(s===b.RTL)?"rtl":"ltr";delete v.x;delete v.y;delete v.fontFamily;delete v.fontSize;delete v.fontWeight;delete v.underline;delete v.textAlign;delete v.textValue;return v},textBlock:function(B){var A=(B.x!==undefined)?B.x:0,w,s,y,u,z,v,r,q=B.transform||e,C;delete B.textValue;delete B.x;delete B.y;z=B.__node.convertToText();u=z.length;if(u===1){w=j.text(B);s=z[0]._getBBoxImpl();A+=q[4];if(b.layoutDir===b.RTL&&s){A-=s.width}w.__style.left=A+o;w.__style.top=(f(s)+q[5])+o;n(z[0]._style.textValue,w)}else{w={__type:"div",__style:{position:"absolute"}};w.__style.left=q[4]+o;w.__style.top=q[5]+o;for(y=0;y<u;y++){v=z[y];C=j.text(B);r=v._getBBoxImpl();C.__style.left=v._style.x+o;C.__style.top=f(r)+o;n(v._style.textValue,C);n(C,w)}}return w}};b.declare({name:"oui.io.html.HTMLExporter",membersDef:{init:function(){},snapshotNodes:function(s,u,q,r){var t=new b.io.JSONExporter().snapshotNodes(s,u,q,r);return this._toHTML(t)},_getHTMLBoilerPlate:function(){return{__type:"div",__style:{"font-size":12,"font-family":"Verdana"},children:[{__type:"style",type:"text/css",children:[".ouiNodes { position: absolute; left: 0px; }"]}]}},_toHTML:function(A){var v,z,u=A.resources,s=A.content.children,w,t=s?s.length:0,q,y,x;x=this._getHTMLBoilerPlate();x.__style={width:A.width+o,height:A.height+o,position:"relative"};x.dir=(b.layoutDir===b.RTL)?"rtl":"ltr";v={__type:"style",type:"text/css"};x.children.push(v);for(z in u){if(u.hasOwnProperty(z)===true){y=u[z];for(q in y){if(y.hasOwnProperty(q)){y[q].id=q;this._toHTMLNode(y[q],v)}}}}for(w=0;w<t;w++){this._toHTMLNode(s[w],x)}return x},_toHTMLNode:function(r,q){var s=j[r.type];if(s){n(s(r),q)}}}})}());(function(){function e(j,f,i){if(j){if(f===undefined){c.info(i?"INFO__I18N__MISSING":"INFO__I18N__INVALID",i)}else{var g,h;for(g in f){if(f.hasOwnProperty(g)&&f[g]){h=i?i+"."+g:g;if(!j[g]){c.info("INFO__I18N__UNSUPP",h)}else{if(b.isA(j[g],String)){j[g]=f[g]}else{e(j[g],f[g],h)}}}}for(g in j){if(j.hasOwnProperty(g)&&(!f.hasOwnProperty(g)||f[g]===undefined)){h=i?i+"."+g:g;c.info("INFO__I18N__MISSING",h)}}}}}b.addI18nSupport=function(g,f){g.Resources=f;g.prototype.Resources=f;g.updateResources=function(h){var j=this.Resources,i=this.prototype;if(i!==undefined&&i.Resources!==undefined){j=i.Resources}if(h!==undefined){e(j,h)}}}}());(function(){b.ns("oui.net");b.mixin(b.net,{goToURL:function(e,f){c.warn("WARN__NET__UNSUPP")}})}());return b}ouilib={createLiveGraphics:function(b,d){var c={};c.aboutInfo="FortKnox1.0#8348/Canvas (c)2008-2014, Oracle Corp.";if(d!==undefined&&d!==null){c.config=d;if(d.name&&c.aboutInfo){c.aboutInfo=d.name+" _ "+c.aboutInfo}}a(c);c.setUp(b);return c}}}());